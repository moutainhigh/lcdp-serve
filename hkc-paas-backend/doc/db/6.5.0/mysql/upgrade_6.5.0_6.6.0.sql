-- jpaas-user lbh 2021-09-23
ALTER TABLE `jpaas_user`.`os_group`    ADD COLUMN `SHORT_NAME_`  varchar(64) NULL COMMENT '简称' AFTER `UPDATE_TIME_`;


-- jpaas-user zfh 2021-09-28 行政组织增加组织类型字段
ALTER TABLE `jpaas_user`.`os_group`    ADD COLUMN `TYPE_`  int(11) NULL COMMENT '组织类型，1代表公司、2代表部门' AFTER `COM_TYPE_`;


-- jpaas-system zfh 2021-10-12 系统分类树增加所属公司ID字段

-- jpaas_system lbh 2021-11-9 公告接收对象类型初始化数据
INSERT INTO `jpaas_system`.`sys_tree` (`TREE_ID_`, `CODE_`, `NAME_`, `PATH_`, `PARENT_ID_`, `ALIAS_`, `DESCP_`, `CAT_KEY_`, `SN_`, `DATA_SHOW_TYPE_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `APP_ID_`) VALUES ('1456526566008016898', NULL, '新闻公告接收对象类型', '0.1456526566008016898.', '0', 'RECEIVE_PART_TYPE', NULL, 'DIC', '4', 'FLAT', '1', '6193', '1', '2021-11-05 15:39:29', NULL, '2021-11-05 15:39:29', NULL, NULL);
INSERT INTO `jpaas_system`.`sys_dic` (`DIC_ID_`, `TREE_ID_`, `NAME_`, `VALUE_`, `DESCP_`, `SN_`, `PATH_`, `PARENT_ID_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`) VALUES ('1456526761429028866', '1456526566008016898', '本公司', '1', '', '1', '0.1456526761429028866.', '0', '1', '6193', '1', '2021-11-05 15:40:16', NULL, '2021-11-05 15:40:16', NULL);
INSERT INTO `jpaas_system`.`sys_dic` (`DIC_ID_`, `TREE_ID_`, `NAME_`, `VALUE_`, `DESCP_`, `SN_`, `PATH_`, `PARENT_ID_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`) VALUES ('1456526762741846018', '1456526566008016898', '指定公司', '2', '', '2', '0.1456526762741846018.', '0', '1', '6193', '1', '2021-11-05 15:40:16', NULL, '2021-11-05 15:40:16', NULL);
-- jpaas_system 修改数字字典
UPDATE `jpaas_system`.`sys_dic` SET `TREE_ID_` = '1280758128721715202', `NAME_` = '新闻公告', `VALUE_` = '新闻公告', `DESCP_` = '公司新闻', `SN_` = 2, `PATH_` = '0.1363005550629212162.', `PARENT_ID_` = '0', `TENANT_ID_` = '1', `CREATE_DEP_ID_` = NULL, `CREATE_BY_` = '1', `CREATE_TIME_` = '2021-02-20 14:00:21', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2021-09-15 09:15:53', `APP_ID_` = NULL WHERE `DIC_ID_` = '1363005550629212162';
-- jpaas-system zfh 2021-10-25 系统菜单数据变更
-- jpaas-system zfh 2021-10-25 系统菜单数据变更
#UPDATE jpaas_system.sys_menu SET MENU_KEY_= 'FormInvokeScriptList', COMPONENT_= 'modules/form/core/FormInvokeScriptList.vue'      WHERE MENU_ID_ = 1281238408903122945 ;




-- jpaas_portal  修改初始化数据
UPDATE `jpaas_portal`.`ins_column_def` SET `NAME_` = '公司公告', `KEY_` = 'newsPortColumn', `IS_DEFAULT_` = '0', `TEMPLET_` = '<div class=\"gridLayoutClass\">\n    <div class=\"headPClass\">\n        <div style=\"display:inline-block;\" >{{insColumnDef.name}}</div>\n        <div style=\"float: right\">\n            <div class=\"journalism_span\">\n             <span @click=\"moreUrl()\">更多</span>\n             <span @click=\"refresh\">刷新</span>\n            </div>\n        </div>\n    </div>\n    <div class=\"bodyDivClass\">\n        <div class=\"aclsty\" v-if=\"hasImage(data)\">\n            <a-carousel arrows autoplay >\n                <div  slot=\"prevArrow\"\n                    slot-scope=\"props\"\n                    class=\"custom-slick-arrow\"\n                    style=\"left: 10px;zIndex: 1\"\n                    >\n                    <a-icon type=\"left-circle\" />\n                </div>\n                <div slot=\"nextArrow\" slot-scope=\"props\" class=\"custom-slick-arrow\" style=\"right: 10px\">\n                    <a-icon type=\"right-circle\" />\n                </div>\n                <div v-for=\"obj of data\"  v-if=\"obj.imgFileId\" class=\"inglist\">\n                    <img v-if=\"obj.imgFileId\" :src=\"getImgPath(obj.imgFileId)\"></img>\n                </div>\n            </a-carousel>\n        </div>\n        <div  >\n            <ul>\n                <li class=\"itmelist\" v-for=\"(obj,index) of data\" :key=\"obj.pkId\" v-if=\"index <=5\">\n                  <p @click=\"getInsNews(obj.pkId)\">{{obj.subject}}</p>\n                  <span>{{obj.createTime}}</span>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>', `SET_TING_` = '{\"dataUrl\":\"/portal/InsNewsIssueds\",\"function\":\"\",\"newType\":\"wordsList\",\"tabgroups\":\"\",\"newDIc\":\"公司公告\"}', `IS_PUBLIC_` = '0', `TYPE_` = '1230775094247464962', `ICON_` = 'iconbaobiao1', `IS_MOBILE_` = '0', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = NULL, `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2021-06-29 18:39:53' WHERE `COL_ID_` = '1239839327900266497';
UPDATE `jpaas_portal`.`ins_column_def` SET `NAME_` = '集团新闻', `KEY_` = 'insNews', `IS_DEFAULT_` = '0', `TEMPLET_` = '<div class=\"gridLayoutClass\">\n    <div class=\"headPClass\">\n        <div style=\"display:inline-block;\" >{{insColumnDef.name}}</div>\n        <div style=\"float: right\">\n            <div class=\"journalism_span\">\n             <span @click=\"moreUrl()\">更多</span>\n             <span @click=\"refresh\">刷新</span>\n            </div>\n        </div>\n    </div>\n    <div class=\"bodyDivClass\">\n        <div class=\"aclsty\" v-if=\"hasImage(data)\">\n            <a-carousel arrows autoplay >\n                <div  slot=\"prevArrow\"\n                    slot-scope=\"props\"\n                    class=\"custom-slick-arrow\"\n                    style=\"left: 10px;zIndex: 1\"\n                    >\n                    <a-icon type=\"left-circle\" />\n                </div>\n                <div slot=\"nextArrow\" slot-scope=\"props\" class=\"custom-slick-arrow\" style=\"right: 10px\">\n                    <a-icon type=\"right-circle\" />\n                </div>\n                <div v-for=\"obj of data\" v-if=\"obj.imgFileId\"  class=\"inglist\">\n                    <img :src=\"getImgPath(obj.imgFileId)\"></img>\n                </div>\n            </a-carousel>\n        </div>\n        <div  >\n            <ul>\n                <li class=\"itmelist\" v-for=\"(obj,index) of data\" :key=\"obj.pkId\" v-if=\"index <=5\">\n                  <p @click=\"getInsNews(obj.pkId)\">{{obj.subject}}</p>\n                  <span>{{obj.createTime}}</span>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>', `SET_TING_` = '{\"dataUrl\":\"/portal/InsNewsIssueds\",\"function\":\"portalScript.getPortalNews(colId)\",\"isNews\":\"YES\",\"newType\":\"wordsList\",\"tabgroups\":\"\",\"newDIc\":\"新闻公告\"}', `IS_PUBLIC_` = '0', `TYPE_` = '1230775094247464962', `ICON_` = NULL, `IS_MOBILE_` = '0', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = NULL, `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2021-06-26 15:52:28' WHERE `COL_ID_` = '1239837443886018562';






-- 2022-02-24 gjh  jpaas_form  表单设计暂存存
ALTER TABLE jpaas_form.form_pc ADD COLUMN TEMPLATE_TEMP_ text  COMMENT '模版(临时)';
ALTER TABLE jpaas_form.form_pc ADD COLUMN JAVASCRIPT_TEMP_ text  COMMENT '表单脚本(临时)';
ALTER TABLE jpaas_form.form_pc ADD COLUMN METADATA_TEMP_ text  COMMENT '表单数据(临时)';

-- 2022-03-02  jpaas_form   Elwin  表单业务方案加应用ID字段
ALTER TABLE jpaas_form.form_business_solution   ADD COLUMN  APP_ID_ VARCHAR(64)  COMMENT '应用ID';

-- 2022-03-04  jpaas_form   gjh  模板调整
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '主表单列模板', `ALIAS_` = 'oneColumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<table class=\"table-form two-column\" style=\"width:100%;\">\n    <caption>\n        ${ent.name}\n    </caption>\n 	<colgroup>\n            <col width=\"20%\"/>\n            <col width=\"80%\"/>\n    </colgroup>\n    <tbody>\n        <#list ent.boAttrList as field>\n			<#if (field.control!=\'rx-ref\')>\n				<tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n					<td style=\"word-break: break-all;\">\n						${field.comment}\n					</td>\n					<td>\n						<@fieldCtrl field=field type=\'main\' />\n					</td>\n				</tr>\n			</#if>\n        \n        </#list>\n    </tbody>\n</table>', `TYPE_` = 'pc', `CATEGORY_` = 'main', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-24 16:40:44', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-03-04 17:29:01', `APP_ID_` = NULL WHERE `ID_` = '1275710436348100609';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '主表双列模版', `ALIAS_` = 'twocolumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<table class=\"table-form four-column\" style=\"width:100%;\">\n    <caption>\n        ${ent.name}\n    </caption>\n   <col width=\"15%\"/>\n            <col width=\"35%\"/>\n            <col width=\"15%\"/>\n            <col width=\"35%\"/>\n    <tbody>\n	<#assign flag=0>\n    <#list ent.boAttrList as field>\n		<#if (field.control!=\'rx-ref\')>\n			<#if (!field.spans || field.spans==1)>\n			<#if (field_index ==0 || flag==0) >\n				<tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n			</#if>\n				<td style=\"word-break: break-all;\">\n					${field.comment}\n				</td>\n				<td>\n					<#assign flag++>\n					<@fieldCtrl field=field type=\'main\' />\n				</td>\n				<#if ((field_index ==0 && !field_has_next && ent.boAttrList[field_index+1].spans==2) || (ent.boAttrList[field_index-1].spans==2 && !field_has_next && ent.boAttrList[field_index+1].spans==2 ) ) >\n					<td></td>\n					<td></td>\n				</#if>\n				<#if !field_has_next || (field_index ==0  && ent.boAttrList[field_index+1].spans==2)||\n				(field_index !=0  && ent.boAttrList[field_index-1].spans==1 && ent.boAttrList[field_index+1].spans==2)||\n				(field_index !=0  && ent.boAttrList[field_index-1].spans==2 && ent.boAttrList[field_index+1].spans==2)|| \n				(field_index !=0 && ent.boAttrList[field_index+1].spans==1 && flag==2) >\n					<#assign flag=0>\n					</tr>\n				</#if>\n		<#else>	\n			<tr class=\"firstRow\">\n				<td style=\"word-break: break-all;\">\n					${field.comment}\n				</td>\n				<td rowspan=\"1\" colspan=\"3\">\n					<@fieldCtrl field=field type=\'main\' />\n				</td>\n			</tr>\n		</#if>\n		</#if>\n    </#list>\n    </tbody>\n</table>\n', `TYPE_` = 'pc', `CATEGORY_` = 'main', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:11:39', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-03-04 17:28:21', `APP_ID_` = NULL WHERE `ID_` = '1277077170606948354';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '子表行模版', `ALIAS_` = 'subOneToMany', `TEMPLATE_` = '<#setting number_format=\"#\">\n\n            <div class=\"rx-table-body active\" ctltype=\"rx-table\" tableid=\"${ent.id}\" type=\"onetomany\"\n                 id=\"${util.randomId()}\" tablename=\"${ent.alias}\">\n                <div class=\"table-header-tool\">\n                    <div class=\"title\">\n                        <div>\n                        ${ent.name}\n                        </div>\n                    </div>\n                    <a-button-group>\n                        <a-button v-on:click=\"add(\'${ent.alias}\',\'inner\')\">\n                            添加\n                        </a-button>\n                        <a-button v-on:click=\"remove(\'${ent.alias}\',\'inner\')\">\n                            删除\n                        </a-button>\n                        <a-button v-on:click=\"up(\'${ent.alias}\',\'inner\')\">\n                            上移\n                        </a-button>\n                        <a-button v-on:click=\"down(\'${ent.alias}\',\'inner\')\">\n                            下移\n                        </a-button>\n                    </a-button-group>\n                </div>\n                <div class=\"rx-table-box\">\n                    <table class=\"rx-table\">\n                        <col style=\"width: 60px;\"/>\n                         <col style=\"width: 60px;\"/>\n                         <#list ent.boAttrList as field>\n                             <#if (field.control!=\'rx-ref\')>\n                         		<col style=\"width: 160px;\"/>\n 							</#if>\n                         </#list>\n                        <thead>\n                        <tr class=\"firstRow\">\n                            <th>#</th>\n							<th>序号</th>\n                            <#list ent.boAttrList as field>\n							<#if (field.control!=\'rx-ref\')>\n                         		<th>\n                                    ${field.comment}\n                                </th>\n 							</#if>\n                            </#list>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr v-for=\"(item,index) in data.sub__${ent.alias}\" :key=\"item.index_\" v-tableselect=\"{item:item,selmode:&#39;multi&#39;,data:data.sub__${ent.alias}}\"\n                            :class=\"{active:item.selected}\">\n                            <td><a-checkbox :checked=\"item.selected\"></a-checkbox></td>\n							 <td><rx-serial :serial=\"index+1\"></rx-serial></td>\n                            <#list ent.boAttrList as field>\n                                <#if (field.control!=\'rx-ref\')>\n                                     <td>\n                                        <@fieldCtrl field=field type=\'onetomany\' entName=ent.alias />\n                                    </td>\n 								</#if>\n                            </#list>\n                        </tr>\n                        </tbody>\n                    </table>\n					<div class=\"tableEmpty\" v-if=\"data.sub__${ent.alias}&amp;&amp;data.sub__${ent.alias}.length &lt;= 0\">\n                                <a-empty></a-empty>\n                            </div>\n                </div>\n            </div>\n', `TYPE_` = 'pc', `CATEGORY_` = 'onetomany', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:29:09', `UPDATE_BY_` = '', `UPDATE_TIME_` = '2022-03-04 10:36:17', `APP_ID_` = NULL WHERE `ID_` = '1277081573669847041';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '子表双列模版', `ALIAS_` = 'subOneToOneTwoColumn', `TEMPLATE_` = '<table class=\"table-form four-column\" style=\"width:100%;\" id=\"${util.randomId()}\" type=\"onetoone\" ctltype=\"rx-table-onetoone\" tableid=\"${ent.id}\" tablename=\"${ent.alias}\">\n    <caption>\n        ${ent.name}\n    </caption>\n<colgroup>\n                        <col width=\"15%\"/>\n                        <col width=\"35%\"/>\n                        <col width=\"15%\"/>\n                        <col width=\"35%\"/>\n                    </colgroup>\n    <tbody>\n    <#list ent.boAttrList as field>\n		<#if (field.control!=\'rx-ref\')>\n           <#if (field_index % 2==0)>\n            <tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n        </#if>\n        <td style=\"word-break: break-all;\">\n            ${field.comment}\n        </td>\n        <td>\n            <@fieldCtrl field=field type=\'onetoone\' entName=ent.alias />\n        </td>\n\n        <#if field_index % 2 == 0 && !field_has_next>\n            <td></td>\n            <td></td>\n        </#if>\n        <#if field_index % 2 == 1 || !field_has_next>\n            </tr>\n        </#if>              		\n 		</#if>\n    </#list>\n    </tbody>\n</table>', `TYPE_` = 'pc', `CATEGORY_` = 'onetoone', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:45:31', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-03-04 10:38:23', `APP_ID_` = NULL WHERE `ID_` = '1277085691964669953';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '子表单列模版', `ALIAS_` = 'subWinOneColumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<div class=\"rx-table-body\" ctltype=\"rx-table\" type=\"onetomany\" id=\"${util.randomId()}\" tableid=\"${ent.id}\" tablename=\"${ent.alias}\" tabname=\"${ent.alias}\" style=\"width:100%\">\n        <div class=\"table-header-tool\">\n            <div class=\"title\">\n                <div>\n                    ${ent.name}\n                </div>\n            </div>\n            <a-button-group v-if=\"!getReadonly()\">\n                 <a-button  v-if=\"getSubTablePermission(\'${ent.alias}\',\'add\')\" v-on:click=\"add(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    添加\n                </a-button>\n  				<a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'edit\')\" v-on:click=\"edit(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    编辑\n                </a-button>\n                <a-button  v-if=\"getSubTablePermission(\'${ent.alias}\',\'remove\')\" v-on:click=\"remove(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    删除\n                </a-button>\n                <a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'up\')\" v-on:click=\"up(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    上移\n                </a-button>\n                <a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'down\')\" v-on:click=\"down(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    下移\n                </a-button>\n            </a-button-group>\n        </div>\n        <div class=\"rx-table-box\" style=\"display: none\">\n            <table class=\"rx-table\">\n                <colgroup>\n                    <col style=\"width: 60px;\"/>\n            		<col style=\"width: 60px;\"/>\n                   	<#list ent.boAttrList as field>\n                            <col style=\"width: 160px;\"/>\n                    </#list>\n                   \n                </colgroup>\n                <thead>\n                    <tr class=\"firstRow\">\n                        <th>#</th>\n                        <th>序号 </th>\n                       <#list ent.boAttrList as field>\n                            <th>\n                                ${field.comment}\n                            </th>\n                        </#list>\n                    </tr>\n                </thead>\n                <tbody>\n				<tr v-if=\"item\" v-for=\"(item,index) in data.sub__${ent.alias}\" :key=\"item.index_\" v-tableselect=\"{item:item,selmode:&#39;multi&#39;,data:data.sub__${ent.alias}}\" :class=\"{active:item.selected}\" dblclick=\"edit(\'${ent.alias}\')\">\n                         <td><a-checkbox :checked=\"item.selected\"></a-checkbox> </td>\n						 <td>${index + 1}</td>\n                        <#list ent.boAttrList as field>\n                            <td>\n                                <@fieldCtrl field=field type=\'onetomany\' entName=ent.alias readonly=true />\n                            </td>\n                        </#list>\n                    </tr>\n                </tbody>\n            </table>\n            <div class=\"tableEmpty\" v-if=\"data.sub__${ent.alias} && data.sub__${ent.alias}.length <= 0\">\n                <a-empty></a-empty>\n            </div>\n        </div>\n        <div class=\"rx-table-dialog\"  v-if=\"0\"   id=\"dialog_${ent.alias}\" >\n            <div class=\"dialog-header\">\n                ${ent.name}\n            </div>\n\n            <table class=\"table-detail column-two table-align\" style=\"width:100%;\">\n                <colgroup>\n                  	<col width=\"20%\"/>\n                    <col width=\"80%\"/>\n                </colgroup>\n                <tbody>\n                  <#list ent.boAttrList as field>\n                      <tr>\n                        <td>${field.comment}</td>\n                        <td>\n                            <@fieldCtrl field=field type=\'onetomany\' entName=ent.alias isAttr=\'false\'/>\n                        </td>\n                      </tr>\n                    </#list>\n                </tbody>\n            </table>\n        </div>\n    </div>\n', `TYPE_` = 'pc', `CATEGORY_` = 'onetomany', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:46:31', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-02-21 16:42:27', `APP_ID_` = NULL WHERE `ID_` = '1277085945392906241';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '子表双列模版', `ALIAS_` = 'subWinTwoColumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<div class=\"rx-table-body\" ctltype=\"rx-table\" type=\"onetomany\" id=\"${util.randomId()}\" tableid=\"${ent.id}\" tablename=\"${ent.alias}\" tabname=\"${ent.alias}\" style=\"width:100%\">\n        <div class=\"table-header-tool\">\n            <div class=\"title\">\n                <div>\n                    ${ent.name}\n                </div>\n            </div>\n            <a-button-group v-if=\"!getReadonly()\">\n                 <a-button  v-if=\"getSubTablePermission(\'${ent.alias}\',\'add\')\" v-on:click=\"add(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    添加\n                </a-button>\n  				<a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'edit\')\" v-on:click=\"edit(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    编辑\n                </a-button>\n                <a-button  v-if=\"getSubTablePermission(\'${ent.alias}\',\'remove\')\" v-on:click=\"remove(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    删除\n                </a-button>\n                <a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'up\')\" v-on:click=\"up(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    上移\n                </a-button>\n                <a-button v-if=\"getSubTablePermission(\'${ent.alias}\',\'down\')\" v-on:click=\"down(\'${ent.alias}\',\'window\',\'${ent.name}\')\">\n                    下移\n                </a-button>\n            </a-button-group>\n        </div>\n        <div class=\"rx-table-box\" style=\"display: none\">\n            <table class=\"rx-table\">\n                <colgroup>\n                    <col style=\"width: 60px;\"/>\n            		<col style=\"width: 60px;\"/>\n                   	<#list ent.boAttrList as field>\n						<#if (field.control!=\'rx-ref\')>\n							<col style=\"width: 160px;\"/>\n						</#if> \n                    </#list>\n                   \n                </colgroup>\n                <thead>\n                    <tr class=\"firstRow\">\n                        <th>#</th>\n						<th style=\"text-align:center;\">选择</th>\n                       <#list ent.boAttrList as field>\n						   <#if (field.control!=\'rx-ref\')>\n								 <th>\n									${field.comment}\n								</th>\n							</#if> \n                        </#list>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr v-if=\"item\" v-for=\"(item,index) in data.sub__${ent.alias}\" :key=\"item.index_\" v-select=\"item\" :class=\"{active:item.selected}\" dblclick=\"edit(\'${ent.alias}\')\">\n                        <td>${index + 1}</td>\n   						<td style=\"text-align:center;\"><a-checkbox :checked=\"item.selected\" @change=\'item=>item.selected==!item.selected\'></a-checkbox></td>\n                        <#list ent.boAttrList as field>\n							<#if (field.control!=\'rx-ref\')>\n								<td>\n									<@fieldCtrl field=field type=\'onetomany\' entName=ent.alias readonly=true />\n								</td>\n							</#if>\n                        </#list>\n                    </tr>\n                </tbody>\n            </table>\n            <div class=\"tableEmpty\" v-if=\"data.sub__${ent.alias} && data.sub__${ent.alias}.length <= 0\">\n                <a-empty></a-empty>\n            </div>\n        </div>\n        <div class=\"rx-table-dialog\"  v-if=\"0\"   id=\"dialog_${ent.alias}\" >\n            <div class=\"dialog-header\">\n                ${ent.name}\n            </div>\n\n            <table class=\"table-detail column-four table-align\" style=\"width:100%;\">\n                <colgroup>\n                    <col width=\"15%\"/>\n                    <col width=\"35%\"/>\n                    <col width=\"15%\"/>\n                    <col width=\"35%\"/>\n                </colgroup>\n                <tbody>\n                   <#list ent.boAttrList as field>\n						<#if (field.control!=\'rx-ref\')>\n								<#if (field_index % 2==0)>\n                            <tr>\n                        </#if>\n                        <td style=\"word-break: break-all;\">\n                            ${field.comment}\n                        </td>\n                        <td>\n                            <@fieldCtrl field=field type=\'onetomany\' entName=ent.alias isAttr=\'false\' />\n                        </td>\n\n                        <#if field_index % 2 == 0 && !field_has_next>\n                            <td></td>\n                            <td></td>\n                        </#if>\n                        <#if field_index % 2 == 1 || !field_has_next>\n                            </tr>\n                        </#if>\n						</#if>\n\n                    </#list>\n                </tbody>\n            </table>\n        </div>\n    </div>', `TYPE_` = 'pc', `CATEGORY_` = 'onetomany', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:47:20', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-03-04 10:40:27', `APP_ID_` = NULL WHERE `ID_` = '1277086151886880770';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '子表单列模版', `ALIAS_` = 'subOneToOne', `TEMPLATE_` = '<table class=\"table-form two-column\" style=\"width:100%;\" id=\"${util.randomId()}\" type=\"onetoone\" ctltype=\"rx-table-onetoone\" tableid=\"${ent.id}\" tablename=\"${ent.alias}\">\n    <caption>\n        ${ent.name}\n    </caption>\n    <colgroup>\n            <col width=\"20%\"/>\n            <col width=\"80%\"/>\n    </colgroup>\n    <tbody>\n    <#list ent.boAttrList as field>\n    <tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n        <td style=\"word-break: break-all;\">\n            ${field.comment}\n        </td>\n        <td>\n            <@fieldCtrl field=field type=\'onetoone\' entName=ent.alias />\n        </td>\n    </tr>\n    </#list>\n    </tbody>\n</table>\n', `TYPE_` = 'pc', `CATEGORY_` = 'onetoone', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:52:12', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2020-12-11 17:51:11', `APP_ID_` = NULL WHERE `ID_` = '1277087373637304321';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '字段控件模版', `ALIAS_` = 'fieldCtrl', `TEMPLATE_` = '<#setting number_format=\"#\">\n<#macro fieldCtrl field type entName readonly isAttr>\n    <${field.control} class=\"${field.control}\" isattr=\"${isAttr}\" type=\"${type}\" ctltype=\"${field.control}\" style=\"width:100%\"\n                        <@attrJson field=field type=type entName=entName readonly=readonly/>\n            ></${field.control}>\n</#macro>\n\n<#macro attrJson field type entName readonly>\n    :readonly=\"${readonly???string(readonly,\'readonly\')}\" ctlid=\"${field.id}\"\n    <#if (type==\'main\')>\n        id=\"${util.randomId()}\" :permission=\"permission.${field.name}\" v-model=\"data.${field.name}\"\n        :valid=\"validFunc(\'main\',\'${field.name}\')\"\n        v-on:enter=\"enter(\'main\',\'${field.name}\')\"\n        v-on:valuechange=\"valuechange(\'main\',\'${field.name}\')\"\n    <#elseif (type==\'onetoone\')>\n		id=\"${field.name}${field.id}\"\n        :permission=\"permission.sub__${entName}.${field.name}\"\n        :valid=\"validFunc(\'${entName}\',\'${field.name}\',item)\"\n        v-model=\"data.sub__${entName}.${field.name}\"\n        v-on:enter=\"enter(\'${entName}\',\'${field.name}\',item)\"\n        v-on:valuechange=\"valuechange(\'${entName}\',\'${field.name}\',item)\"\n    <#else>\n		id=\"${field.name}${field.id}\"\n        :permission=\"permission.sub__${entName}.${field.name}\" v-model=\"item.${field.name}\" :data=\"item\"\n        :valid=\"validFunc(\'${entName}\',\'${field.name}\',index)\"\n        v-on:enter=\"enter(\'${entName}\',\'${field.name}\',item)\"\n        v-on:valuechange=\"valuechange(\'${entName}\',\'${field.name}\',item)\"\n        length=\"${field.length}\" from=\"input\"\n    </#if>\n</#macro>\n\n\n', `TYPE_` = 'pc', `CATEGORY_` = 'field', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '2', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-06-28 11:25:34', `UPDATE_BY_` = '', `UPDATE_TIME_` = '2022-03-09 15:07:46', `APP_ID_` = NULL, `COMPANY_ID_` = NULL, `SHARE_` = NULL WHERE `ID_` = '1277080670808162306';

-- 2022-03-09  jpaas_seata   gjh  seata加status字段
-- ALTER TABLE jpaas_seata.lock_table ADD COLUMN  status VARCHAR(64);

-- 2022-03-22  jpaas_system   gjh  新增机构标签数据字典分类
INSERT INTO `jpaas_system`.`sys_tree`(`TREE_ID_`, `CODE_`, `NAME_`, `PATH_`, `PARENT_ID_`, `ALIAS_`, `DESCP_`, `CAT_KEY_`, `SN_`, `DATA_SHOW_TYPE_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `APP_ID_`) VALUES ('1506093829300498434', NULL, '机构标签', '0.1506093829300498434.', '0', 'instLabel', NULL, 'DIC', 1, 'FLAT', '1', '1', '1', '2022-03-22 10:22:05', NULL, '2022-03-22 10:22:05', NULL, '');
-- 2022-03-22  jpaas_user   gjh 新增机构标签字段
ALTER TABLE jpaas_user.OS_INST ADD COLUMN  LABEL_ VARCHAR(64)  COMMENT '标签';

-- 2022-03-25  jpaas_system   gjh 菜单新增机构个性化配置
ALTER TABLE jpaas_system.sys_menu ADD COLUMN  INST_CONFIG_ TEXT COMMENT '机构个性化配置';

-- 2022-04-08  gjh 新增数据源同步表单
ALTER TABLE jpaas_user.os_inst ADD COLUMN  DATASOURCE_ VARCHAR(64) COMMENT '数据源';
ALTER TABLE jpaas_form.form_bo_entity ADD COLUMN IS_TENANT_ VARCHAR(20) COMMENT '是否为租户使用';
ALTER TABLE jpaas_form.form_datasource_def ADD COLUMN IS_TENANT_ VARCHAR(20) COMMENT '是否为租户使用';
ALTER TABLE jpaas_form.form_datasource_def ADD COLUMN CHANGE_SN_ int(20) COMMENT '变更记录序号';
CREATE TABLE jpaas_form.FORM_CHANGE_LOG
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    BO_ALIAS_ varchar(64)  DEFAULT NULL COMMENT 'BO实体别名',
    BO_NAME_ varchar(64)  DEFAULT NULL COMMENT 'BO实体名称',
    SQL_ varchar(1000)  DEFAULT NULL COMMENT 'SQL语句',
    TYPE_ varchar(64)  DEFAULT NULL COMMENT '类型',
    SN_ int(11)  DEFAULT NULL COMMENT '序号',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_form.FORM_CHANGE_LOG COMMENT '表单变更记录';

CREATE TABLE jpaas_form.FORM_EXECUTE_LOG
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    CHANGE_LOG_ID_ varchar(64)  DEFAULT NULL COMMENT '表单变更记录ID',
    DATASOURCE_ varchar(64)  DEFAULT NULL COMMENT '数据源别名',
    SQL_ varchar(1000)  DEFAULT NULL COMMENT '执行的SQL语句',
    STATUS_ varchar(20)  DEFAULT NULL COMMENT '状态(1:成功 0:失败 -1:忽略)',
    RECORD_ text  DEFAULT NULL COMMENT '记录',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_BY_NAME_ varchar(64)  DEFAULT NULL COMMENT '创建人名称',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    BATCH_ varchar(64)  DEFAULT NULL COMMENT '批次',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_form.FORM_EXECUTE_LOG COMMENT '租户数据源执行记录';

INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1510097722216865794', '1216010678984933378', '同步执行记录', '{\"type\":\"customIcon\",\"icon\":\"iconfile-protect\"}', 'iconfile-protect', NULL, '1511976729900240897', '0.1511976729900240897.1510097722216865794.', 2, 'URL', 'FormExecuteLogList.vue', 'C', 'modules/form/core/FormExecuteLogList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-04-02 11:32:08', '1', '2022-04-07 16:01:42', NULL, 'N', NULL);
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1511893459128832002', '1216010678984933378', '表单同步', '{\"type\":\"customIcon\",\"icon\":\"iconshujudaochu\"}', 'iconshujudaochu', NULL, '1511976729900240897', '0.1511976729900240897.1511893459128832002.', 1, 'URL', 'FormChangeLogs', 'C', 'modules/form/core/FormChangeLogs.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-04-07 10:27:45', '1', '2022-04-08 11:27:44', NULL, 'N', NULL);
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1511976729900240897', '1216010678984933378', '数据源表单同步', '{\"type\":\"customIcon\",\"icon\":\"iconxinwendongtaixuanzhong\"}', 'iconxinwendongtaixuanzhong', NULL, '0', '0.1511976729900240897.', 11, 'URL', 'syncForm', 'C', NULL, 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-04-07 15:58:38', NULL, '2022-04-07 15:58:38', NULL, 'N', NULL);
INSERT INTO `jpaas_user`.`os_inst_type_menu`(`ID_`, `INST_TYPE_ID_`, `APP_ID_`, `MENU_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1511977221820817597', '1', '1216010678984933378', '1511976729900240897', '数据源表单同步', '{\"type\":\"customIcon\",\"icon\":\"iconxinwendongtaixuanzhong\"}', 'iconxinwendongtaixuanzhong', NULL, '1216010678984933378', NULL, 11, 'URL', 'syncForm', 'C', NULL, 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-04-07 07:58:38', NULL, '2022-04-07 07:58:38');
-- 2022-04-06  jpaas-system hj web请求定义新增是否记录日志字段
ALTER TABLE jpaas_system.sys_webreq_def ADD COLUMN  IS_LOG_ varchar(10) COMMENT '是否记录日志';
-- 修改第三方接口日志菜单
UPDATE jpaas_system.sys_menu SET COMPONENT_='modules/system/core/SysHttpTaskList.vue',NAME_='外围系统回调日志' WHERE MENU_ID_='1296014599562817538';
UPDATE jpaas_user.os_inst_type_menu SET COMPONENT_='modules/system/core/SysHttpTaskList.vue',NAME_='外围系统回调日志' WHERE MENU_ID_='1296014599562817538';
UPDATE jpaas_user.os_group_menu SET COMPONENT_='modules/system/core/SysHttpTaskList.vue',NAME_='外围系统回调日志' WHERE MENU_ID_='1296014599562817538';
-- 修改第三方接口日志表名sys_http_task_log
ALTER  TABLE jpaas_system.sys_interface_call_logs RENAME TO jpaas_system.sys_http_task_log;
-- 修改第三方接口日志表字段TASK_ID_
ALTER TABLE jpaas_system.sys_http_task_log CHANGE INTERFACE_ID_ TASK_ID_ VARCHAR(64) COMMENT '任务ID';
-- 增加日志结果字段
ALTER TABLE jpaas_system.sys_http_task_log  ADD COLUMN `RESULT_`  varchar(10) NULL COMMENT '日志结果' ;
-- 创建接口调用表
CREATE TABLE jpaas_system.SYS_HTTP_TASK (
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    TYPE_ varchar(20) DEFAULT NULL COMMENT '类型',
    REL_ID_ varchar(64) DEFAULT NULL COMMENT '关联ID',
    REL_NAME_ varchar(200) DEFAULT NULL COMMENT '关联名称',
    BEAN_NAME_ varchar(64)  DEFAULT NULL COMMENT '类名',
    METHOD_ varchar(64)  DEFAULT NULL COMMENT '方法名',
    PARAMS_ text  DEFAULT NULL COMMENT '方法参数',
    STATUS_ VARCHAR(20) DEFAULT NULL COMMENT '状态',
    EXECUTE_TIMES_ INT DEFAULT NULL COMMENT '执行次数',
    MAX_ATTEMPTS_ INT DEFAULT NULL COMMENT '重试次数',
    DELAY_ INT DEFAULT NULL COMMENT '重试时间间隔',
    MULTIPLIER_ decimal(14,2) DEFAULT NULL COMMENT '延迟倍率',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_system.SYS_HTTP_TASK COMMENT '接口调用表';

INSERT INTO jpaas_job.xxl_job_group (id, app_name, title, order_, address_type, address_list)    VALUES ('1385486577859444739', 'system-job', '系统执行器',1, 0, null);

INSERT INTO jpaas_job.xxl_job_info(id, job_group, job_cron, job_desc, add_time, update_time, author, alarm_email, executor_route_strategy, executor_handler, executor_param, executor_block_strategy, executor_timeout, executor_fail_retry_count, glue_type, glue_source, glue_remark, glue_updatetime, child_jobid, trigger_status, trigger_last_time, trigger_next_time)
        VALUES ('1385489751253073923', '1385486577859444739', '* /5 * * * ?', '执行失败任务', '2021-3-2 14:11:40', '2021-3-2 16:57:46', 'admin', '', 'FIRST', 'sysHttpTaskHandler', '', 'SERIAL_EXECUTION', 0, 0, 'BEAN', '', 'GLUE代码初始化', '2021-3-2 14:11:40', '', 0, 0, 0);

-- 2022-04-08  yl job脚本更新
ALTER TABLE jpaas_job.xxl_job_group ADD COLUMN  update_time datetime COMMENT '更新时间';
ALTER TABLE jpaas_job.xxl_job_info ADD COLUMN  schedule_type varchar(64) COMMENT '调度类型';
ALTER TABLE jpaas_job.xxl_job_info ADD COLUMN  schedule_conf varchar(128) COMMENT '调度配置，值含义取决于调度类型';
ALTER TABLE jpaas_job.xxl_job_info ADD COLUMN  misfire_strategy varchar(64) COMMENT '调度过期策略';

ALTER TABLE jpaas_job.xxl_job_info DROP job_cron;

-- 2022-04-13 yl 大屏脚本更新
update jpaas_system.sys_menu set params_="/screen/#/panel/index" where  menu_id_ = '1472821869619146754';
update jpaas_system.sys_menu set params_="/screen/#/chart/index" where  menu_id_ = '1472822224515985409';
update jpaas_system.sys_menu set params_="/screen/#/dataset/index" where  menu_id_ = '1472822342455619586';
update jpaas_system.sys_menu set params_="/screen/#/datasource/index" where  menu_id_ = '1472822555371073537';

-- 2022-04-22 jpaas-form hj 角色数据权限支持树形数据
ALTER TABLE jpaas_form.form_entity_data_type  ADD COLUMN DATA_SHOW_TYPE_ VARCHAR(20)  COMMENT '展示方式';

ALTER TABLE jpaas_form.form_entity_data_setting_dic  ADD COLUMN PARENT_VALUE_ VARCHAR(64)  COMMENT '父内容',
                                                     ADD COLUMN PATH_ VARCHAR(256) COMMENT '路径',
                                                     ADD COLUMN SN_ int COMMENT '序号';

-- 2022-04-25 jpaas-form gjh 新增数据关联删除约束
CREATE TABLE jpaas_form.FORM_ENT_RELATION
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    ENT_ID_ varchar(64) DEFAULT NULL COMMENT '实体ID',
    ENT_NAME_ varchar(64) DEFAULT NULL COMMENT '实体名称',
    TABLE_NAME_ varchar(64) DEFAULT NULL COMMENT '表名',
    RELATION_CONFIG_ text DEFAULT NULL COMMENT '关联配置',
    PROMPT_FIELD_ varchar(64) DEFAULT NULL COMMENT '提示字段',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_form.FORM_ENT_RELATION COMMENT '数据关联删除约束';



-- 2022-04-28 jpaas-form gjh 实体管理新增暂存的实体属性
ALTER TABLE jpaas_form.form_bo_entity ADD COLUMN BO_ATTR_TEMP_ LONGTEXT  COMMENT '暂存的实体属性';

-- 2022-05-05 jpaas-form gjh 打印模板加上租户个性化的标签
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '主表双列模版', `ALIAS_` = 'twoColumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<table class=\"table-form four-column\" style=\"width:100%;\">\n    <caption>\n        ${ent.name}\n    </caption>\n    <tbody>\n    <#list ent.boAttrList as field>\n        <#if (field_index % 2==0)>\n        <tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n        </#if>\n            <td style=\"word-break: break-all;\">\n                <#if ent.isTenant==1>\n                     <#noparse>${label.</#noparse>${field.name}<#noparse>}</#noparse>\n                 <#else>\n                     ${field.comment}\n                </#if>\n\n            </td>\n            <td>\n                <@getField attr=field pre=\"\" />\n            </td>\n\n            <#if field_index % 2 == 0 && !field_has_next>\n                <td></td>\n                <td></td>\n            </#if>\n            <#if field_index % 2 == 1 || !field_has_next>\n                </tr>\n            </#if>\n    </#list>\n    </tbody>\n</table>', `TYPE_` = 'print', `CATEGORY_` = 'main', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-07-01 17:25:26', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-05-05 15:18:03', `APP_ID_` = NULL WHERE `ID_` = '1278258401062789122';
UPDATE `jpaas_form`.`form_template` SET `NAME_` = '主表单列模板', `ALIAS_` = 'oneColumn', `TEMPLATE_` = '<#setting number_format=\"#\">\n<table class=\"table-form two-column\" style=\"width:100%;\">\n    <caption>\n        ${ent.name}\n    </caption>\n    <tbody>\n        <#list ent.boAttrList as field>\n        <tr <#if (field_index==0)>class=\"firstRow\"</#if>>\n            <td style=\"word-break: break-all;\">\n               <#if ent.isTenant==1>\n                     <#noparse>${label.</#noparse>${field.name}<#noparse>}</#noparse>\n                 <#else>\n                     ${field.comment}\n                </#if>\n            </td>\n            <td>\n                <@getField attr=field pre=\"\" />\n            </td>\n        </tr>\n        </#list>\n    </tbody>\n</table>', `TYPE_` = 'print', `CATEGORY_` = 'main', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '', `CREATE_BY_` = '1', `CREATE_TIME_` = '2020-07-01 17:25:41', `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-05-05 15:28:33', `APP_ID_` = NULL WHERE `ID_` = '1278258462500954113';

-- 2022-05-06 jpaas-form gjh 自定义查询与对话框加上租户使用配置
ALTER TABLE jpaas_form.form_bo_list ADD COLUMN IS_TENANT_ VARCHAR(20) COMMENT '是否为租户使用';
ALTER TABLE jpaas_form.form_custom_query ADD COLUMN IS_TENANT_ VARCHAR(20) COMMENT '是否为租户使用';

-- 2022-05-09 jpaas-form hj 数据列表增加扩展属性字段
ALTER TABLE jpaas_form.form_bo_list ADD COLUMN EXT_JSON_ LONGTEXT COMMENT '扩展属性';

-- 2022-05-09 jpaas-form hj 数据列表删除多余字段，将配置统一放入EXT_JSON_字段
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP URL_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP BPM_SOL_ID_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_EXPORT_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ENABLE_FLOW_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP MOBILE_HTML_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP SOL_ID_;
ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_SHARE_;

UPDATE JPAAS_FORM.FORM_BO_LIST SET EXT_JSON_ =
CONCAT("{",
	CONCAT_WS(",",
		CONCAT("\"idField\":\"",ID_FIELD_,"\""),
		CONCAT("\"textField\":\"",TEXT_FIELD_,"\""),
		CONCAT("\"parentField\":\"",PARENT_FIELD_,"\""),
		CONCAT("\"onlySelLeaf\":\"",ONLY_SEL_LEAF_,"\""),
		CONCAT("\"multiSelect\":\"",MULTI_SELECT_,"\""),
		CONCAT("\"isLeftTree\":\"",IS_LEFT_TREE_,"\""),
		CONCAT("\"leftTreeJson\":",LEFT_TREE_JSON_),
		CONCAT("\"sql\":\"",SQL_,"\""),
		CONCAT("\"useCondSql\":\"",USE_COND_SQL_,"\""),
		CONCAT("\"condSqls\":\"",COND_SQLS_,"\""),
		CONCAT("\"fieldsJson\":",FIELDS_JSON_),
		CONCAT("\"colsJson\":",COLS_JSON_),
		CONCAT("\"searchJson\":",SEARCH_JSON_),
		CONCAT("\"formAlias\":\"",FORM_ALIAS_,"\""),
		CONCAT("\"topBtnsJson\":",TOP_BTNS_JSON_),
		CONCAT("\"bodyScript\":\"",BODY_SCRIPT_,"\""),
		CONCAT("\"isPage\":\"",IS_PAGE_,"\""),
		CONCAT("\"pageSize\":",PAGE_SIZE_),
		CONCAT("\"isLazy\":\"",IS_LAZY_,"\""),
		CONCAT("\"height\":",HEIGHT_),
		CONCAT("\"width\":",WIDTH_),
		CONCAT("\"isMax\":\"",IS_MAX_,"\""),
		CONCAT("\"isShade\":\"",IS_SHADE_,"\""),
		CONCAT("\"dataStyle\":\"",DATA_STYLE_,"\""),
		CONCAT("\"rowEdit\":\"",ROW_EDIT_,"\""),
		CONCAT("\"showSummaryRow\":\"",SHOW_SUMMARY_ROW_,"\""),
		CONCAT("\"isInitData\":\"",IS_INIT_DATA_,"\""),
		CONCAT("\"formDetailAlias\":\"",FORM_DETAIL_ALIAS_,"\""),
		CONCAT("\"templateType\":\"",TEMPLATE_TYPE_,"\""),
		CONCAT("\"formAddAlias\":\"",FORM_ADD_ALIAS_,"\""),
		CONCAT("\"webreqKey\":\"",WEBREQ_KEY_,"\""),
		CONCAT("\"webreqScript\":\"",WEBREQ_SCRIPT_,"\""),
		CONCAT("\"webreqMappingJson\":",WEBREQ_MAPPING_JSON_),
		CONCAT("\"interfaceKey\":\"",INTERFACE_KEY_,"\""),
		CONCAT("\"interfaceName\":\"",INTERFACE_NAME_,"\""),
		CONCAT("\"interfaceMappingJson\":",INTERFACE_MAPPING_JSON_),
		CONCAT("\"formName\":\"",FORM_NAME_,"\""),
		CONCAT("\"formDetailName\":\"",FORM_DETAIL_NAME_,"\""),
		CONCAT("\"formAddName\":\"",FORM_ADD_NAME_,"\""),
		CONCAT("\"publishConf\":",PUBLISH_CONF_),
		CONCAT("\"mobileButton\":",MOBILE_BUTTON),
		CONCAT("\"mobileJs\":\"",MOBILE_JS,"\""),
		CONCAT("\"isCheckboxProps\":\"",IS_CHECKBOX_PROPS,"\""),
		CONCAT("\"expandLevel\":\"",EXPAND_LEVEL,"\""),
		CONCAT("\"rowDblClick\":\"",ROW_DBL_CLICK_,"\""),
		CONCAT("\"rowClick\":\"",ROW_CLICK_,"\""),
		CONCAT("\"isSearchHeader\":\"",IS_SEARCH_HEADER,"\""),
		CONCAT("\"isTest\":\"",IS_TEST_,"\""),
		CONCAT("\"buttonMax\":",BUTTON_MAX),
		CONCAT("\"isApproval\":\"",IS_APPROVAL,"\""),
		CONCAT("\"isExpandRow\":\"",IS_EXPAND_ROW,"\""),
		CONCAT("\"expandRowJson\":",EXPAND_ROW_JSON),
		CONCAT("\"excelConfJson\":",EXCEL_CONF_JSON),
		CONCAT("\"instColumnConfig\":",INST_COLUMN_CONFIG_),
		CONCAT("\"busSolution\":",if(BUS_SOLUTION_="","\"\"",BUS_SOLUTION_)),
		CONCAT("\"searchMax\":",SEARCH_MAX),
		CONCAT("\"isTenant\":\"",IS_TENANT_,"\"")
	)
,"}");
-- 可选
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ID_FIELD_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP TEXT_FIELD_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP PARENT_FIELD_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ONLY_SEL_LEAF_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP MULTI_SELECT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_LEFT_TREE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP LEFT_TREE_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP SQL_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP USE_COND_SQL_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP COND_SQLS_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FIELDS_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP COLS_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP SEARCH_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_ALIAS_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP TOP_BTNS_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP BODY_SCRIPT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP LEFT_NAV_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP DRAW_CELL_SCRIPT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_PAGE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP PAGE_SIZE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_LAZY_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP HEIGHT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP WIDTH_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_MAX_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_SHADE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP DATA_STYLE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ROW_EDIT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP SHOW_SUMMARY_ROW_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_INIT_DATA_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_DETAIL_ALIAS_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP TEMPLATE_TYPE_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_ADD_ALIAS_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP WEBREQ_KEY_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP WEBREQ_SCRIPT_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP WEBREQ_MAPPING_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP INTERFACE_KEY_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP INTERFACE_NAME_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP INTERFACE_MAPPING_JSON_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_NAME_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_DETAIL_NAME_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP FORM_ADD_NAME_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP PUBLISH_CONF_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP MOBILE_BUTTON;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP MOBILE_JS;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_CHECKBOX_PROPS;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP EXPAND_LEVEL;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ROW_DBL_CLICK_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP ROW_CLICK_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_SEARCH_HEADER;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_TEST_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP BUTTON_MAX;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_APPROVAL;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_EXPAND_ROW;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP EXPAND_ROW_JSON;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP EXCEL_CONF_JSON;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP INST_COLUMN_CONFIG_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP BUS_SOLUTION_;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP SEARCH_MAX;
-- ALTER TABLE JPAAS_FORM.FORM_BO_LIST DROP IS_TENANT_;


-- 2022-05-5 jpaas-user zfh 密码安全策略管理配置
CREATE TABLE jpaas_user.os_password_policy_configure
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    MIN_LENGTH_ int(11) DEFAULT NULL COMMENT '最小密码长度',
    ERROR_TIME_ int(11) DEFAULT NULL COMMENT '最多错误输入密码错误次数',
    ACCOUNT_LOCK_DAY_ int(11) DEFAULT NULL COMMENT '账号锁定天数',
    IS_MIX_ varchar(20) DEFAULT NULL COMMENT '密码同时由英文大小写特殊字符和数字构成',
    IS_NEVER_TIMEOUT_ varchar(20) DEFAULT NULL COMMENT '密码永不过期',
	IS_FIRST_LOGIN_UPDATE_ varchar(20) DEFAULT NULL COMMENT '用户首次登录必须修改密码',
	IS_USERNAME_PWD_CONSISTENT_ varchar(20) DEFAULT NULL COMMENT '用户名密码能否一致',
	TIMEOUT_DAY_ int(11) DEFAULT NULL COMMENT '密码过期时间（天）',
	INFORM_DAY_ int(11) DEFAULT NULL COMMENT '几天后通知修改密码（天）',
	INFORM_FREQUENCY_ int(11) DEFAULT NULL COMMENT '通知频率(每隔多少天通知一次)',
	INFORM_TYPE_ varchar(20) DEFAULT NULL COMMENT '密码修改通知方式',
	INFORM_CONTENT_ varchar(500) DEFAULT NULL COMMENT '通知内容',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_user.os_password_policy_configure COMMENT '密码安全策略管理配置';

CREATE TABLE jpaas_user.os_password_input_error
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    USER_NO_ varchar(64) DEFAULT NULL COMMENT '用户编号',
	ERROR_TIME_ int(11) DEFAULT NULL COMMENT '用户错误输入密码错误次数',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_user.os_password_input_error COMMENT '用户密码输入错误记录表';

ALTER TABLE jpaas_user.os_user ADD COLUMN IS_LOCK_ VARCHAR(20)  COMMENT '账号是否锁定';

ALTER TABLE jpaas_user.os_user ADD COLUMN PWD_UPDATE_TIME_ datetime  COMMENT '密码修改时间';

ALTER TABLE jpaas_user.os_user ADD COLUMN IS_FIRST_LOGIN_ VARCHAR(20)  COMMENT '用户是否首次登录';

INSERT INTO jpaas_system.sys_menu VALUES ('1522125564984745986', '1208980200670081026', '密码策略配置', '{\"type\":\"customIcon\",\"icon\":\"iconjichucanshu\"}', 'iconjichucanshu', null, '1192842689568784386', '1522125564984745986.', '3', 'URL', 'OsPasswordPolicyConfigureEdit', 'C', 'modules/user/org/OsPasswordPolicyConfigureEdit', 'custom', null, null, null, null, '1', '1502226069801971714', '1', '2022-05-05 16:06:29', null, '2022-05-05 16:06:29', null, 'N', null);

-- 2022-05-11 jpaas-form gjh  表单元数据字段调整为longtext
ALTER TABLE JPAAS_FORM.FORM_PC    CHANGE METADATA_ METADATA_ LONGTEXT NULL  COMMENT '表单元数据';
ALTER TABLE JPAAS_FORM.FORM_PC_HISTORY    CHANGE METADATA_ METADATA_ LONGTEXT NULL  COMMENT '表单元数据';
ALTER TABLE JPAAS_FORM.FORM_MOBILE    CHANGE METADATA_ METADATA_ LONGTEXT NULL  COMMENT '表单元数据';

-- 2022-05-11 jpaas-form gjh  移动端表单元html字段调整为longtext
ALTER TABLE JPAAS_FORM.FORM_MOBILE    CHANGE FORM_HTML_ FORM_HTML_ LONGTEXT NULL  COMMENT '表单HTML';

-- 2022-05-11 jpaas-system gjh  新增对外API接口管理
CREATE TABLE JPAAS_SYSTEM.SYS_EXTERNAL_API
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    SERVICE_ varchar(64)  DEFAULT NULL COMMENT '所属服务',
    API_NAME_ varchar(64)  DEFAULT NULL COMMENT 'API接口名称',
    PATH_ varchar(200)  DEFAULT NULL COMMENT '路径',
    METHOD_ varchar(64)  DEFAULT NULL COMMENT '请求方法',
    PARAMS_ text  DEFAULT NULL COMMENT '请求参数',
    HEADERS_ text  DEFAULT NULL COMMENT '请求头',
    BODY_ text  DEFAULT NULL COMMENT '请求体',
    TYPE_ varchar(64)  DEFAULT NULL COMMENT '类型',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    COMPANY_ID_ varchar(64)  DEFAULT NULL COMMENT '所属公司ID',
    PRIMARY KEY (ID_)
);
ALTER TABLE JPAAS_SYSTEM.SYS_EXTERNAL_API COMMENT '对外API接口管理';



-- 2022-05-11 jpaas_bpm zfh 流程待办任务交接
CREATE TABLE jpaas_bpm.bpm_deliver
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    DELIVER_USER_ID_ varchar(64) DEFAULT NULL COMMENT '移交人ID',
    DELIVER_USER_NO_ varchar(64) DEFAULT NULL COMMENT '移交人工号',
    DELIVER_USER_NAME_ varchar(200) DEFAULT NULL COMMENT '移交人',
	RECEIPT_USER_ID_ varchar(64) DEFAULT NULL COMMENT '接管人ID',
	RECEIPT_USER_NO_ varchar(64) DEFAULT NULL COMMENT '接管人工号',
    RECEIPT_USER_NAME_ varchar(200) DEFAULT NULL COMMENT '接管人',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_bpm.bpm_deliver COMMENT '流程待办任务交接';

CREATE TABLE jpaas_bpm.bpm_deliver_log
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    DELIVER_USER_ID_ varchar(64) DEFAULT NULL COMMENT '移交人ID',
    DELIVER_USER_NO_ varchar(64) DEFAULT NULL COMMENT '移交人工号',
    DELIVER_USER_NAME_ varchar(200) DEFAULT NULL COMMENT '移交人',
	RECEIPT_USER_ID_ varchar(64) DEFAULT NULL COMMENT '接管人ID',
	RECEIPT_USER_NO_ varchar(64) DEFAULT NULL COMMENT '接管人工号',
    RECEIPT_USER_NAME_ varchar(200) DEFAULT NULL COMMENT '接管人',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_BY_NAME_ varchar(64)  DEFAULT NULL COMMENT '创建人',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_bpm.bpm_deliver_log COMMENT '流程待办任务交接日志';

CREATE TABLE jpaas_bpm.bpm_quit_user_task
(
    ID_ varchar(64)  NOT NULL COMMENT '主键',
    QUIT_USER_ID_ varchar(64) DEFAULT NULL COMMENT '离职人员ID',
    QUIT_USER_NO_ varchar(64) DEFAULT NULL COMMENT '离职人员工号',
    QUIT_USER_NAME_ varchar(200) DEFAULT NULL COMMENT '离职人员',
	DEF_ID_ varchar(64) NOT NULL COMMENT '流程定义ID',
    DEF_NAME_ varchar(255) NOT NULL COMMENT '流程定义标题',
	NODE_ID_ varchar(64) DEFAULT NULL COMMENT '流程节点ID',
	NODE_NAME_ varchar(100) DEFAULT NULL COMMENT '流程节点名称',
    TENANT_ID_ varchar(64)  DEFAULT NULL COMMENT '租用用户Id',
    CREATE_DEP_ID_ varchar(64)  DEFAULT NULL COMMENT '创建部门ID',
    CREATE_BY_ varchar(64)  DEFAULT NULL COMMENT '创建人ID',
    CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
    UPDATE_BY_ varchar(64)  DEFAULT NULL COMMENT '更新人ID',
    UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_bpm.bpm_quit_user_task COMMENT '离职人员流程任务表';

INSERT INTO `sys_menu` VALUES ('1524278912559210498', '1208980476072275970', '流程待办任务交接', '{\"type\":\"customIcon\",\"icon\":\"icontransfer1\"}', 'icontransfer1', null, '0', '0.1524278912559210498.', '8', 'URL', 'deliverTask', 'C', null, 'custom', null, null, null, null, '1', '1502226069801971714', '1', '2022-05-11 14:43:07', null, '2022-05-11 14:43:07', null, 'N', null);
INSERT INTO `sys_menu` VALUES ('1524279346703228929', '1208980476072275970', '交接列表', '{\"type\":\"customIcon\",\"icon\":\"iconyonghuhaoyou\"}', 'iconyonghuhaoyou', null, '1524278912559210498', '0.1524278912559210498.1524279346703228929.', '1', 'URL', 'BpmDeliverList', 'C', 'modules/bpm/core/BpmDeliverList', 'custom', null, null, null, null, '1', '1502226069801971714', '1', '2022-05-11 14:44:51', null, '2022-05-11 14:44:51', null, 'N', null);
INSERT INTO `sys_menu` VALUES ('1524279691814756353', '1208980476072275970', '交接日志', '{\"type\":\"customIcon\",\"icon\":\"iconliebiao\"}', 'iconliebiao', null, '1524278912559210498', '0.1524278912559210498.1524279691814756353.', '2', 'URL', 'BpmDeliverLogList', 'C', 'modules/bpm/core/BpmDeliverLogList', 'custom', null, null, null, null, '1', '1502226069801971714', '1', '2022-05-11 14:46:13', null, '2022-05-11 14:46:13', null, 'N', null);
INSERT INTO `sys_menu` VALUES ('1524280956502269954', '1208980476072275970', '离职人员任务列表', '{\"type\":\"customIcon\",\"icon\":\"iconshujufenpei\"}', 'iconshujufenpei', null, '1524278912559210498', '0.1524278912559210498.1524280956502269954.', '3', 'URL', 'BpmQuitUserTaskList', 'C', 'modules/bpm/core/BpmQuitUserTaskList', 'custom', null, null, null, null, '1', '1502226069801971714', '1', '2022-05-11 14:51:14', null, '2022-05-11 14:51:14', null, 'N', null);

-- 2022-05-17 jpaas-system gjh  新增API接口名称与所属服务字段
ALTER TABLE JPAAS_SYSTEM.SYS_APP_AUTH    ADD COLUMN API_NAME_ VARCHAR(20)  COMMENT 'API接口名称';
ALTER TABLE JPAAS_SYSTEM.SYS_APP_AUTH    ADD COLUMN SERVICE_ VARCHAR(20)  COMMENT '所属服务';


-- 2022-05-18 jpaas-bpm zyg  流程默认消息模板
CREATE TABLE jpaas_bpm.bpm_default_template (
      ID_ varchar(64)   NOT NULL COMMENT '主键',
      TEMPLATE_TYPE_ varchar(20)   DEFAULT NULL COMMENT '模板类型',
      MESSAGE_TYPE_ varchar(20)   DEFAULT NULL COMMENT '消息类型',
      TEMPLATE_ text   COMMENT '模板',
      TENANT_ID_ varchar(64)   DEFAULT NULL COMMENT '租用用户Id',
      CREATE_DEP_ID_ varchar(64)   DEFAULT NULL COMMENT '创建部门ID',
      CREATE_BY_ varchar(64)   DEFAULT NULL COMMENT '创建人ID',
      CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
      UPDATE_BY_ varchar(64)   DEFAULT NULL COMMENT '更新人ID',
      UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
      PRIMARY KEY (ID_)
) ;

-- 2022-05-18 jpaas-bpm zyg  流程消息模板
CREATE TABLE jpaas_bpm.bpm_message_template (
      ID_ varchar(64)  NOT NULL,
      BPM_DEF_ID_ varchar(64)  DEFAULT NULL,
      NODE_ID_ varchar(64)  DEFAULT NULL,
      BO_ALIAS_ varchar(64)  DEFAULT NULL,
      MSG_TYPE_ varchar(64)  DEFAULT NULL,
      TEMPLATE_TYPE_ varchar(64)  DEFAULT NULL,
      TEMPLATE_ text ,
      TENANT_ID_ varchar(64)   DEFAULT NULL COMMENT '租用用户Id',
      CREATE_DEP_ID_ varchar(64)   DEFAULT NULL COMMENT '创建部门ID',
      CREATE_BY_ varchar(64)   DEFAULT NULL COMMENT '创建人ID',
      CREATE_TIME_ datetime DEFAULT NULL COMMENT '创建时间',
      UPDATE_BY_ varchar(64)   DEFAULT NULL COMMENT '更新人ID',
      UPDATE_TIME_ datetime DEFAULT NULL COMMENT '更新时间',
      PRIMARY KEY (ID_)
) ;

-- 2022-05-23 jpaas-form ycs  更新pdf打印模板
UPDATE `jpaas_form`.`form_template` SET  `TEMPLATE_` = '<#function getPre pre>\r\n 	<#assign rtn><#if pre==\"\">data.<#elseif pre=\"item_\">item.<#else>data.SUB_${pre}.</#if></#assign>\r\n	<#return rtn>\r\n</#function>\r\n<#macro getField attr pre>\r\n	<#switch attr.control>\r\n		<#default>\r\n		<#noparse>${util.render(</#noparse>${getPre(pre)}${attr.name}<#noparse>,\'</#noparse>${attr.control}<#noparse>\')}</#noparse>\r\n	</#switch>\r\n</#macro>' WHERE `ID_` = '1278256114231779329';
-- 2022-05-30 jpaas-form zhl 瑞浪报表迁移 注:由于 form_table_create脚本已有 grid_report_design 表创建语句 这里会先删除原本表
-- ---------------------
-- Table structure for grid_report_design
-- ----------------------------
DROP TABLE IF EXISTS `jpaas_form`.`grid_report_design`;
CREATE TABLE `jpaas_form`.`grid_report_design`  (
                                       `ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT '主键ID',
                                       `NAME_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '名称',
                                       `KEY_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '标识',
                                       `GRF_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '报表模板文件',
                                       `QUERY_CONFIG_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL COMMENT '查询条件配置',
                                       `CREATE_DEP_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '机构ID',
                                       `CREATE_BY_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '创建人',
                                       `CREATE_TIME_` datetime(0) NULL DEFAULT NULL COMMENT '创建时间',
                                       `UPDATE_BY_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '更新人',
                                       `UPDATE_TIME_` datetime(0) NULL DEFAULT NULL COMMENT '更新时间',
                                       `TENANT_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT '租用用户ID',
                                       `REF_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `PARENT_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `TREE_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `DB_AS_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `DOC_ID_` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `SQL_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `USE_COND_SQL_TYPE_` varchar(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `USE_COND_SQL_` varchar(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `COND_SQLS_` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
                                       `WEB_REQ_SCRIPT_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `WEB_REQ_MAPPING_JSON_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `WEB_REQ_KEY_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `INTERFACE_KEY_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `INTERFACE_MAPPING_JSON_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `COLS_JSON_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       `FIELDS_JSON_` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,
                                       PRIMARY KEY (`ID_`) USING BTREE,
                                       INDEX `idx_grid_report_key`(`KEY_`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = 'GridReport报表管理' ROW_FORMAT = Dynamic;


-- 2022-05-31 jpaas_system gjh 新增菜单 关联删除约束管理、对外API接口管理、日历视图
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1516699277103804417', '1216010678984933378', '关联删除约束管理', '{\"type\":\"customIcon\",\"icon\":\"icondelete\"}', 'icondelete', NULL, '0', '0.1516699277103804417.', 12, 'URL', 'FormEntRelation', 'C', 'modules/form/core/FormEntRelationList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-04-20 16:44:21', '1', '2022-04-20 16:46:18', NULL, 'N', NULL);
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1524282320316354562', '1208980374695948289', '对外API接口管理', '{\"type\":\"customIcon\",\"icon\":\"iconchuanyue\"}', 'iconchuanyue', NULL, '1262953796867796993', '0.1262953796867796993.1524282320316354562.', 7, 'URL', 'SysExternalApiList', 'C', 'modules/system/core/SysExternalApiList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-05-11 14:56:40', '1', '2022-05-11 15:01:58', NULL, 'N', NULL);
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1528632140892028929', '1216010678984933378', '日历视图', '{\"type\":\"customIcon\",\"icon\":\"iconcalendar\"}', 'iconcalendar', NULL, '0', '0.1528632140892028929.', 6, 'URL', 'FormCalendarViewList', 'C', 'modules/form/core/FormCalendarViewList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-05-23 15:01:18', '1', '2022-05-23 17:09:55', NULL, 'N', NULL);

-- 2022-05-31 jpaas_form gjh 日历视图
CREATE TABLE jpaas_form.FORM_CALENDAR_VIEW
(
    ID_                  VARCHAR(64) NOT NULL COMMENT '主键',
    NAME_                VARCHAR(64) COMMENT '视图名称',
    KEY_                 VARCHAR(64) COMMENT '别名',
    CATEGORY_            VARCHAR(64) COMMENT '分类',
    DB_ALIAS_            VARCHAR(64) COMMENT '数据源别名',
    DB_NAME_             VARCHAR(64) COMMENT '数据源名称',
    USE_COND_SQL         VARCHAR(64) COMMENT 'SQL构建方式',
    SQL_                 VARCHAR(2000) COMMENT 'SQL语句',
    EXT_JSON_            LONGTEXT COMMENT '扩展属性',
    TENANT_ID_           VARCHAR(64) COMMENT '租户ID',
    CREATE_DEP_ID_       VARCHAR(64) COMMENT '创建部门ID',
    CREATE_BY_           VARCHAR(64) COMMENT '创建人ID',
    CREATE_TIME_         DATETIME COMMENT '创建时间',
    UPDATE_BY_           VARCHAR(64) COMMENT '更新人ID',
    UPDATE_TIME_         DATETIME COMMENT '更新时间',
    APP_ID_              VARCHAR(64) COMMENT '应用ID',
    PRIMARY KEY (ID_)
);

ALTER TABLE FORM_CALENDAR_VIEW COMMENT '表单日历视图';


-- 2022-06-06--jpaas_form szw --模板表新增字段
ALTER TABLE jpaas_form.form_template    ADD COLUMN FILE_NAME_  varchar(128) NULL COMMENT '文件名称';
ALTER TABLE jpaas_form.form_template    ADD COLUMN PATH_  varchar(128) NULL COMMENT '文件路径';
ALTER TABLE jpaas_form.form_template    ADD COLUMN SINGLE_  varchar(40) NULL COMMENT '生成单个文件';
ALTER TABLE jpaas_form.form_template    ADD COLUMN MAIN_SUB_TYPE_  varchar(64) NULL COMMENT '模式';
ALTER TABLE jpaas_form.form_template    ADD COLUMN GEN_MODE_  varchar(40) NULL COMMENT '实体生成类型';

-- 2022-06-07--jpaas_form szw --模板表新记录
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698962918469634', '代码生成_实体编辑页面', 'bodefEntityVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainClassId=vars.mainClassId>\n<#assign templateType=vars.templateType>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign subComList=model.boEntityList>\n<template>\n    <rx-dialog @handOk=\"handleSubmit\" @cancel=\"cancel\" order=\"top\" btnalign=\"right\" :showok=\"!readonly\">\n        <rx-layout>\n            <div slot=\"center\">\n                <table class=\"table-form four-column\" style=\"width:100%;\" ctltype=\"rx-four-table\" id=\"${mainClassId}\"\n                       borders=\"noborder\" data-sort=\"sortDisabled\">\n                    <colgroup>\n                        <col width=\"15%\">\n                        <col width=\"35%\">\n                        <col width=\"15%\">\n                        <col width=\"35%\">\n                    </colgroup>\n                    <caption>\n                        标题\n                    </caption>\n                    <tbody>\n                        ${firstRowFun(commonList templateType)}\n                        ${otherRowFun(commonList templateType)}\n                        <#if (vars.mainSubType ==\'mainSub\' &&subComList?? && subComList?size>0)>\n                        ${subRowFun(subComList)}\n                        </#if>\n                    </tbody>\n                </table>\n            </div>\n        </rx-layout>\n    </rx-dialog>\n</template>\n\n<script>\n    import ${class}Api from \"@/api/${system}/${package}/${classVar}.js\";\n    import ${class}Data from \"@/views/modules/${system}/${package}/${class}Data.js\";\n    import formJs from \"@/views/modules/form/core/js-comps/form.js\";\n\n    export default{\n        mixins: [formJs,${class}Data],\n        props:[\"pkId\",\"layerid\",\"destroy\",\"readonly\"],\n        data(){\n            return {}\n        },\n        created() {\n            //加载表单数据\n            this.loadData(${class}Api);\n        },\n        mounted(){\n            this.onload();\n        },\n        methods:{\n            onload(){\n\n            },\n            async _beforeSubmit(){\n\n            },\n            _afterSubmit(result,formJson){\n\n            },\n            enter(entName, field){\n\n            },\n            handleSubmit(vm){\n                this.handSubmit(${class}Api,vm);\n            }\n        },\n        watch:{\n        }\n    }\n</script>\n\n<#function subRowFun subComList>\n    <#assign rtn>\n        <#list subComList as sub>\n            <#assign subColList=sub.boAttrList>\n            <#assign subVars=sub.vars>\n            <#assign colIndex=sub?index>\n                <tr class=\"active2\">\n                    <td colspan=\"4\" rowspan=\"1\">\n                        <div class=\"rx-table-body  \" ctltype=\"rx-table\" type=\"onetomany\" id=\"${sub.id}\"\n                             tablename=\"${subVars.classVar}\" style=\"width:100%\" tabname=\"${subVars.classVar}\"\n                             tabletype=\"default\" req=\"no\">\n                            <div class=\"table-header-tool\">\n                                <div class=\"title\">\n                                    <div>\n                                        ${subVars.classVar}\n                                    </div>\n                                </div>\n                                <a-button-group v-if=\"!getReadonly()\">\n                                    <a-button\n                                            v-on:click=\"add(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n                            </div>\n                            <div class=\"rx-table-box\">\n                                <table class=\"rx-table\">\n                                    <colgroup>\n                                        <col style=\"width: 60px;\">\n                                        <col style=\"width: 60px;\">\n                                        <#list subColList as col>\n                                        <col style=\"width: 100px;\">\n                                        </#list>\n                                    </colgroup>\n                                    <thead>\n                                        <tr class=\"firstRow\">\n                                            <th>#</th>\n                                            <th>序号</th>\n                                            <#list subColList as col>\n                                            <th v-bind:class=\"{required:required.${subVars.classVar}[\'fields\'].${col.name}}\">${col.comment}</th>\n                                            </#list>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr v-if=\"\'item\'\" v-for=\"(item,index) in data.sub__${subVars.classVar}\"\n                                            v-tableselect=\"{item:item,selmode:\'multi\',data:data.sub__${subVars.classVar}}\"\n                                            :key=\"item.index_\" :class=\"{active:item.selected}\">\n                                            <td><a-checkbox :checked=\"item.selected\"></a-checkbox></td>\n                                            <td><rx-serial :serial=\"index+1\"></rx-serial></td>\n                                            <#list subColList as col>\n                                            <td>\n                                                <${col.control} \n													type=\"onetomany\"\n													id=\"${col.id}\" \n													:readonly=\"readonly\"\n													v-model=\"item.${col.name}\" \n													:data=\"data\" \n													:row=\"item\"\n													:valid=\"validFunc(\'${subVars.classVar}\',\'${col.name}\',item)\"\n													name=\"${col.name}\"\n													permission=\"w\" \n													${subColOtherFun(col)} ></${col.control}>\n                                            </td>\n                                            </#list>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                                <div class=\"tableEmpty\"\n                                     v-if=\"data.sub__${subVars.classVar}&amp;&amp;data.sub__${subVars.classVar}.length <= 0\">\n                                    <a-empty></a-empty>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function subColOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-number\'>\n            :max=\"100000000\" \n			:min=\"0\" \n			:step=\"1\" \n			valmode=\"single\"\n        <#elseif ctlType==\'rx-textbox\'>\n            :ispassword=\"false\"\n        <#elseif ctlType==\'rx-form-select\'>\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-user\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#else >\n            valmode=\"single\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function otherRowFun commonList templateType>\n    <#assign templateNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex &gt;= templateNum>\n                <#if (colIndex % templateNum==0)>\n                    <tr>\n                </#if>\n                <#if (col.control==\'rx-tree-select\' || col.control==\'rx-form-select\')>\n                    <td style=\"word-break: break-all;\" :class=\"{required:required.main.khly}\">${col.comment}</td>\n                <#else >\n                    <td style=\"word-break: break-all;\">${col.comment}</td>\n                </#if>\n                    <td style=\"word-break: break-all;\">\n                        <${col.control} \n							type=\"main\"\n							id=\"${col.id}\"\n							:readonly=\"readonly\"\n							v-model=\"data.${col.name}\"\n							:valid=\"validFunc(\'main\',\'${col.name}\')\"\n							permission=\"w\"\n							${colOtherFun(col)}></${col.control}>\n                    </td>\n                <#if colIndex % templateNum == 1 || !col_has_next>\n                </tr>\n                </#if>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function firstRowFun commonList templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex==0>\n                <tr class=\"firstRow\">\n            </#if>\n            <#if colIndex<colindexNum>\n                <td style=\"word-break: break-all;\">${col.comment}</td>\n                <td style=\"word-break: break-all;\">\n                <${col.control} \n					type=\"main\"\n					id=\"${col.id}\"\n					:readonly=\"readonly\"\n					v-model=\"data.${col.name}\"\n					:valid=\"validFunc(\'main\',\'${col.name}\')\"\n					permission=\"w\"\n					${colOtherFun(col)}></${col.control}>\n                </td>\n            </#if>\n            <#if (colindexNum-colIndex)==1>\n                </tr>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function colOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-address\'>\n		<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n           :setting=\"{isCity:${extJson.isCity},isCounty:${extJson.isCounty},isAddress:${extJson.isAddress}}\"\n        <#elseif ctlType==\'rx-radio\'>\n			mode=\"default\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			:onlyvalue=\"false\"\n        <#elseif ctlType==\'rx-number\'>\n			:max=\"1000000\"\n			:min=\"0\"\n			:step=\"1\"\n			length=\"${col.length},${col.decimalLength}\"\n        <#elseif ctlType==\'rx-switch\'>\n			mode=\"custom\"\n			verifyhide=\"${col.name}\"\n			check=\"Y\"\n			uncheck=\"N\"\n        <#elseif ctlType==\'rx-tree-select\'>\n			mode=\"multiple\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:selectable=\"false\"\n			:data=\"data\"\n        <#elseif ctlType==\'rx-form-select\'>\n			:data=\"data\"\n			mode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			valmode=\"single\"\n			:hideselect=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-date\'>\n            format=\"YYYY-MM-DD HH:mm:ss\"\n        <#elseif ctlType==\'rx-user\'>\n			:data=\"data\"\n			gridname=\"main\"\n			:single=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			gridname=\"main\"\n			:single=\"false\"\n			:showdeptpath=\"false\"\n			:deptpathlevel=\"0\"\n			:showdimid=\"true\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:35:02', NULL, '2022-06-06 14:35:02', NULL, NULL, NULL, '{class}Edit.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698815715176450', '代码生成_正向列表页面', 'codeGenListVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign pk=model.idField>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign searchFields=settingJson.mainEntity.searchFields>\n\n<template>\n  <rx-layout>\n	${leftSearchTreeFun()}\n    <div slot=\"center\" style>\n      <rx-fit>\n        <div slot=\"toolheader\" foldheader=\"true\" foldbtn=\"false\" border=\"false\">\n          <div class=\"table-operator\">\n            <rx-button alias=\"${classVar}Add\" :butn-icon=\"\'plus\'\" :butn-type=\"\'primary\'\" :show-no-right=\"true\" @click=\"add\">新建</rx-button>\n            <a-dropdown v-if=\"editEnable && selectedRowKeys.length > 0 || removeEnable && selectedRowKeys.length > 0\">\n              <a-button style=\"margin-left: 8px\"> 更多 <a-icon type=\"down\" /> </a-button>\n              <a-menu slot=\"overlay\">\n                <a-menu-item key=\"1\" v-if=\"editEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Edit\" :butn-icon=\"\'edit\'\"\n                             :butn-type=\"\'primary\'\" :show-no-right=\"false\" @click=\"editOne\"><a-icon type=\"edit\"  />编辑</a-menu-item>\n                <a-menu-item key=\"2\" v-if=\"removeEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Delete\" :butn-icon=\"\'delete\'\" :butn-type=\"\'danger\'\"\n                             :show-no-right=\"false\" @click=\"delByIds(selectedRowKeys)\"><a-icon type=\"delete\" />删除</a-menu-item>\n              </a-menu>\n            </a-dropdown>\n          </div>\n          <span class=\"search-btn-box\">\n                <span class=\"search-btn\" @click=\"searchshow\"><i class=\"iconfont iconguolv\"></i>过滤</span>\n           </span>\n        </div>\n        <div slot=\"searchbar\" btnalign=\"right\"  v-if=\"fitSearch\" @search=\"search\" @cancel=\"cancel\" @close=\"close\">\n          <a-form layout=\"vertical\">\n            <#list searchFields as search>\n            <a-form-item label=\"${search.fieldLabel}\">\n				<#if (!search.fc?? || search.fc==\'textbox\')>\n					<a-input <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n							 v-model.trim=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"/>\n				<#elseif (search.fc==\'datepicker\')>\n					<#if search.format??>\n						<#assign searchDateFormat=search.format>\n					<#else>\n						<#assign searchDateFormat=\'YYYY-MM-DD\'>\n					</#if>\n					<a-date-picker <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n								   v-model=\"queryParam[\'queryField_${search.fieldName}\']\"\n								   format=\"${searchDateFormat}\"\n							<#if searchDateFormat==\'YYYY-MM-DD HH:mm:ss\'>\n								show-time\n							</#if>\n								   @change=\"searchDateChange($event,$event,{queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_D_${search.fieldOp}<#else>${search.fieldName}</#if>\',format:\'${searchDateFormat}\'})\"/>\n				<#elseif (search.fc==\'month\')>\n					<a-month-picker  v-model=\"queryParam[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>  @change=\"searchMonthChange($event,$event,{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\'<#if search.format??>,format:\'${search.format}\'</#if>,autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'rangepicker\')>\n					<#if search.format??>\n						<#assign searchRangeFormat=search.format>\n					<#else>\n						<#assign searchRangeFormat=\'YYYY-MM-DD HH:mm:ss\'>\n					</#if>\n					<a-range-picker  ref=\"queryField_${search.fieldName}\"  v-model=\"params[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if> show-time format=\"${searchRangeFormat}\"  @change=\"searchRangeDateChange($event,\'${searchRangeFormat}\',{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\',autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'select\')>\n					<rx-select ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'treeselect\')>\n					<rx-tree-select-ctl ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\" :showSearch=\"<#if search.showSearch??>${search.showSearch?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\" parent-field=\"${search.url_parentfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\" :toTree=\"false\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\" parent-field=\"${search.sql_parentfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'dialog\')>\n					<rx-input-button v-model=\"params[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\" :multiValue=\"true\"\n									 :single=\"false\" :config=\"{fieldName:\'${search.fieldName}\',queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\',dialog:\'<#if search.dialog??>${search.dialog}</#if>\',dialog_name:\'<#if search.dialog_name??>${search.dialog_name}</#if>\',valueField:\'<#if search.valueField??>${search.valueField}</#if>\',textField:\'<#if search.textField??>${search.textField}</#if>\',single:!<#if search.multiSelect??>${search.multiSelect?c}<#else>true</#if>}\"\n									 @click=\"_OnDialogShow\"/>\n				</#if>\n			 </a-form-item>\n            </#list>\n          </a-form>\n        </div>\n        <#assign idField=convertUnderLine(pk)>\n        <rx-grid\n                ref=\"table\"\n			<#if settingJson.multiSelect==\'notSelect\'>\n                :allowRowSelect=\"false\"\n			<#else>\n				:allowRowSelect=\"true\"\n			</#if>\n			<#if settingJson.multiSelect==\'move\'>\n				:multiSelect=\"true\"\n			<#else>\n				:multiSelect=\"false\"\n			</#if>\n                :columns=\"columns\"\n			<#if settingJson.isPage==\'YES\'>\n				:showPage=\"true\"\n				:defaultPageSize=\"${settingJson.pageSize}\"\n				:pageSizeOptions=\"[\'10\',\'20\',\'30\',\'40\',\'50\']\"\n			<#else>\n				:showPage=\"false\"\n			</#if>\n                url=\"/api-${system}/${system}/${package}/${classVar}/query\"\n                :queryParam=\"queryParam\"\n                data-field=\"result.data\"\n                id-field=\"${idField}\"\n                @selectChange=\"onSelectChange\"\n        >\n		  <#list commonList as col>\n		  ${slotScopeColFun(col)}\n          </#list>\n            <span slot=\"action\" slot-scope=\"{ text, record }\" class=\"actionIcons\">\n                <span  @click.stop=\"edit(record)\">编辑</span>\n				<span  @click.stop=\"detail(record)\">明细</span>\n                <span  @click.stop=\"delByIds([record.${idField}])\">删除</span>\n            </span>\n        </rx-grid>\n      </rx-fit>\n    </div>\n  </rx-layout>\n</template>\n\n<script>\n  import ${class}Api from \'@/api/${system}/${package}/${classVar}\'\n  import ${class}Edit from \'./${class}Edit\'\n  import {BaseList,RxFit,RxGrid,RxButton,RxSpan } from \'jpaas-common-lib\';\n  import CodeGenlistJs from \"@/views/modules/form/core/js-comps/CodeGenlist.js\";\n  import ListRender from \'@/views/modules/form/core/js-comps/ListRender.js\';\n  import RxCategoryTreeeditor from \'@/components/redxun/rx-category-treeeditor\'\n  import RxParamsTreeeditor from \'@/components/redxun/rx-params-treeeditor\'\n  //import  from \"@/views/modules/share/rx-button\";\n  //import  from \"@/views/modules/share/rx-span\";\n  export default {\n    name: \'${class}List\',\n    mixins: [BaseList,CodeGenlistJs,ListRender],\n    components: {\n      RxButton,\n      RxSpan,\n      RxFit,\n	  RxCategoryTreeeditor,\n	  RxParamsTreeeditor\n    },\n    data() {\n      return {\n        columns: [\n          {\n            title: \'序号\',\n            type: \'indexColumn\',\n            width: 100,\n            dataIndex: \'serial\',\n            scopedSlots: {customRender: \'serial\'}\n          },\n          <#list commonList as col>\n		  <#if col.headShow==\'YES\'>\n		  {title: \'${col.comment}\', dataIndex: \'${col.name}\', width: ${col.fieldLength}, scopedSlots: {customRender: \'${col.name}\'}},\n		  </#if>\n          </#list>\n          {title: \'操作\', width: 100, dataIndex: \'action\', scopedSlots: {customRender: \'action\'}}\n        ],\n        component:${class}Edit,\n        comment:\"${comment}\",\n        fitSearch:false,\n		curTree:{},\n		${searchTreeScriptFun()}\n      }\n    },\n    methods:{\n	  ${leftQeuryParamFun()}\n      delById(ids){\n        return ${class}Api.del({ ids: ids.join(\',\') });\n      },\n      getListByParams(parameter){\n        return ${class}Api.query(parameter)\n      }\n\n    }\n  }\n</script>\n<style scoped>\n  .table-operator {\n    padding:4px;\n  }\n  .table-operator button {\n    margin:2px;\n  }\n</style>\n\n\n<#function searchTreeScriptFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n	<#assign treeKeyJson=treeJson.treeKeyJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			treeJson:${vueJs.treeJson},\n		</#if>\n		<#if treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			treeCat:{\n						name:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.name}<#else>${treeJson.formSolution.name}</#if>\",\n						treeId:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.treeId}<#else>${treeJson.formSolution.alias}</#if>\"\n					},\n			searchTopNodesUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByTreeIdParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				treeId:\"<#if treeJson.treeKey??>${treeKeyJson.treeId}</#if>\",\n				parentId:\"0\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                pk: \"\"\n			</#if>\n			},\n			searchChildrenUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchChildrenParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				parentId: \"parentId\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                parentId: \"pk\"\n			</#if>\n			},\n			treeRelation:{\n				name:\"<#if treeJson.treeType==\'sysDic\'>name<#else>${treeJson.formSolution.searchLable}</#if>\",\n				treeId:\"<#if treeJson.treeType==\'sysDic\'>dicId<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				parentId:\"<#if treeJson.treeType==\'sysDic\'>parentId<#else>${treeJson.formSolution.searchParentId}</#if>\",\n				key:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				value:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\"\n			},\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function leftQeuryParamFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			getCurTree(){\n                return this.curTree;\n            },\n			handSelect(curRow) {\n                this.curTree=curRow;\n                var treeId = curRow.treeId;\n                if(treeId!=\"0\"){\n                    this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ=treeId;\n                }else {\n                    delete this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ;\n                }\n                this.loadData(this.queryParam);\n            },\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function searchTreeColFun treeJson>\n<#assign searchTreeCol=treeJson.searchTreeCol>\n    <#assign rtn>\n        <#if searchTreeCol.isSingle==0>\n			<#if treeJson.searchTreeColKey==\'name\'>\n			${searchTreeCol.fieldName}_NAME\n			<#else>\n			${searchTreeCol.fieldName}\n			</#if>\n		<#else>\n		${searchTreeCol.fieldName}\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function leftSearchTreeFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			<#if treeJson.treeType==\'treeId\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-category-treeeditor\n						cat-key=\"${treeJson.treeKey}\"\n						:edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n						@handSelect=\"handSelect\"\n						:async=\"true\"\n						:readTreeId=\"<#if treeJson.catSysTreeKey??>\'${treeJson.catSysTreeKey}\'<#else>\'\'</#if>\"\n					></rx-category-treeeditor>\n				</rx-fit>\n			</div>\n			<#elseif treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-params-treeeditor\n					ref=\"rxParamsTreeeditor\"\n                    :edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n                    @handSelect=\"handSelect\"\n                    @addNode=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @addSibling=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Sibling\"\n                    @editNode=\"edit<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @deleteNode=\"delete<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    :treeCat=\"treeCat\"\n                    :searchTopNodesUrl=\"searchTopNodesUrl\"\n                    :searchParams=\"searchParams\"\n                    :treeRelation=\"treeRelation\"\n                    :searchChildrenUrl=\"searchChildrenUrl\"\n					:searchChildrenParams=\"searchChildrenParams\"\n                ></rx-params-treeeditor>\n				</rx-fit>\n			</div>\n			</#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function slotScopeColFun col>\n	<#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-upload\'>\n			<span :title=\"text\" slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				<span class=\"upFiles\" v-html=\"onFileRender(text)\"></span>\n            </span>\n		<#else>\n			<#if ctlType==\'rx-address\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				{{onAddressRender(\'${model.genMode}\',record,\'${col.name}\',${fileUtil.countAddressFromExtJson(col.extJson)})}}\n			</span>\n			<#elseif col.isSingle==\'0\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{record.${col.name}Name}}</span>\n			<#else><span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{text}}</span></#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function convertUnderLine field>\n  <#if field?index_of(\"_\")==-1>\n    <#assign rtn>${field?lower_case?trim}</#assign>\n    <#return rtn>\n  </#if>\n\n  <#if field?index_of(\"F_\")==0>\n    <#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n    <#return rtn>\n  </#if>\n\n  <#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n  <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:34:27', NULL, '2022-06-06 14:34:27', NULL, NULL, NULL, '{class}List.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698647930433538', '代码生成_正向Mapping文件', 'codeGenMappingW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\n<mapper namespace=\"${domain}.${system}.${package}.mapper.${class}Mapper\">\n\n    <resultMap id=\"${class}\" type=\"${type}\">\n            <#assign idField=convertUnderLine(model.idField)>\n            <id property=\"${idField}\" column=\"${model.idField}\" jdbcType=\"VARCHAR\"/>\n		        <#list colList as col>\n				${columnFun(col model.genMode)}\n		        </#list>\n		      <#if model.genMode==\"form\" || model.genMode==\"create\" >\n			  <result property=\"refId\" column=\"REF_ID_\" jdbcType=\"VARCHAR\"/>\n			  <result property=\"parentId\" column=\"PARENT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"tenantId\" column=\"TENANT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createBy\" column=\"CREATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createTime\" column=\"CREATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"updateBy\" column=\"UPDATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"updateTime\" column=\"UPDATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"createDepId\" column=\"CREATE_DEP_ID_\" jdbcType=\"VARCHAR\"/>\n		      </#if>\n    </resultMap>\n\n\n    <select id=\"query\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n        select ${model.idField},<#list colList as col>${selectColumnFun(col model.genMode)}<#if col_has_next>,</#if></#list><#if model.genMode==\"form\" || model.genMode==\"create\" >,REF_ID_,PARENT_ID_,TENANT_ID_,CREATE_BY_,CREATE_TIME_,UPDATE_BY_,UPDATE_TIME_,CREATE_DEP_ID_</#if> from ${tableName}\n        <#noparse>\n        <where>\n            <if test=\"@rx.Ognl@isNotEmpty(w.whereSql)\">\n                ${w.whereSql}\n            </if>\n        </where>\n        <if test=\"@rx.Ognl@isNotEmpty(w.orderBySql)\">\n            ORDER BY ${w.orderBySql}\n        </if>\n        <if test=\"@rx.Ognl@isEmpty(w.orderBySql)\"></#noparse>\n            ORDER BY  ${model.idField} DESC\n        </if>\n    </select>\n	\n	<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where REF_ID_=${r\"#\"}{refId}\n		ORDER BY  ID_ DESC\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM W_subTest0510001 WHERE REF_ID_=${r\"#\"}{refId}\n	</delete>\n	</#if>\n\n</mapper>\n\n\n<#function selectColumnFun col genMode>\n<#assign name=col.fieldName>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n			${name}_PROVINCE,${name}_P_CODE\n			<#if extJson.isCity==\"true\">\n			,${name}_CITY,${name}_CITY_CODE\n			</#if>\n			<#if extJson.isCounty==\"true\">\n			,${name}_COUNTY,${name}_COUNTY_CODE\n			</#if>\n			<#if extJson.isAddress==\"true\">\n			,${name}_ADDRESS\n			</#if>\n		<#elseif col.isSingle==0>\n			${name}_NAME,${name}\n		<#else>\n			${name}\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n			\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			${provinceJson.fieldName},${name}\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				,${cityJson.fieldName}\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				,${cityCodeJson.fieldName}\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				,${countyJson.fieldName}\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				,${countyCodeJson.fieldName}\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				,${addressJson.fieldName}\n			</#if>\n		<#elseif col.isSingle==0>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			${name},${colJson.fieldName}\n		<#else>\n			${name}\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function columnFun col genMode>\n<#assign colName=convertUnderLine(col.fieldName)>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n			<#assign setting=extJson.setting>\n			<result property=\"${colName}Province\" column=\"${col.fieldName}_PROVINCE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Pcode\" column=\"${col.fieldName}_P_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<result property=\"${colName}City\" column=\"${col.fieldName}_CITY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CityCode\" column=\"${col.fieldName}_CITY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<result property=\"${colName}County\" column=\"${col.fieldName}_COUNTY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CountyCode\" column=\"${col.fieldName}_COUNTY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<result property=\"${colName}Address\" column=\"${col.fieldName}_ADDRESS\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Name\" column=\"${col.fieldName}_NAME\" jdbcType=\"${getJdbcType(col)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			<result property=\"${convertUnderLine(provinceJson.fieldName)}\" column=\"${provinceJson.fieldName}\" jdbcType=\"${getJdbcType(provinceJson)}\"/>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				<result property=\"${convertUnderLine(cityJson.fieldName)}\" column=\"${cityJson.fieldName}\" jdbcType=\"${getJdbcType(cityJson)}\"/>\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				<result property=\"${convertUnderLine(cityCodeJson.fieldName)}\" column=\"${cityCodeJson.fieldName}\" jdbcType=\"${getJdbcType(cityCodeJson)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				<result property=\"${convertUnderLine(countyJson.fieldName)}\" column=\"${countyJson.fieldName}\" jdbcType=\"${getJdbcType(countyJson)}\"/>\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				<result property=\"${convertUnderLine(countyCodeJson.fieldName)}\" column=\"${countyCodeJson.fieldName}\" jdbcType=\"${getJdbcType(countyCodeJson)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				<result property=\"${convertUnderLine(addressJson.fieldName)}\" column=\"${addressJson.fieldName}\" jdbcType=\"${getJdbcType(addressJson)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			<result property=\"${convertUnderLine(colJson.fieldName)}\" column=\"${colJson.fieldName}\" jdbcType=\"${getJdbcType(colJson)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:47', '1', '2022-06-07 10:07:48', NULL, NULL, NULL, '{class}Mapper.xml', 'src/main/resources/mapper/{system}/{package}', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698526207537154', '代码生成_正向Controller控制层', 'codeGenControllerW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign entAlias=model.vars.entAlias>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n\npackage ${domain}.${system}.${package}.controller;\n\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.gencode.controller.CodeGenBaseController;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\nimport io.swagger.annotations.Api;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.*;\nimport com.redxun.common.annotation.ClassDefine;\n\n\n/**\n* [${model.name}] 控制器代码\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@RestController\n@RequestMapping(\"/${system}/${package}/${classVar}\")\n@Api(tags = \"${comment}\")\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\n\n	@Autowired\n	${class}ServiceImpl ${classVar}Service;\n\n\n\n	@Override\n	public BaseService getBaseService() {\n		return ${classVar}Service;\n	}\n\n	@Override\n	public String getComment() {\n		return \"${comment}\";\n	}\n\n	@Override\n	public String getFormAlias() {\n		return \"${entAlias}\";\n	}\n\n	@Override\n	public String getclassAlias() {\n		return \"${classVar}\";\n	}\n	\n	@Override\n	public String getPackage(){\n		return \"${package}\";\n	}\n\n	@Override\n	public String getCreateType() {\n		return \"${model.genMode}\";\n	}\n\n	@Override\n	public ${class} getBaseEntity(){\n		return new ${class}();\n	}\n\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:18', NULL, '2022-06-06 14:33:18', NULL, NULL, NULL, '{class}Controller.java', 'src/main/java/com/redxun/{system}/{package}/controller', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698365993512961', '代码生成_正向ServiceImpl服务层', 'codeGenServiceImpl', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n\npackage ${domain}.${system}.${package}.service;\n\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.redxun.common.base.db.BaseDao;\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.common.service.impl.SuperServiceImpl;\nimport com.redxun.common.tool.BeanUtil;\nimport com.redxun.common.tool.StringUtils;\nimport com.redxun.common.utils.ExceptionUtil;\nimport com.redxun.common.tool.IdGenerator;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.mapper.${class}Mapper;\n<#if model.boEntityList?size gt 0 >\n<#list model.boEntityList as subEnt>\nimport ${domain}.${system}.${package}.service.${subEnt.vars.class}ServiceImpl;\nimport ${domain}.${system}.${package}.mapper.${subEnt.vars.class}Mapper;\nimport ${domain}.${system}.${package}.entity.${subEnt.vars.class};\n</#list>\n</#if>\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.Resource;\nimport java.io.Serializable;\nimport java.util.Collection;\nimport java.util.List;\n\n/**\n* [${model.name}]业务服务类\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@Service\npublic class ${class}ServiceImpl extends SuperServiceImpl<${class}Mapper, ${class}> implements BaseService<${class}> {\n\n    @Resource\n    private ${class}Mapper ${classVar}Mapper;\n    \n    <#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @Resource\n    private ${subEnt.vars.class}ServiceImpl ${subEnt.vars.classVar}Service;\n	@Resource\n    private ${subEnt.vars.class}Mapper ${subEnt.vars.classVar}Mapper;\n    </#list>\n    </#if>\n   \n    @Override\n    public BaseDao<${class}> getRepository() {\n        return ${classVar}Mapper;\n    }\n	\n	<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\n	public void saveOrUpdateAll(List<${class}> subList, String pkId){\n		${classVar}Mapper.deleteByRefId(pkId);\n        if(BeanUtil.isEmpty(subList)){\n            return;\n        }\n        for (${class} sub:subList) {\n            sub.setRefId(pkId);\n			if(StringUtils.isEmpty(sub.getPkId())){\n                sub.setPkId(IdGenerator.getIdStr());\n            }\n        }\n        try {\n            this.saveOrUpdateBatch(subList);\n        }catch (Exception e){\n            log.error(\"saveOrUpdateAll is error: messgae={}\", ExceptionUtil.getExceptionMessage(e));\n        }\n    }\n	</#if>\n\n		\n	<#if model.boEntityList?size gt 0 >\n	@Override\n    public void delete(Collection<Serializable> entities) {\n\n        for(Serializable id:entities){\n            //根据ID删除${model.name}\n            ${classVar}Mapper.deleteById(id);\n            <#list model.boEntityList as subEnt>\n            //根据ID删除${subEnt.name}    \n    		QueryWrapper wrapper=new QueryWrapper();\n            wrapper.eq(\"${subEnt.boRelation.fkField}\",id);\n            ${subEnt.vars.classVar}Mapper.delete(wrapper);\n    		</#list>\n        }\n    }\n	\n	/**\n     * 根据主键获取表单数据\n     * @param pk\n     * @return\n     */\n    @Override\n    public ${class} get(Serializable pk){\n        ${class} ${classVar}=this.getById(pk);\n        if(BeanUtil.isEmpty(${classVar})){\n            return new ${class}();\n        }\n		<#list model.boEntityList as subEnt>\n		List<${subEnt.vars.class}> ${subEnt.vars.classVar}List =${subEnt.vars.classVar}Mapper.getByRefId((String)pk);\n        ${classVar}.set${subEnt.vars.class}List(${subEnt.vars.classVar}List);\n		</#list>\n        return ${classVar};\n    }\n\n    @Override\n    public int insert(${class} entity) {\n        String pkId = entity.getPkId();\n        if(BeanUtil.isEmpty(pkId)) {\n            pkId=IdGenerator.getIdStr();\n            entity.setPkId(pkId);\n        }\n        int insert = getRepository().insert(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),pkId);\n		</#list>\n        return insert;\n    }\n\n    @Override\n    public int update(${class} entity) {\n        int insert =  getRepository().updateById(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),entity.getPkId());\n		</#list>\n        return insert;\n    }\n    </#if>\n	\n	\n	\n\n\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:40', '1', '2022-06-06 14:32:47', NULL, NULL, NULL, '{class}ServiceImpl.java', 'src/main/java/com/redxun/{system}/{package}/service', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698265154056194', '代码生成_正向Mapper数据库访问类', 'codeGenMapperW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n    \npackage ${domain}.${system}.${package}.mapper;\n\nimport ${domain}.${system}.${package}.entity.${class};\nimport org.apache.ibatis.annotations.Mapper;\nimport com.redxun.common.base.db.BaseDao;\n<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\nimport org.apache.ibatis.annotations.Param;\nimport java.util.List;\n</#if>\n/**\n* [${model.name}]据库访问层\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Mapper\npublic interface ${class}Mapper extends BaseDao<${class}> {\n<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\n	List<${class}> getByRefId(@Param(\"refId\") String refId);\n	\n	void deleteByRefId(@Param(\"refId\") String refId);\n</#if>\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:16', NULL, '2022-06-06 14:32:16', NULL, NULL, NULL, '{class}Mapper.java', 'src/main/java/com/redxun/{system}/{package}/mapper', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698110191300609', '代码生成_正向Entity_实体层', 'codeGenEntityW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<#assign idField=convertUnderLine(model.idField)>\n\n\n/**\n* [${model.name}]实体类定义\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\npackage ${domain}.${system}.${package}.entity;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.baomidou.mybatisplus.annotation.TableName;\nimport com.fasterxml.jackson.annotation.JsonCreator;\nimport ${domain}.common.base.entity.BaseExtEntity;\nimport com.redxun.gencode.codegenhander.SubTableDef;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.experimental.Accessors;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.apache.ibatis.type.JdbcType;\nimport java.util.Date;\n\n\n@Setter\n@Getter\n@Accessors(chain = true)\n@TableName(value = \"${tableName}\")\npublic class ${class}  extends BaseExtEntity<java.lang.String> {\n\n    @JsonCreator\n    public ${class}() {\n    }\n	\n	//主键\n    @TableId(value = \"${model.idField}\",type = IdType.INPUT)\n	private String ${idField};\n\n	@Override\n    public String getPkId() {\n        return this.${idField};\n    }\n\n    @Override\n    public void setPkId(String pkId) {\n        this.${idField}=pkId;\n    }\n\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n	//外键\n    @TableField(value = \"REF_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String refId;\n\n    //父键\n    @TableField(value = \"PARENT_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String parentId;\n	</#if>\n    <#list colList as col>\n	<#if col.control==\"rx-address\">\n	${addressFun(col)}\n	<#else>\n	//${col.comment}\n    @TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n    private ${getJavaType(col)} ${col.name};\n	\n	<#if col.isSingle==0>\n	${colNameFun(col)}\n	</#if>\n	</#if>\n    </#list>\n\n	\n	<#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @TableField(exist=false)\n	@SubTableDef(tableName = \"${subEnt.vars.class}\",className = ${subEnt.vars.class}.class,type = \"onetomany\")\n	private List<${subEnt.vars.class}> ${subEnt.vars.classVar}List=new ArrayList<>();\n	</#list>	\n	</#if>\n \n}\n\n\n\n<#function colNameFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}名称\n		@TableField(value = \"${col.fieldName}_NAME\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Name;\n	<#else>\n		<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n		//${colJson.comment}名称\n		@TableField(value = \"${colJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(colJson)})\n		private ${getJavaType(colJson)} ${colJson.name};\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function addressFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign setting=extJson.setting>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}--省\n		@TableField(value = \"${col.fieldName}_PROVINCE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Province;\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}_P_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Pcode;\n		\n		<#if setting.isCity==\"true\">\n		//${col.comment}--市\n		@TableField(value = \"${col.fieldName}_CITY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}City;\n		\n		//${col.comment}--市Code\n		@TableField(value = \"${col.fieldName}_CITY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CityCode;\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n		//${col.comment}--县(区)\n		@TableField(value = \"${col.fieldName}_COUNTY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}County;\n		\n		//${col.comment}--县(区)Code\n		@TableField(value = \"${col.fieldName}_COUNTY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CountyCode;\n\n		</#if>\n		<#if setting.isAddress==\"true\">\n		\n		//${col.comment}--详细地址\n		@TableField(value = \"${col.fieldName}_ADDRESS\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Address;\n		</#if>\n	<#else>\n		<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n		//${provinceJson.comment}--省\n		@TableField(value = \"${provinceJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(provinceJson)})\n		private ${getJavaType(provinceJson)} ${provinceJson.name};\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name};\n		\n		<#if setting.isCity==\"true\">\n		\n			<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n			//${cityJson.comment}--市\n			@TableField(value = \"${cityJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityJson)})\n			private ${getJavaType(cityJson)} ${cityJson.name};\n			\n			<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n			//${cityCodeJson.comment}--市Code\n			@TableField(value = \"${cityCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityCodeJson)})\n			private ${getJavaType(cityCodeJson)} ${cityCodeJson.name};\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n			<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n			//${countyJson.comment}--县(区)\n			@TableField(value = \"${countyJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyJson)})\n			private ${getJavaType(countyJson)} ${countyJson.name};\n			\n			<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n			//${countyCodeJson.comment}--县(区)Code\n			@TableField(value = \"${countyCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyCodeJson)})\n			private ${getJavaType(countyCodeJson)} ${countyCodeJson.name};\n		</#if>\n		<#if setting.isAddress==\"true\">\n		<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n			//${addressJson.comment}--详细地址\n			@TableField(value = \"${addressJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(addressJson)})\n			private ${getJavaType(addressJson)} ${addressJson.name};\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJavaType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n<#if  dbtype==\"number\"  >\n    <#if col.decimalLength==0>\n         <#if col.length gt 10 >\n            long\n         <#else>\n            int\n         </#if>\n    <#else>\n         double\n    </#if>\n<#elseif (dbtype==\"date\")>\n	Date\n<#else>\n	String\n</#if>\n</#assign>\n <#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:39', '1', '2022-06-07 09:35:25', NULL, NULL, NULL, '{class}.java', 'src/main/java/com/redxun/{system}/{package}/entity', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697966238593025', '代码生成_正向实体转json映射', 'codeGenfileJsonW', '${jsonFile}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:05', NULL, '2022-06-06 14:31:05', NULL, NULL, NULL, '{classVar}.json', 'src/main/resources/entityJson/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697732414533634', '代码生成_正向Data.js_编辑JS', 'codeGenDatajsW', 'export default {\n    data(){\n        return {\n            //表单数据\n            data:${vueJs.data},\n            //从表单数据\n            initData:${vueJs.initData},\n            //公式\n            formulas:${vueJs.formulas},\n            //校验函数\n            rules:${vueJs.rules},\n            //区域计算\n            calcAreas:${vueJs.calcAreas},\n            //校验规则\n            validRules:${vueJs.validRules},\n            //自定义查询\n            customquery:${vueJs.customquery},\n            //元数据\n            metadata:${vueJs.metadata},\n            listSearchType:\"${vueJs.listSearchType}\",\n            treeJson:${vueJs.treeJson}\n        }\n    }\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:30:09', NULL, '2022-06-06 14:30:09', NULL, NULL, NULL, '{class}Data.js', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697561588920321', '代码生成_正向Apijs代码', 'codeGenApijsW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign developer=vars.developer>\n<#assign system=vars.system>\n<#assign name=model.name>\n<#assign domain=vars.domain>\nimport rxAjax from \'@/assets/js/ajax.js\';\n\n/*\n 概要说明:${name} api接口\n 开发人员:${developer}\n*/\nexport const ${class}Api = {};\n\n${class}Api.baseUrl= \'/api-${system}/${system}/${package}/${classVar}\';\n${class}Api.exportUrl= ${class}Api.baseUrl + \'/export\';\n\n//查询列表\n${class}Api.query=function (parameter) {\n  var url= ${class}Api.baseUrl + \'/query\';\n  return rxAjax.postJson(url,parameter).then (res => {\n    return res.result\n  })\n}\n\n\n/**\n * 获取表单数据\n * @param pkId\n * @returns {*}\n */\n${class}Api.getById =function(pkId) {\n    var url= ${class}Api.baseUrl + \'/getById?pkId=\' + pkId;\n    return rxAjax.get(url);\n}\n\n/**\n * 保存表单数据\n * @param formdata\n * @returns {*}\n */\n${class}Api.saveData =function(formdata) {\n    var url= ${class}Api.baseUrl + \'/saveData\';\n    return rxAjax.postJson(url,formdata);\n}\n\n\n\n//删除数据\n${class}Api.del =function(parameter) {\n  var url= ${class}Api.baseUrl + \'/del\';\n  return rxAjax.postUrl(url,parameter);\n}\n\nexport  default ${class}Api;\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:29:28', NULL, '2022-06-06 14:29:28', NULL, NULL, NULL, '{classVar}.js', 'src/api/{system}/{package}', 'YES', 'mainSub', 'genCode');

-- 2022-06-06--jpaas_form szw ---代码生成器后台模板更新
delete from `jpaas_form`.`form_codegen_template` where ID_ in('1427176661270401026','1424623584797523970','1424627869878845442','1424629106896535554','1424629731029942274','1424630163097780225','1424906913904091137','1424907493359771649','1424907493359771650','1424907787665694721');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424623584797523970', '控制器模板', '{class}Controller.java', 'src/main/java/com/redxun/{system}/{package}/controller', 'NO', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign classVar=model.vars.classVar>\r\n<#assign entAlias=model.vars.entAlias>\r\n<#assign comment=model.name>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n<#assign tableName=model.tableName>\r\n<#assign colList=model.boAttrList>\r\n\r\npackage ${domain}.${system}.${package}.controller;\r\n\r\nimport com.redxun.common.base.db.BaseService;\r\nimport com.redxun.gencode.controller.CodeGenBaseController;\r\nimport ${domain}.${system}.${package}.entity.${class};\r\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\r\nimport io.swagger.annotations.Api;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport com.redxun.common.annotation.ClassDefine;\r\n\r\n\r\n/**\r\n* [${model.name}] 控制器代码\r\n* @author: ${vars.developer}\r\n* @company: ${vars.company}\r\n* @date: ${vars.date}\r\n*/\r\n@Slf4j\r\n@RestController\r\n@RequestMapping(\"/${system}/${package}/${classVar}\")\r\n@Api(tags = \"${comment}\")\r\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\r\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\r\n\r\n	@Autowired\r\n	${class}ServiceImpl ${classVar}Service;\r\n\r\n\r\n\r\n	@Override\r\n	public BaseService getBaseService() {\r\n		return ${classVar}Service;\r\n	}\r\n\r\n	@Override\r\n	public String getComment() {\r\n		return \"${comment}\";\r\n	}\r\n\r\n	@Override\r\n	public String getFormAlias() {\r\n		return \"${entAlias}\";\r\n	}\r\n	\r\n	@Override\r\n	public String getPackage(){\r\n		return \"${package}\";\r\n	}\r\n\r\n	@Override\r\n	public String getCreateType() {\r\n		return \"${model.genMode}\";\r\n	}\r\n\r\n	@Override\r\n	public ${class} getBaseEntity(){\r\n		return new ${class}();\r\n	}\r\n\r\n}', '1', '1', '1', '2021-08-09 00:00:00', '1', '2021-08-19 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424627869878845442', '实体模板', '{class}.java', 'src/main/java/com/redxun/{system}/{package}/entity', 'NO', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign classVar=model.vars.classVar>\r\n<#assign comment=model.name>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n<#assign tableName=model.tableName>\r\n<#assign colList=model.boAttrList>\r\n<#assign idField=convertUnderLine(model.idField)>\r\n\r\n\r\n/**\r\n* [${model.name}]实体类定义\r\n* @author: ${vars.developer}\r\n* @company: ${vars.company}\r\n* @date: ${vars.date}\r\n*/\r\npackage ${domain}.${system}.${package}.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableField;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport com.fasterxml.jackson.annotation.JsonCreator;\r\nimport ${domain}.common.base.entity.BaseExtEntity;\r\nimport com.redxun.gencode.codegenhander.SubTableDef;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\nimport lombok.experimental.Accessors;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport org.apache.ibatis.type.JdbcType;\r\nimport java.util.Date;\r\n\r\n\r\n@Setter\r\n@Getter\r\n@Accessors(chain = true)\r\n@TableName(value = \"${tableName}\")\r\npublic class ${class}  extends BaseExtEntity<java.lang.String> {\r\n\r\n    @JsonCreator\r\n    public ${class}() {\r\n    }\r\n	\r\n	//主键\r\n    @TableId(value = \"${model.idField}\",type = IdType.INPUT)\r\n	private String ${idField};\r\n\r\n	@Override\r\n    public String getPkId() {\r\n        return this.${idField};\r\n    }\r\n\r\n    @Override\r\n    public void setPkId(String pkId) {\r\n        this.${idField}=pkId;\r\n    }\r\n\r\n	<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\r\n	//外键\r\n    @TableField(value = \"REF_ID_\",jdbcType=JdbcType.VARCHAR)\r\n    private String refId;\r\n\r\n    //父键\r\n    @TableField(value = \"PARENT_ID_\",jdbcType=JdbcType.VARCHAR)\r\n    private String parentId;\r\n	</#if>\r\n    <#list colList as col>\r\n	<#if model.genMode==\"form\"&& col.control==\"rx-address\">\r\n	//${col.comment}--省\r\n    @TableField(value = \"${col.fieldName}_PROVINCE\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}Province;\r\n	\r\n	//${col.comment}--省code\r\n    @TableField(value = \"${col.fieldName}_P_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}Pcode;\r\n	\r\n	//${col.comment}--市\r\n    @TableField(value = \"${col.fieldName}_CITY\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}City;\r\n	\r\n	//${col.comment}--市Code\r\n    @TableField(value = \"${col.fieldName}_CITY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}CityCode;\r\n	\r\n	//${col.comment}--县(区)\r\n    @TableField(value = \"${col.fieldName}_COUNTY\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}County;\r\n	\r\n	//${col.comment}--县(区)Code\r\n    @TableField(value = \"${col.fieldName}_COUNTY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}CountyCode;\r\n	\r\n	//${col.comment}--详细地址\r\n    @TableField(value = \"${col.fieldName}_ADDRESS\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}Address;\r\n	<#else>\r\n	//${col.comment}\r\n    @TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name};\r\n	\r\n	<#if model.genMode==\"form\"&& col.isSingle==0>\r\n	//${col.comment}名称\r\n    @TableField(value = \"${col.fieldName}_NAME\",jdbcType=JdbcType.${getJdbcType(col)})\r\n    private ${getJavaType(col)} ${col.name}Name;\r\n	</#if>\r\n	</#if>\r\n    </#list>\r\n\r\n	\r\n	<#if model.boEntityList?size gt 0 >\r\n    <#list model.boEntityList as subEnt>\r\n    @TableField(exist=false)\r\n	@SubTableDef(tableName = \"${subEnt.vars.class}\",className = ${subEnt.vars.class}.class,type = \"onetomany\")\r\n	private List<${subEnt.vars.class}> ${subEnt.vars.classVar}List=new ArrayList<>();\r\n	</#list>	\r\n	</#if>\r\n \r\n}\r\n\r\n\r\n<#function getJdbcType col>\r\n<#assign dbtype=col.dataType?lower_case>\r\n<#assign rtn>\r\n	<#if  dbtype==\"number\"  >\r\n		NUMERIC\r\n	<#elseif (dbtype==\"date\")>\r\n		DATE\r\n	<#else>\r\n		VARCHAR\r\n	</#if>\r\n</#assign>\r\n<#return rtn?trim>\r\n</#function>\r\n\r\n\r\n<#function getJavaType col>\r\n<#assign dbtype=col.dataType?lower_case>\r\n<#assign rtn>\r\n<#if  dbtype==\"number\"  >\r\n    <#if col.decimalLength==0>\r\n         <#if col.length gt 10 >\r\n            long\r\n         <#else>\r\n            int\r\n         </#if>\r\n    <#else>\r\n         double\r\n    </#if>\r\n<#elseif (dbtype==\"date\")>\r\n	Date\r\n<#else>\r\n	String\r\n</#if>\r\n</#assign>\r\n <#return rtn?trim>\r\n</#function>\r\n\r\n\r\n<#function convertUnderLine field>\r\n	<#if field?index_of(\"_\")==-1>\r\n		<#assign rtn>${field?lower_case?trim}</#assign>\r\n		<#return rtn>\r\n	</#if>\r\n\r\n	<#if field?index_of(\"F_\")==0>\r\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n		<#return rtn>\r\n	</#if>\r\n\r\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n <#return rtn>\r\n</#function>\r\n\r\n', '1', '1', '1', '2021-08-09 00:00:00', '1', '2021-08-19 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424629106896535554', 'Mapping文件', '{class}Mapper.xml', 'src/main/resources/mapper/{system}/{package}', 'NO', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\r\n<#assign tableName=model.tableName>\r\n<#assign colList=model.boAttrList>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"${domain}.${system}.${package}.mapper.${class}Mapper\">\r\n\r\n    <resultMap id=\"${class}\" type=\"${type}\">\r\n            <#assign idField=convertUnderLine(model.idField)>\r\n            <id property=\"${idField}\" column=\"${model.idField}\" jdbcType=\"VARCHAR\"/>\r\n		        <#list colList as col>\r\n    	        <#assign colName=convertUnderLine(col.fieldName)>\r\n				<#if model.genMode==\"form\"&& col.control==\"rx-address\">\r\n				<result property=\"${colName}Province\" column=\"${col.fieldName}_PROVINCE\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}Pcode\" column=\"${col.fieldName}_P_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}City\" column=\"${col.fieldName}_CITY\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}CityCode\" column=\"${col.fieldName}_CITY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}County\" column=\"${col.fieldName}_COUNTY\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}CountyCode\" column=\"${col.fieldName}_COUNTY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<result property=\"${colName}Address\" column=\"${col.fieldName}_ADDRESS\" jdbcType=\"${getJdbcType(col)}\"/>\r\n				<#else>\r\n				<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\r\n			    <#if model.genMode==\"form\"&& col.isSingle==0>\r\n				<result property=\"${colName}Name\" column=\"${col.fieldName}_NAME\" jdbcType=\"${getJdbcType(col)}\"/>\r\n			    </#if>\r\n				</#if>\r\n		        </#list>\r\n		        \r\n		      <#if model.genMode==\"form\">\r\n			  <result property=\"refId\" column=\"REF_ID_\" jdbcType=\"VARCHAR\"/>\r\n			  <result property=\"parentId\" column=\"PARENT_ID_\" jdbcType=\"VARCHAR\"/>\r\n		      <result property=\"tenantId\" column=\"TENANT_ID_\" jdbcType=\"VARCHAR\"/>\r\n		      <result property=\"createBy\" column=\"CREATE_BY_\" jdbcType=\"VARCHAR\"/>\r\n		      <result property=\"createTime\" column=\"CREATE_TIME_\" jdbcType=\"DATE\"/>\r\n		      <result property=\"updateBy\" column=\"UPDATE_BY_\" jdbcType=\"VARCHAR\"/>\r\n		      <result property=\"updateTime\" column=\"UPDATE_TIME_\" jdbcType=\"DATE\"/>\r\n		      <result property=\"createDepId\" column=\"CREATE_DEP_ID_\" jdbcType=\"VARCHAR\"/>\r\n		      </#if>\r\n    </resultMap>\r\n\r\n\r\n    <select id=\"query\" resultType=\"${type}\" parameterType=\"java.util.Map\">\r\n        select ${model.idField},<#list colList as col>${col.fieldName}<#if col_has_next>,</#if></#list><#if model.genMode==\"form\">,REF_ID_,PARENT_ID_,TENANT_ID_,CREATE_BY_,CREATE_TIME_,UPDATE_BY_,UPDATE_TIME_,CREATE_DEP_ID_</#if> from ${tableName}\r\n        <#noparse>\r\n        <where>\r\n            <if test=\"@rx.Ognl@isNotEmpty(w.whereSql)\">\r\n                ${w.whereSql}\r\n            </if>\r\n        </where>\r\n        <if test=\"@rx.Ognl@isNotEmpty(w.orderBySql)\">\r\n            ORDER BY ${w.orderBySql}\r\n        </if>\r\n        <if test=\"@rx.Ognl@isEmpty(w.orderBySql)\"></#noparse>\r\n            ORDER BY  ${model.idField} DESC\r\n        </if>\r\n    </select>\r\n	\r\n	<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\r\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\r\n		select * from ${tableName} where REF_ID_=${r\"#\"}{refId}\r\n		ORDER BY  ID_ DESC\r\n	</select>\r\n	\r\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\r\n	DELETE FROM W_subTest0510001 WHERE REF_ID_=${r\"#\"}{refId}\r\n	</delete>\r\n	</#if>\r\n\r\n</mapper>\r\n\r\n<#function getJdbcType col>\r\n<#assign dbtype=col.dataType?lower_case>\r\n<#assign rtn>\r\n	<#if  dbtype==\"number\"  >\r\n		NUMERIC\r\n	<#elseif (dbtype==\"date\")>\r\n		DATE\r\n	<#else>\r\n		VARCHAR\r\n	</#if>\r\n</#assign>\r\n<#return rtn?trim>\r\n</#function>\r\n\r\n\r\n<#function convertUnderLine field>\r\n	<#if field?index_of(\"_\")==-1>\r\n		<#assign rtn>${field?lower_case?trim}</#assign>\r\n		<#return rtn>\r\n	</#if>\r\n\r\n	<#if field?index_of(\"F_\")==0>\r\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n		<#return rtn>\r\n	</#if>\r\n\r\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n <#return rtn>\r\n</#function>\r\n\r\n', '1', '1', '1', '2021-08-09 00:00:00', '1', '2021-08-18 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424629731029942274', '数据库访问类', '{class}Mapper.java', 'src/main/java/com/redxun/{system}/{package}/mapper', 'NO', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\r\n<#assign tableName=model.tableName>\r\n    \r\npackage ${domain}.${system}.${package}.mapper;\r\n\r\nimport ${domain}.${system}.${package}.entity.${class};\r\nimport org.apache.ibatis.annotations.Mapper;\r\nimport com.redxun.common.base.db.BaseDao;\r\n<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\r\nimport org.apache.ibatis.annotations.Param;\r\nimport java.util.List;\r\n</#if>\r\n/**\r\n* [${model.name}]据库访问层\r\n* @author: ${vars.developer}\r\n* @company: ${vars.company}\r\n* @date: ${vars.date}\r\n*/\r\n@Mapper\r\npublic interface ${class}Mapper extends BaseDao<${class}> {\r\n<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\r\n	List<${class}> getByRefId(@Param(\"refId\") String refId);\r\n	\r\n	void deleteByRefId(@Param(\"refId\") String refId);\r\n</#if>\r\n}\r\n', '1', '1', '1', '2021-08-09 00:00:00', '1', '2021-08-19 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424630163097780225', '服务层代码', '{class}ServiceImpl.java', 'src/main/java/com/redxun/{system}/{package}/service', 'NO', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign classVar=model.vars.classVar>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n\r\npackage ${domain}.${system}.${package}.service;\r\n\r\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\r\nimport com.redxun.common.base.db.BaseDao;\r\nimport com.redxun.common.base.db.BaseService;\r\nimport com.redxun.common.service.impl.SuperServiceImpl;\r\nimport com.redxun.common.tool.BeanUtil;\r\nimport com.redxun.common.utils.ExceptionUtil;\r\nimport com.redxun.common.tool.IdGenerator;\r\nimport ${domain}.${system}.${package}.entity.${class};\r\nimport ${domain}.${system}.${package}.mapper.${class}Mapper;\r\n<#if model.boEntityList?size gt 0 >\r\n<#list model.boEntityList as subEnt>\r\nimport ${domain}.${system}.${package}.service.${subEnt.vars.class}ServiceImpl;\r\nimport ${domain}.${system}.${package}.mapper.${subEnt.vars.class}Mapper;\r\nimport ${domain}.${system}.${package}.entity.${subEnt.vars.class};\r\n</#list>\r\n</#if>\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport javax.annotation.Resource;\r\nimport java.io.Serializable;\r\nimport java.util.Collection;\r\nimport java.util.List;\r\n\r\n/**\r\n* [${model.name}]业务服务类\r\n* @author: ${vars.developer}\r\n* @company: ${vars.company}\r\n* @date: ${vars.date}\r\n*/\r\n@Slf4j\r\n@Service\r\npublic class ${class}ServiceImpl extends SuperServiceImpl<${class}Mapper, ${class}> implements BaseService<${class}> {\r\n\r\n    @Resource\r\n    private ${class}Mapper ${classVar}Mapper;\r\n    \r\n    <#if model.boEntityList?size gt 0 >\r\n    <#list model.boEntityList as subEnt>\r\n    @Resource\r\n    private ${subEnt.vars.class}ServiceImpl ${subEnt.vars.classVar}Service;\r\n	@Resource\r\n    private ${subEnt.vars.class}Mapper ${subEnt.vars.classVar}Mapper;\r\n    </#list>\r\n    </#if>\r\n   \r\n    @Override\r\n    public BaseDao<${class}> getRepository() {\r\n        return ${classVar}Mapper;\r\n    }\r\n	\r\n	<#if model.vars.isSub?? && model.vars.isSub==\'YES\' >\r\n	public void saveOrUpdateAll(List<${class}> subList, String pkId){\r\n		${classVar}Mapper.deleteByRefId(pkId);\r\n        if(BeanUtil.isEmpty(subList)){\r\n            return;\r\n        }\r\n        for (${class} sub:subList) {\r\n            sub.setRefId(pkId);\r\n			if(StringUtils.isEmpty(sub.getPkId())){\r\n                sub.setPkId(IdGenerator.getIdStr());\r\n            }\r\n        }\r\n        try {\r\n            this.saveOrUpdateBatch(subList);\r\n        }catch (Exception e){\r\n            log.error(\"saveOrUpdateAll is error: messgae={}\", ExceptionUtil.getExceptionMessage(e));\r\n        }\r\n    }\r\n	</#if>\r\n\r\n		\r\n	<#if model.boEntityList?size gt 0 >\r\n	@Override\r\n    public void delete(Collection<Serializable> entities) {\r\n\r\n        for(Serializable id:entities){\r\n            //根据ID删除${model.name}\r\n            ${classVar}Mapper.deleteById(id);\r\n            <#list model.boEntityList as subEnt>\r\n            //根据ID删除${subEnt.name}    \r\n    		QueryWrapper wrapper=new QueryWrapper();\r\n            wrapper.eq(\"${subEnt.boRelation.fkField}\",id);\r\n            ${subEnt.vars.classVar}Mapper.delete(wrapper);\r\n    		</#list>\r\n        }\r\n    }\r\n	\r\n	/**\r\n     * 根据主键获取表单数据\r\n     * @param pk\r\n     * @return\r\n     */\r\n    @Override\r\n    public ${class} get(Serializable pk){\r\n        ${class} ${classVar}=this.getById(pk);\r\n        if(BeanUtil.isEmpty(${classVar})){\r\n            return new ${class}();\r\n        }\r\n		<#list model.boEntityList as subEnt>\r\n		List<${subEnt.vars.class}> ${subEnt.vars.classVar}List =${subEnt.vars.classVar}Mapper.getByRefId((String)pk);\r\n        ${classVar}.set${subEnt.vars.class}List(${subEnt.vars.classVar}List);\r\n		</#list>\r\n        return ${classVar};\r\n    }\r\n\r\n    @Override\r\n    public int insert(${class} entity) {\r\n        String pkId = entity.getPkId();\r\n        if(BeanUtil.isEmpty(pkId)) {\r\n            pkId=IdGenerator.getIdStr();\r\n            entity.setPkId(pkId);\r\n        }\r\n        int insert = getRepository().insert(entity);\r\n		<#list model.boEntityList as subEnt>\r\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),pkId);\r\n		</#list>\r\n        return insert;\r\n    }\r\n\r\n    @Override\r\n    public int update(${class} entity) {\r\n        int insert =  getRepository().updateById(entity);\r\n		<#list model.boEntityList as subEnt>\r\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),entity.getPkId());\r\n		</#list>\r\n        return insert;\r\n    }\r\n    </#if>\r\n	\r\n	\r\n	\r\n\r\n\r\n}\r\n', '1', '1', '1', '2021-08-09 00:00:00', '1', '2021-08-19 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424906913904091137', '列表文件', '{class}List.vue', 'src/views/modules/{system}/{package}', 'YES', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign classVar=model.vars.classVar>\r\n<#assign comment=model.name>\r\n<#assign pk=model.idField>\r\n<#assign system=vars.system>\r\n<#assign domain=vars.domain>\r\n<#assign commonList=model.boAttrList>\r\n<template>\r\n  <rx-layout>\r\n    <div slot=\"center\" style>\r\n      <rx-fit>\r\n        <div slot=\"toolheader\" foldheader=\"true\" foldbtn=\"false\" border=\"false\">\r\n          <div class=\"table-operator\">\r\n            <rx-button alias=\"${classVar}Add\" :butn-icon=\"\'plus\'\" :butn-type=\"\'primary\'\" :show-no-right=\"true\" @click=\"add\">新建</rx-button>\r\n            <a-dropdown v-if=\"editEnable && selectedRowKeys.length > 0 || removeEnable && selectedRowKeys.length > 0\">\r\n              <a-button style=\"margin-left: 8px\"> 更多 <a-icon type=\"down\" /> </a-button>\r\n              <a-menu slot=\"overlay\">\r\n                <a-menu-item key=\"1\" v-if=\"editEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Edit\" :butn-icon=\"\'edit\'\"\r\n                             :butn-type=\"\'primary\'\" :show-no-right=\"false\" @click=\"editOne\"><a-icon type=\"edit\"  />编辑</a-menu-item>\r\n                <a-menu-item key=\"2\" v-if=\"removeEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Delete\" :butn-icon=\"\'delete\'\" :butn-type=\"\'danger\'\"\r\n                             :show-no-right=\"false\" @click=\"delByIds(selectedRowKeys)\"><a-icon type=\"delete\" />删除</a-menu-item>\r\n              </a-menu>\r\n            </a-dropdown>\r\n          </div>\r\n          <span class=\"search-btn-box\">\r\n                <span class=\"search-btn\" @click=\"searchshow\"><i class=\"iconfont iconguolv\"></i>过滤</span>\r\n           </span>\r\n        </div>\r\n        <div slot=\"searchbar\" btnalign=\"right\"  v-if=\"fitSearch\" @search=\"search\" @cancel=\"cancel\" @close=\"close\">\r\n          <a-form layout=\"vertical\">\r\n            <#list commonList as col>\r\n              <a-form-item label=\"${col.comment}\">\r\n                <#if (col.dataType==\"date\")>\r\n                  从\r\n                  <a-date-picker placeholder=\"请输入${col.comment}\" v-model=\"queryParam.Q_${col.fieldName}_D_GT\"\r\n                                 format=\"YYYY-MM-DD\"/>至\r\n                  <a-date-picker placeholder=\"请输入${col.comment}\" v-model=\"queryParam.Q_${col.fieldName}_D_LT\"\r\n                                 format=\"YYYY-MM-DD\"/>\r\n                <#elseif (col.dataType==\"number\")>\r\n                  <a-input-number :min=\"0\" :max=\"1000000\" placeholder=\"请输入${col.comment}\"\r\n                                  v-model=\"queryParam.Q_${col.fieldName}_I_EQ\"/>\r\n                <#else>\r\n                  <a-input placeholder=\"请输入${col.comment}\" v-model=\"queryParam.Q_${col.fieldName}_S_LK\"/>\r\n                </#if>\r\n              </a-form-item>\r\n            </#list>\r\n          </a-form>\r\n        </div>\r\n        <#assign idField=convertUnderLine(pk)>\r\n        <rx-grid\r\n                ref=\"table\"\r\n                :allowRowSelect=\"true\"\r\n                :multiSelect=\"true\"\r\n                :columns=\"columns\"\r\n                :defaultPageSize=\"10\"\r\n                url=\"/api-${system}/${system}/${package}/${classVar}/query\"\r\n                :queryParam=\"queryParam\"\r\n                data-field=\"result.data\"\r\n                :pageSizeOptions=\"[\'10\',\'30\',\'40\']\"\r\n                id-field=\"${idField}\"\r\n                @selectChange=\"onSelectChange\"\r\n        >\r\n          <span slot=\"action\" slot-scope=\"{ text, record }\" class=\"actionIcons\">\r\n                <span  @click.stop=\"edit(record)\">编辑</span>\r\n				<span  @click.stop=\"detail(record)\">明细</span>\r\n                <span  @click.stop=\"delByIds([record.${idField}])\">删除</span>\r\n            </span>\r\n        </rx-grid>\r\n      </rx-fit>\r\n    </div>\r\n  </rx-layout>\r\n</template>\r\n\r\n<script>\r\n  import ${class}Api from \'@/api/${system}/${package}/${classVar}\'\r\n  import ${class}Edit from \'./${class}Edit\'\r\n  import {BaseList,RxFit,RxGrid,RxButton,RxSpan } from \'jpaas-common-lib\';\r\n  //import  from \"@/views/modules/share/rx-button\";\r\n  //import  from \"@/views/modules/share/rx-span\";\r\n  export default {\r\n    name: \'${class}List\',\r\n    mixins: [BaseList],\r\n    components: {\r\n      RxButton,\r\n      RxSpan,\r\n      RxFit\r\n    },\r\n    data() {\r\n      return {\r\n        columns: [\r\n          {\r\n            title: \'序号\',\r\n            type: \'indexColumn\',\r\n            width: 100,\r\n            dataIndex: \'serial\',\r\n            scopedSlots: {customRender: \'serial\'}\r\n          },\r\n          <#list commonList as col>\r\n          {title: \'${col.comment}\', dataIndex: \'${col.name}\', width: 100},\r\n          </#list>\r\n          {title: \'操作\', width: 100, dataIndex: \'action\', scopedSlots: {customRender: \'action\'}}\r\n        ],\r\n        component:${class}Edit,\r\n        comment:\"${comment}\",\r\n        fitSearch:false,\r\n      }\r\n    },\r\n    methods:{\r\n      delById(ids){\r\n        return ${class}Api.del({ ids: ids.join(\',\') });\r\n      },\r\n      getListByParams(parameter){\r\n        return ${class}Api.query(parameter)\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n  .table-operator {\r\n    padding:4px;\r\n  }\r\n  .table-operator button {\r\n    margin:2px;\r\n  }\r\n</style>\r\n\r\n<#function convertUnderLine field>\r\n  <#if field?index_of(\"_\")==-1>\r\n    <#assign rtn>${field?lower_case?trim}</#assign>\r\n    <#return rtn>\r\n  </#if>\r\n\r\n  <#if field?index_of(\"F_\")==0>\r\n    <#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n    <#return rtn>\r\n  </#if>\r\n\r\n  <#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\r\n  <#return rtn>\r\n</#function>\r\n\r\n', '1', '1', '1', '2021-08-10 00:00:00', '1', '2021-08-19 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424907493359771649', 'Apijs代码', '{classVar}.js', 'src/api/{system}/{package}', 'YES', 'YES', '<#assign package=model.vars.package>\r\n<#assign class=model.vars.class>\r\n<#assign classVar=model.vars.classVar>\r\n<#assign developer=vars.developer>\r\n<#assign system=vars.system>\r\n<#assign name=model.name>\r\n<#assign domain=vars.domain>\r\nimport rxAjax from \'@/assets/js/ajax.js\';\r\n\r\n/*\r\n 概要说明:${name} api接口\r\n 开发人员:${developer}\r\n*/\r\nexport const ${class}Api = {};\r\n\r\n${class}Api.baseUrl= \'/api-${system}/${system}/${package}/${classVar}\';\r\n${class}Api.exportUrl= ${class}Api.baseUrl + \'/export\';\r\n\r\n//查询列表\r\n${class}Api.query=function (parameter) {\r\n  var url= ${class}Api.baseUrl + \'/query\';\r\n  return rxAjax.postJson(url,parameter).then (res => {\r\n    return res.result\r\n  })\r\n}\r\n\r\n\r\n/**\r\n * 获取表单数据\r\n * @param pkId\r\n * @returns {*}\r\n */\r\n${class}Api.getById =function(pkId) {\r\n    var url= ${class}Api.baseUrl + \'/getById?pkId=\' + pkId;\r\n    return rxAjax.get(url);\r\n}\r\n\r\n/**\r\n * 保存表单数据\r\n * @param formdata\r\n * @returns {*}\r\n */\r\n${class}Api.saveData =function(formdata) {\r\n    var url= ${class}Api.baseUrl + \'/saveData\';\r\n    return rxAjax.postJson(url,formdata);\r\n}\r\n\r\n\r\n\r\n//删除数据\r\n${class}Api.del =function(parameter) {\r\n  var url= ${class}Api.baseUrl + \'/del\';\r\n  return rxAjax.postUrl(url,parameter);\r\n}\r\n\r\nexport  default ${class}Api;\r\n\r\n', '1', '1', '1', '2021-08-10 00:00:00', '1', '2021-08-18 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424907493359771650', '实体转json映射', '{classVar}.json', 'src/main/resources/entityJson/{package}', 'YES', 'YES', '${jsonFile}', '1', '1', '1', '2021-08-10 00:00:00', '1', '2021-08-18 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1424907787665694721', '编辑页面', '{class}Edit.vue', 'src/views/modules/{system}/{package}', 'YES', 'YES', '${vueTemplate}', '1', '1', '1', '2021-08-10 00:00:00', '1', '2021-08-18 00:00:00');
INSERT INTO `jpaas_form`.`form_codegen_template`(`ID_`, `NAME_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `ENABLED_`, `CONTENT_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1427176661270401026', '编辑JS', '{class}Data.js', 'src/views/modules/{system}/{package}', 'YES', 'YES', '${vueJs}', '1', '1', '1', '2021-08-16 00:00:00', '1', '2021-08-18 00:00:00');

-- 2022-06-06--jpaas_form szw --新增代码生成器表--FORM_CODEGEN_SETTING
CREATE TABLE jpaas_form.FORM_CODEGEN_SETTING (
  ID_ varchar(64)  NOT NULL COMMENT '主键',
  NAME_ varchar(64)   COMMENT '名称',
  KEY_ varchar(64)   COMMENT '别名',
  DESCP_ varchar(255)   COMMENT '描述',
  SETTING_JSON_ longtext  NULL COMMENT '生成代码配置信息',
  TENANT_ID_ varchar(64)   COMMENT '租户ID',
  CREATE_DEP_ID_ varchar(64)   COMMENT '创建部门ID',
  CREATE_BY_ varchar(64)   COMMENT '创建人ID',
  CREATE_TIME_ datetime(0)  COMMENT '创建时间',
  UPDATE_BY_ varchar(64)   COMMENT '更新人ID',
  UPDATE_TIME_ datetime(0)  COMMENT '更新时间',
  TREE_ID_ varchar(64)   COMMENT '分类ID',
  PRIMARY KEY (ID_) USING BTREE
);
ALTER TABLE jpaas_form.FORM_CODEGEN_SETTING COMMENT '代码生成管理';

-- 2022-06-06--jpaas_form szw --新增代码生成器菜单
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1522471296705925121', '1216010678984933378', '代码生成', '{\"type\":\"customIcon\",\"icon\":\"iconbumenguanli\"}', 'iconbumenguanli', NULL, '0', '0.1522471296705925121.', 12, 'URL', 'CodeGenSettingList', 'C', 'modules/form/core/CodeGenSettingList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-05-06 15:00:18', '1', '2022-05-11 11:51:29', NULL, 'N', NULL);

-- 2022-05-31 jpaas_form hj 查询策略增加视图类型和是否默认字段
ALTER TABLE jpaas_form.form_query_strategy ADD COLUMN VIEW_TYPE_ VARCHAR(20) COMMENT '视图类型';
ALTER TABLE jpaas_form.form_query_strategy ADD COLUMN DEFAULT_VIEW_ VARCHAR(20) COMMENT '是否默认';
-- 可选
-- ALTER TABLE jpaas_form.form_query_strategy DROP IS_PUBLIC_;
-- ALTER TABLE jpaas_form.form_query_strategy DROP IS_USER_;

-- 2022-06-10 jpaas-form szw  表单元数据字段调整为longtext
ALTER TABLE JPAAS_FORM.FORM_CODEGEN_SETTING
    CHANGE SETTING_JSON_ SETTING_JSON_ LONGTEXT NULL  COMMENT '生成代码配置信息';

-- 2022-06-14 jpaas-form szw  代码生成器模板修改：支持主从分离模式---begin
ALTER TABLE jpaas_form.FORM_CODEGEN_SETTING COMMENT '代码生成管理';
delete from `jpaas_form`.`form_template` where ID_ in('1533698962918469634','1533698815715176450','1533698647930433538','1533698526207537154','1533698365993512961','1533698265154056194','1533698110191300609','1533697966238593025','1533697732414533634','1533697561588920321');

INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698962918469634', '代码生成_实体编辑页面', 'bodefEntityVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainClassId=vars.mainClassId>\n<#assign templateType=vars.templateType>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign subComList=model.boEntityList>\n<template>\n    <rx-dialog @handOk=\"handleSubmit\" @cancel=\"cancel\" order=\"top\" btnalign=\"right\" :showok=\"!readonly\">\n        <rx-layout>\n            <div slot=\"center\">\n                <table class=\"table-form four-column\" style=\"width:100%;\" ctltype=\"rx-four-table\" id=\"${mainClassId}\"\n                       borders=\"noborder\" data-sort=\"sortDisabled\">\n                    <colgroup>\n                        <col width=\"15%\">\n                        <col width=\"35%\">\n                        <col width=\"15%\">\n                        <col width=\"35%\">\n                    </colgroup>\n                    <caption>\n                        标题\n                    </caption>\n                    <tbody>\n                        ${firstRowFun(commonList templateType)}\n                        ${otherRowFun(commonList templateType)}\n                        <#if (subComList?? && subComList?size>0)>\n                        ${subRowFun(subComList)}\n                        </#if>\n                    </tbody>\n                </table>\n            </div>\n        </rx-layout>\n    </rx-dialog>\n</template>\n\n<script>\n    import ${class}Api from \"@/api/${system}/${package}/${classVar}.js\";\n    import ${class}Data from \"@/views/modules/${system}/${package}/${class}Data.js\";\n    import formJs from \"@/views/modules/form/core/js-comps/form.js\";\n<#if mainSubType==\'mainAloneSub\'>\n	<#list model.boEntityList as subEnt>\n	import ${subEnt.vars.class}Edit from \'./${subEnt.vars.class}Edit\'\n	</#list>\n</#if>\n    export default{\n        mixins: [formJs,${class}Data],\n        props:[\"pkId\",\"layerid\",\"destroy\",\"readonly\",\"refKey\",\"refKeyName\"],\n        data(){\n            return {\n				<#if mainSubType==\'mainAloneSub\'>\n				components:{\n					<#list model.boEntityList as subEnt>\n					\"${subEnt.vars.classVar}\":${subEnt.vars.class}Edit,\n					</#list>\n				},\n				</#if>\n			}\n        },\n        created() {\n            //加载表单数据\n            this.loadData(${class}Api);\n        },\n        mounted(){\n            this.onload();\n        },\n        methods:{\n            onload(){\n\n            },\n            async _beforeSubmit(){\n\n            },\n            _afterSubmit(result,formJson){\n\n            },\n            enter(entName, field){\n\n            },\n            handleSubmit(vm){\n                this.handSubmit(${class}Api,vm);\n            }\n        },\n        watch:{\n        }\n    }\n</script>\n\n<#function subRowFun subComList>\n    <#assign rtn>\n        <#list subComList as sub>\n            <#assign subColList=sub.boAttrList>\n            <#assign subVars=sub.vars>\n            <#assign colIndex=sub?index>\n                <tr class=\"active2\" <#if mainSubType==\'mainAloneSub\'>v-if=\"readonly\"</#if>>\n                    <td colspan=\"4\" rowspan=\"1\">\n                        <div class=\"rx-table-body  \" ctltype=\"rx-table\" type=\"onetomany\" id=\"${sub.id}\"\n                             tablename=\"${subVars.classVar}\" style=\"width:100%\" tabname=\"${subVars.classVar}\"\n                             tabletype=\"default\" req=\"no\">\n                            <div class=\"table-header-tool\">\n                                <div class=\"title\">\n                                    <div>\n                                        ${subVars.classVar}\n                                    </div>\n                                </div>\n								<#if mainSubType==\'mainAloneSub\'>\n								<a-button-group v-if=\"readonly\">\n                                    <a-button\n                                            v-on:click=\"addSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n									<a-button\n                                            v-on:click=\"editSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        编辑\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								<#else>\n								<a-button-group v-if=\"!getReadonly()\">\n                                    <a-button\n                                            v-on:click=\"add(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								</#if>\n                            </div>\n                            <div class=\"rx-table-box\">\n                                <table class=\"rx-table\">\n                                    <colgroup>\n                                        <col style=\"width: 60px;\">\n                                        <col style=\"width: 60px;\">\n                                        <#list subColList as col>\n                                        <col style=\"width: 100px;\">\n                                        </#list>\n                                    </colgroup>\n                                    <thead>\n                                        <tr class=\"firstRow\">\n                                            <th>#</th>\n                                            <th>序号</th>\n                                            <#list subColList as col>\n                                            <th v-bind:class=\"{required:required.${subVars.classVar}[\'fields\'].${col.name}}\">${col.comment}</th>\n                                            </#list>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr v-if=\"\'item\'\" v-for=\"(item,index) in data.sub__${subVars.classVar}\"\n                                            v-tableselect=\"{item:item,selmode:\'multi\',data:data.sub__${subVars.classVar}}\"\n                                            :key=\"item.index_\" :class=\"{active:item.selected}\">\n                                            <td><a-checkbox :checked=\"item.selected\"></a-checkbox></td>\n                                            <td><rx-serial :serial=\"index+1\"></rx-serial></td>\n                                            <#list subColList as col>\n                                            <td>\n                                                <${col.control} \n													type=\"onetomany\"\n													id=\"${col.id}\" \n													:readonly=\"readonly\"\n													v-model=\"item.${col.name}\" \n													:data=\"data\" \n													:row=\"item\"\n													:valid=\"validFunc(\'${subVars.classVar}\',\'${col.name}\',item)\"\n													name=\"${col.name}\"\n													permission=\"w\" \n													${subColOtherFun(col)} ></${col.control}>\n                                            </td>\n                                            </#list>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                                <div class=\"tableEmpty\"\n                                     v-if=\"data.sub__${subVars.classVar}&amp;&amp;data.sub__${subVars.classVar}.length <= 0\">\n                                    <a-empty></a-empty>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function subColOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-number\'>\n            :max=\"100000000\" \n			:min=\"0\" \n			:step=\"1\" \n			valmode=\"single\"\n        <#elseif ctlType==\'rx-textbox\'>\n            :ispassword=\"false\"\n        <#elseif ctlType==\'rx-form-select\'>\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-user\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#else >\n            valmode=\"single\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function otherRowFun commonList templateType>\n    <#assign templateNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex &gt;= templateNum>\n                <#if (colIndex % templateNum==0)>\n                    <tr>\n                </#if>\n                <#if (col.control==\'rx-tree-select\' || col.control==\'rx-form-select\')>\n                    <td style=\"word-break: break-all;\" :class=\"{required:required.main.khly}\">${col.comment}</td>\n                <#else >\n                    <td style=\"word-break: break-all;\">${col.comment}</td>\n                </#if>\n                    <td style=\"word-break: break-all;\">\n                        <${col.control} \n							type=\"main\"\n							id=\"${col.id}\"\n							:readonly=\"readonly\"\n							v-model=\"data.${col.name}\"\n							:valid=\"validFunc(\'main\',\'${col.name}\')\"\n							permission=\"w\"\n							${colOtherFun(col)}></${col.control}>\n                    </td>\n                <#if colIndex % templateNum == 1 || !col_has_next>\n                </tr>\n                </#if>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function firstRowFun commonList templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex==0>\n                <tr class=\"firstRow\">\n            </#if>\n            <#if colIndex<colindexNum>\n                <td style=\"word-break: break-all;\">${col.comment}</td>\n                <td style=\"word-break: break-all;\">\n                <${col.control} \n					type=\"main\"\n					id=\"${col.id}\"\n					:readonly=\"readonly\"\n					v-model=\"data.${col.name}\"\n					:valid=\"validFunc(\'main\',\'${col.name}\')\"\n					permission=\"w\"\n					${colOtherFun(col)}></${col.control}>\n                </td>\n            </#if>\n            <#if (colindexNum-colIndex)==1>\n                </tr>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function colOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-address\'>\n		<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n           :setting=\"{isCity:${extJson.isCity},isCounty:${extJson.isCounty},isAddress:${extJson.isAddress}}\"\n        <#elseif ctlType==\'rx-radio\'>\n			mode=\"default\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			:onlyvalue=\"false\"\n        <#elseif ctlType==\'rx-number\'>\n			:max=\"1000000\"\n			:min=\"0\"\n			:step=\"1\"\n			length=\"${col.length},${col.decimalLength}\"\n        <#elseif ctlType==\'rx-switch\'>\n			mode=\"custom\"\n			verifyhide=\"${col.name}\"\n			check=\"Y\"\n			uncheck=\"N\"\n        <#elseif ctlType==\'rx-tree-select\'>\n			mode=\"multiple\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:selectable=\"false\"\n			:data=\"data\"\n        <#elseif ctlType==\'rx-form-select\'>\n			:data=\"data\"\n			mode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			valmode=\"single\"\n			:hideselect=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-date\'>\n            format=\"YYYY-MM-DD HH:mm:ss\"\n        <#elseif ctlType==\'rx-user\'>\n			:data=\"data\"\n			gridname=\"main\"\n			:single=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			gridname=\"main\"\n			:single=\"false\"\n			:showdeptpath=\"false\"\n			:deptpathlevel=\"0\"\n			:showdimid=\"true\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:35:02', '1', '2022-06-14 14:27:40', NULL, NULL, NULL, '{class}Edit.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698815715176450', '代码生成_正向列表页面', 'codeGenListVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign pk=model.idField>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign searchFields=settingJson.mainEntity.searchFields>\n\n<template>\n  <rx-layout>\n	${leftSearchTreeFun()}\n    <div slot=\"center\" style>\n      <rx-fit>\n        <div slot=\"toolheader\" foldheader=\"true\" foldbtn=\"false\" border=\"false\">\n          <div class=\"table-operator\">\n            <rx-button alias=\"${classVar}Add\" :butn-icon=\"\'plus\'\" :butn-type=\"\'primary\'\" :show-no-right=\"true\" @click=\"add\">新建</rx-button>\n            <a-dropdown v-if=\"editEnable && selectedRowKeys.length > 0 || removeEnable && selectedRowKeys.length > 0\">\n              <a-button style=\"margin-left: 8px\"> 更多 <a-icon type=\"down\" /> </a-button>\n              <a-menu slot=\"overlay\">\n                <a-menu-item key=\"1\" v-if=\"editEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Edit\" :butn-icon=\"\'edit\'\"\n                             :butn-type=\"\'primary\'\" :show-no-right=\"false\" @click=\"editOne\"><a-icon type=\"edit\"  />编辑</a-menu-item>\n                <a-menu-item key=\"2\" v-if=\"removeEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Delete\" :butn-icon=\"\'delete\'\" :butn-type=\"\'danger\'\"\n                             :show-no-right=\"false\" @click=\"delByIds(selectedRowKeys)\"><a-icon type=\"delete\" />删除</a-menu-item>\n              </a-menu>\n            </a-dropdown>\n          </div>\n          <span class=\"search-btn-box\">\n                <span class=\"search-btn\" @click=\"searchshow\"><i class=\"iconfont iconguolv\"></i>过滤</span>\n           </span>\n        </div>\n        <div slot=\"searchbar\" btnalign=\"right\"  v-if=\"fitSearch\" @search=\"search\" @cancel=\"cancel\" @close=\"close\">\n          <a-form layout=\"vertical\">\n            <#list searchFields as search>\n            <a-form-item label=\"${search.fieldLabel}\">\n				<#if (!search.fc?? || search.fc==\'textbox\')>\n					<a-input <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n							 v-model.trim=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"/>\n				<#elseif (search.fc==\'datepicker\')>\n					<#if search.format??>\n						<#assign searchDateFormat=search.format>\n					<#else>\n						<#assign searchDateFormat=\'YYYY-MM-DD\'>\n					</#if>\n					<a-date-picker <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n								   v-model=\"queryParam[\'queryField_${search.fieldName}\']\"\n								   format=\"${searchDateFormat}\"\n							<#if searchDateFormat==\'YYYY-MM-DD HH:mm:ss\'>\n								show-time\n							</#if>\n								   @change=\"searchDateChange($event,$event,{queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_D_${search.fieldOp}<#else>${search.fieldName}</#if>\',format:\'${searchDateFormat}\'})\"/>\n				<#elseif (search.fc==\'month\')>\n					<a-month-picker  v-model=\"queryParam[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>  @change=\"searchMonthChange($event,$event,{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\'<#if search.format??>,format:\'${search.format}\'</#if>,autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'rangepicker\')>\n					<#if search.format??>\n						<#assign searchRangeFormat=search.format>\n					<#else>\n						<#assign searchRangeFormat=\'YYYY-MM-DD HH:mm:ss\'>\n					</#if>\n					<a-range-picker  ref=\"queryField_${search.fieldName}\"  v-model=\"params[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if> show-time format=\"${searchRangeFormat}\"  @change=\"searchRangeDateChange($event,\'${searchRangeFormat}\',{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\',autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'select\')>\n					<rx-select ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'treeselect\')>\n					<rx-tree-select-ctl ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\" :showSearch=\"<#if search.showSearch??>${search.showSearch?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\" parent-field=\"${search.url_parentfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\" :toTree=\"false\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\" parent-field=\"${search.sql_parentfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'dialog\')>\n					<rx-input-button v-model=\"params[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\" :multiValue=\"true\"\n									 :single=\"false\" :config=\"{fieldName:\'${search.fieldName}\',queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\',dialog:\'<#if search.dialog??>${search.dialog}</#if>\',dialog_name:\'<#if search.dialog_name??>${search.dialog_name}</#if>\',valueField:\'<#if search.valueField??>${search.valueField}</#if>\',textField:\'<#if search.textField??>${search.textField}</#if>\',single:!<#if search.multiSelect??>${search.multiSelect?c}<#else>true</#if>}\"\n									 @click=\"_OnDialogShow\"/>\n				</#if>\n			 </a-form-item>\n            </#list>\n          </a-form>\n        </div>\n        <#assign idField=convertUnderLine(pk)>\n        <rx-grid\n                ref=\"table\"\n			<#if settingJson.multiSelect==\'notSelect\'>\n                :allowRowSelect=\"false\"\n			<#else>\n				:allowRowSelect=\"true\"\n			</#if>\n			<#if settingJson.multiSelect==\'move\'>\n				:multiSelect=\"true\"\n			<#else>\n				:multiSelect=\"false\"\n			</#if>\n                :columns=\"columns\"\n			<#if settingJson.isPage==\'YES\'>\n				:showPage=\"true\"\n				:defaultPageSize=\"${settingJson.pageSize}\"\n				:pageSizeOptions=\"[\'10\',\'20\',\'30\',\'40\',\'50\']\"\n			<#else>\n				:showPage=\"false\"\n			</#if>\n                url=\"/api-${system}/${system}/${package}/${classVar}/query\"\n                :queryParam=\"queryParam\"\n                data-field=\"result.data\"\n                id-field=\"${idField}\"\n                @selectChange=\"onSelectChange\"\n        >\n		  <#list commonList as col>\n		  ${slotScopeColFun(col)}\n          </#list>\n            <span slot=\"action\" slot-scope=\"{ text, record }\" class=\"actionIcons\">\n                <span  @click.stop=\"edit(record)\">编辑</span>\n				<span  @click.stop=\"detail(record)\">明细</span>\n                <span  @click.stop=\"delByIds([record.${idField}])\">删除</span>\n            </span>\n        </rx-grid>\n      </rx-fit>\n    </div>\n  </rx-layout>\n</template>\n\n<script>\n  import ${class}Api from \'@/api/${system}/${package}/${classVar}\'\n  import ${class}Edit from \'./${class}Edit\'\n  import {BaseList,RxFit,RxGrid,RxButton,RxSpan } from \'jpaas-common-lib\';\n  import CodeGenlistJs from \"@/views/modules/form/core/js-comps/CodeGenlist.js\";\n  import ListRender from \'@/views/modules/form/core/js-comps/ListRender.js\';\n  import RxCategoryTreeeditor from \'@/components/redxun/rx-category-treeeditor\'\n  import RxParamsTreeeditor from \'@/components/redxun/rx-params-treeeditor\'\n  //import  from \"@/views/modules/share/rx-button\";\n  //import  from \"@/views/modules/share/rx-span\";\n  export default {\n    name: \'${class}List\',\n    mixins: [BaseList,CodeGenlistJs,ListRender],\n    components: {\n      RxButton,\n      RxSpan,\n      RxFit,\n	  RxCategoryTreeeditor,\n	  RxParamsTreeeditor\n    },\n    data() {\n      return {\n        columns: [\n          {\n            title: \'序号\',\n            type: \'indexColumn\',\n            width: 100,\n            dataIndex: \'serial\',\n            scopedSlots: {customRender: \'serial\'}\n          },\n          <#list commonList as col>\n		  <#if col.headShow==\'YES\'>\n		  {title: \'${col.comment}\', dataIndex: \'${col.name}\', width: ${col.fieldLength}, scopedSlots: {customRender: \'${col.name}\'}},\n		  </#if>\n          </#list>\n          {title: \'操作\', width: 100, dataIndex: \'action\', scopedSlots: {customRender: \'action\'}}\n        ],\n        component:${class}Edit,\n        comment:\"${comment}\",\n        fitSearch:false,\n		curTree:{},\n		${searchTreeScriptFun()}\n      }\n    },\n    methods:{\n	  ${leftQeuryParamFun()}\n      delById(ids){\n        return ${class}Api.del({ ids: ids.join(\',\') });\n      },\n      getListByParams(parameter){\n        return ${class}Api.query(parameter)\n      }\n\n    }\n  }\n</script>\n<style scoped>\n  .table-operator {\n    padding:4px;\n  }\n  .table-operator button {\n    margin:2px;\n  }\n</style>\n\n\n<#function searchTreeScriptFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n	<#assign treeKeyJson=treeJson.treeKeyJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			treeJson:${vueJs.treeJson},\n		</#if>\n		<#if treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			treeCat:{\n						name:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.name}<#else>${treeJson.formSolution.name}</#if>\",\n						treeId:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.treeId}<#else>${treeJson.formSolution.alias}</#if>\"\n					},\n			searchTopNodesUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByTreeIdParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				treeId:\"<#if treeJson.treeKey??>${treeKeyJson.treeId}</#if>\",\n				parentId:\"0\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                pk: \"\"\n			</#if>\n			},\n			searchChildrenUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchChildrenParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				parentId: \"parentId\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                parentId: \"pk\"\n			</#if>\n			},\n			treeRelation:{\n				name:\"<#if treeJson.treeType==\'sysDic\'>name<#else>${treeJson.formSolution.searchLable}</#if>\",\n				treeId:\"<#if treeJson.treeType==\'sysDic\'>dicId<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				parentId:\"<#if treeJson.treeType==\'sysDic\'>parentId<#else>${treeJson.formSolution.searchParentId}</#if>\",\n				key:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				value:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\"\n			},\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function leftQeuryParamFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			getCurTree(){\n                return this.curTree;\n            },\n			handSelect(curRow) {\n                this.curTree=curRow;\n                var treeId = curRow.treeId;\n                if(treeId!=\"0\"){\n                    this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ=treeId;\n                }else {\n                    delete this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ;\n                }\n                this.loadData(this.queryParam);\n            },\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function searchTreeColFun treeJson>\n<#assign searchTreeCol=treeJson.searchTreeCol>\n    <#assign rtn>\n        <#if searchTreeCol.isSingle==0>\n			<#if treeJson.searchTreeColKey==\'name\'>\n			${searchTreeCol.fieldName}_NAME\n			<#else>\n			${searchTreeCol.fieldName}\n			</#if>\n		<#else>\n		${searchTreeCol.fieldName}\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function leftSearchTreeFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			<#if treeJson.treeType==\'treeId\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-category-treeeditor\n						cat-key=\"${treeJson.treeKey}\"\n						:edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n						@handSelect=\"handSelect\"\n						:async=\"true\"\n						:readTreeId=\"<#if treeJson.catSysTreeKey??>\'${treeJson.catSysTreeKey}\'<#else>\'\'</#if>\"\n					></rx-category-treeeditor>\n				</rx-fit>\n			</div>\n			<#elseif treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-params-treeeditor\n					ref=\"rxParamsTreeeditor\"\n                    :edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n                    @handSelect=\"handSelect\"\n                    @addNode=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @addSibling=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Sibling\"\n                    @editNode=\"edit<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @deleteNode=\"delete<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    :treeCat=\"treeCat\"\n                    :searchTopNodesUrl=\"searchTopNodesUrl\"\n                    :searchParams=\"searchParams\"\n                    :treeRelation=\"treeRelation\"\n                    :searchChildrenUrl=\"searchChildrenUrl\"\n					:searchChildrenParams=\"searchChildrenParams\"\n                ></rx-params-treeeditor>\n				</rx-fit>\n			</div>\n			</#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function slotScopeColFun col>\n	<#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-upload\'>\n			<span :title=\"text\" slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				<span class=\"upFiles\" v-html=\"onFileRender(text)\"></span>\n            </span>\n		<#else>\n			<#if ctlType==\'rx-address\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				{{onAddressRender(\'${model.genMode}\',record,\'${col.name}\',${fileUtil.countAddressFromExtJson(col.extJson)})}}\n			</span>\n			<#elseif col.isSingle==\'0\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{record.${col.name}Name}}</span>\n			<#else><span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{text}}</span></#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function convertUnderLine field>\n  <#if field?index_of(\"_\")==-1>\n    <#assign rtn>${field?lower_case?trim}</#assign>\n    <#return rtn>\n  </#if>\n\n  <#if field?index_of(\"F_\")==0>\n    <#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n    <#return rtn>\n  </#if>\n\n  <#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n  <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:34:27', NULL, '2022-06-06 14:34:27', NULL, NULL, NULL, '{class}List.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698647930433538', '代码生成_正向Mapping文件', 'codeGenMappingW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\n<mapper namespace=\"${domain}.${system}.${package}.mapper.${class}Mapper\">\n\n    <resultMap id=\"${class}\" type=\"${type}\">\n            <#assign idField=convertUnderLine(model.idField)>\n            <id property=\"${idField}\" column=\"${model.idField}\" jdbcType=\"VARCHAR\"/>\n		        <#list colList as col>\n				${columnFun(col model.genMode)}\n		        </#list>\n		      <#if model.genMode==\"form\" || model.genMode==\"create\" >\n			  <result property=\"refId\" column=\"REF_ID_\" jdbcType=\"VARCHAR\"/>\n			  <result property=\"parentId\" column=\"PARENT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"tenantId\" column=\"TENANT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createBy\" column=\"CREATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createTime\" column=\"CREATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"updateBy\" column=\"UPDATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"updateTime\" column=\"UPDATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"createDepId\" column=\"CREATE_DEP_ID_\" jdbcType=\"VARCHAR\"/>\n		      </#if>\n    </resultMap>\n\n\n    <select id=\"query\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n        select ${model.idField},<#list colList as col>${selectColumnFun(col model.genMode)}<#if col_has_next>,</#if></#list><#if model.genMode==\"form\" || model.genMode==\"create\" >,REF_ID_,PARENT_ID_,TENANT_ID_,CREATE_BY_,CREATE_TIME_,UPDATE_BY_,UPDATE_TIME_,CREATE_DEP_ID_</#if> from ${tableName}\n        <#noparse>\n        <where>\n            <if test=\"@rx.Ognl@isNotEmpty(w.whereSql)\">\n                ${w.whereSql}\n            </if>\n        </where>\n        <if test=\"@rx.Ognl@isNotEmpty(w.orderBySql)\">\n            ORDER BY ${w.orderBySql}\n        </if>\n        <if test=\"@rx.Ognl@isEmpty(w.orderBySql)\"></#noparse>\n            ORDER BY  ${model.idField} DESC\n        </if>\n    </select>\n	\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM W_subTest0510001 WHERE ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</delete>\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM W_subTest0510001 WHERE ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</delete>\n	</#if>\n</#if>\n	\n\n</mapper>\n\n\n<#function selectColumnFun col genMode>\n<#assign name=col.fieldName>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n			${name}_PROVINCE,${name}_P_CODE\n			<#if extJson.isCity==\"true\">\n			,${name}_CITY,${name}_CITY_CODE\n			</#if>\n			<#if extJson.isCounty==\"true\">\n			,${name}_COUNTY,${name}_COUNTY_CODE\n			</#if>\n			<#if extJson.isAddress==\"true\">\n			,${name}_ADDRESS\n			</#if>\n		<#elseif col.isSingle==0>\n			${name}_NAME,${name}\n		<#else>\n			${name}\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n			\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			${provinceJson.fieldName},${name}\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				,${cityJson.fieldName}\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				,${cityCodeJson.fieldName}\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				,${countyJson.fieldName}\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				,${countyCodeJson.fieldName}\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				,${addressJson.fieldName}\n			</#if>\n		<#elseif col.isSingle==0>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			${name},${colJson.fieldName}\n		<#else>\n			${name}\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function columnFun col genMode>\n<#assign colName=convertUnderLine(col.fieldName)>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n			<#assign setting=extJson.setting>\n			<result property=\"${colName}Province\" column=\"${col.fieldName}_PROVINCE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Pcode\" column=\"${col.fieldName}_P_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<result property=\"${colName}City\" column=\"${col.fieldName}_CITY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CityCode\" column=\"${col.fieldName}_CITY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<result property=\"${colName}County\" column=\"${col.fieldName}_COUNTY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CountyCode\" column=\"${col.fieldName}_COUNTY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<result property=\"${colName}Address\" column=\"${col.fieldName}_ADDRESS\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Name\" column=\"${col.fieldName}_NAME\" jdbcType=\"${getJdbcType(col)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			<result property=\"${convertUnderLine(provinceJson.fieldName)}\" column=\"${provinceJson.fieldName}\" jdbcType=\"${getJdbcType(provinceJson)}\"/>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				<result property=\"${convertUnderLine(cityJson.fieldName)}\" column=\"${cityJson.fieldName}\" jdbcType=\"${getJdbcType(cityJson)}\"/>\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				<result property=\"${convertUnderLine(cityCodeJson.fieldName)}\" column=\"${cityCodeJson.fieldName}\" jdbcType=\"${getJdbcType(cityCodeJson)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				<result property=\"${convertUnderLine(countyJson.fieldName)}\" column=\"${countyJson.fieldName}\" jdbcType=\"${getJdbcType(countyJson)}\"/>\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				<result property=\"${convertUnderLine(countyCodeJson.fieldName)}\" column=\"${countyCodeJson.fieldName}\" jdbcType=\"${getJdbcType(countyCodeJson)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				<result property=\"${convertUnderLine(addressJson.fieldName)}\" column=\"${addressJson.fieldName}\" jdbcType=\"${getJdbcType(addressJson)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			<result property=\"${convertUnderLine(colJson.fieldName)}\" column=\"${colJson.fieldName}\" jdbcType=\"${getJdbcType(colJson)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:47', '1', '2022-06-13 18:03:48', NULL, NULL, NULL, '{class}Mapper.xml', 'src/main/resources/mapper/{system}/{package}', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698526207537154', '代码生成_正向Controller控制层', 'codeGenControllerW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign entAlias=model.vars.entAlias>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n\npackage ${domain}.${system}.${package}.controller;\n\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.gencode.controller.CodeGenBaseController;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\nimport io.swagger.annotations.Api;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.*;\nimport com.redxun.common.annotation.ClassDefine;\n\n\n/**\n* [${model.name}] 控制器代码\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@RestController\n@RequestMapping(\"/${system}/${package}/${classVar}\")\n@Api(tags = \"${comment}\")\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\n\n	@Autowired\n	${class}ServiceImpl ${classVar}Service;\n\n\n\n	@Override\n	public BaseService getBaseService() {\n		return ${classVar}Service;\n	}\n\n	@Override\n	public String getComment() {\n		return \"${comment}\";\n	}\n\n	@Override\n	public String getFormAlias() {\n		return \"${entAlias}\";\n	}\n\n	@Override\n	public String getclassAlias() {\n		return \"${classVar}\";\n	}\n	\n	@Override\n	public String getPackage(){\n		return \"${package}\";\n	}\n\n	@Override\n	public String getCreateType() {\n		return \"${model.genMode}\";\n	}\n\n	@Override\n	public ${class} getBaseEntity(){\n		return new ${class}();\n	}\n\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:18', NULL, '2022-06-06 14:33:18', NULL, NULL, NULL, '{class}Controller.java', 'src/main/java/com/redxun/{system}/{package}/controller', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698365993512961', '代码生成_正向ServiceImpl服务层', 'codeGenServiceImpl', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign domain=vars.domain>\n\npackage ${domain}.${system}.${package}.service;\n\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.redxun.common.base.db.BaseDao;\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.common.service.impl.SuperServiceImpl;\nimport com.redxun.common.tool.BeanUtil;\nimport com.redxun.common.tool.StringUtils;\nimport com.redxun.common.utils.ExceptionUtil;\nimport com.redxun.common.tool.IdGenerator;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.mapper.${class}Mapper;\n<#if model.boEntityList?size gt 0 >\n<#list model.boEntityList as subEnt>\nimport ${domain}.${system}.${package}.service.${subEnt.vars.class}ServiceImpl;\nimport ${domain}.${system}.${package}.mapper.${subEnt.vars.class}Mapper;\nimport ${domain}.${system}.${package}.entity.${subEnt.vars.class};\n</#list>\n</#if>\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.Resource;\nimport java.io.Serializable;\nimport java.util.Collection;\nimport java.util.List;\n\n/**\n* [${model.name}]业务服务类\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@Service\npublic class ${class}ServiceImpl extends SuperServiceImpl<${class}Mapper, ${class}> implements BaseService<${class}> {\n\n    @Resource\n    private ${class}Mapper ${classVar}Mapper;\n    \n    <#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @Resource\n    private ${subEnt.vars.class}ServiceImpl ${subEnt.vars.classVar}Service;\n	@Resource\n    private ${subEnt.vars.class}Mapper ${subEnt.vars.classVar}Mapper;\n    </#list>\n    </#if>\n   \n    @Override\n    public BaseDao<${class}> getRepository() {\n        return ${classVar}Mapper;\n    }\n	\n	<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	public void saveOrUpdateAll(List<${class}> subList, String pkId){\n		${classVar}Mapper.deleteByRefId(pkId);\n        if(BeanUtil.isEmpty(subList)){\n            return;\n        }\n        for (${class} sub:subList) {\n		<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n			<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n			<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n			<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n			sub.set${subRelation.fkFieldFun}(pkId);\n			<#else>\n			<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n			sub.set${boRelation.fkFieldFun}(pkId);\n			</#if>\n		</#if>\n\n			if(StringUtils.isEmpty(sub.getPkId())){\n                sub.setPkId(IdGenerator.getIdStr());\n            }\n        }\n        try {\n            this.saveOrUpdateBatch(subList);\n        }catch (Exception e){\n            log.error(\"saveOrUpdateAll is error: messgae={}\", ExceptionUtil.getExceptionMessage(e));\n        }\n    }\n	</#if>\n\n		\n	<#if model.boEntityList?size gt 0 >\n	@Override\n    public void delete(Collection<Serializable> entities) {\n\n        for(Serializable id:entities){\n            //根据ID删除${model.name}\n            ${classVar}Mapper.deleteById(id);\n            <#list model.boEntityList as subEnt>\n            //根据ID删除${subEnt.name}    \n    		QueryWrapper ${subEnt.vars.classVar}Wrapper=new QueryWrapper();\n            ${subEnt.vars.classVar}Wrapper.eq(\"${subEnt.boRelation.fkField}\",id);\n            ${subEnt.vars.classVar}Mapper.delete(${subEnt.vars.classVar}Wrapper);\n    		</#list>\n        }\n    }\n	\n	/**\n     * 根据主键获取表单数据\n     * @param pk\n     * @return\n     */\n    @Override\n    public ${class} get(Serializable pk){\n        ${class} ${classVar}=this.getById(pk);\n        if(BeanUtil.isEmpty(${classVar})){\n            return new ${class}();\n        }\n		<#list model.boEntityList as subEnt>\n		List<${subEnt.vars.class}> ${subEnt.vars.classVar}List =${subEnt.vars.classVar}Mapper.getByRefId((String)pk);\n        ${classVar}.set${subEnt.vars.class}List(${subEnt.vars.classVar}List);\n		</#list>\n        return ${classVar};\n    }\n\n    @Override\n    public int insert(${class} entity) {\n        String pkId = entity.getPkId();\n        if(BeanUtil.isEmpty(pkId)) {\n            pkId=IdGenerator.getIdStr();\n            entity.setPkId(pkId);\n        }\n        int insert = getRepository().insert(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),pkId);\n		</#list>\n        return insert;\n    }\n\n    @Override\n    public int update(${class} entity) {\n        int insert =  getRepository().updateById(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),entity.getPkId());\n		</#list>\n        return insert;\n    }\n    </#if>\n	\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:40', '1', '2022-06-14 09:46:50', NULL, NULL, NULL, '{class}ServiceImpl.java', 'src/main/java/com/redxun/{system}/{package}/service', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698265154056194', '代码生成_正向Mapper数据库访问类', 'codeGenMapperW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n    \npackage ${domain}.${system}.${package}.mapper;\n\nimport ${domain}.${system}.${package}.entity.${class};\nimport org.apache.ibatis.annotations.Mapper;\nimport com.redxun.common.base.db.BaseDao;\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\nimport org.apache.ibatis.annotations.Param;\nimport java.util.List;\n</#if>\n/**\n* [${model.name}]据库访问层\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Mapper\npublic interface ${class}Mapper extends BaseDao<${class}> {\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	List<${class}> getByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	List<${class}> getByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	</#if>\n	\n	\n</#if>\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:16', '1', '2022-06-13 18:19:42', NULL, NULL, NULL, '{class}Mapper.java', 'src/main/java/com/redxun/{system}/{package}/mapper', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533698110191300609', '代码生成_正向Entity_实体层', 'codeGenEntityW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<#assign idField=convertUnderLine(model.idField)>\n\n\n/**\n* [${model.name}]实体类定义\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\npackage ${domain}.${system}.${package}.entity;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.baomidou.mybatisplus.annotation.TableName;\nimport com.fasterxml.jackson.annotation.JsonCreator;\nimport ${domain}.common.base.entity.BaseExtEntity;\nimport com.redxun.gencode.codegenhander.SubTableDef;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.experimental.Accessors;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.apache.ibatis.type.JdbcType;\nimport java.util.Date;\n\n\n@Setter\n@Getter\n@Accessors(chain = true)\n@TableName(value = \"${tableName}\")\npublic class ${class}  extends BaseExtEntity<java.lang.String> {\n\n    @JsonCreator\n    public ${class}() {\n    }\n	\n	//主键\n    @TableId(value = \"${model.idField}\",type = IdType.INPUT)\n	private String ${idField};\n\n	@Override\n    public String getPkId() {\n        return this.${idField};\n    }\n\n    @Override\n    public void setPkId(String pkId) {\n        this.${idField}=pkId;\n    }\n\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n	//外键\n    @TableField(value = \"REF_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String refId;\n\n    //父键\n    @TableField(value = \"PARENT_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String parentId;\n	</#if>\n    <#list colList as col>\n	<#if col.control==\"rx-address\">\n	${addressFun(col)}\n	<#else>\n	//${col.comment}\n    @TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n    private ${getJavaType(col)} ${col.name};\n	\n	<#if col.isSingle==0>\n	${colNameFun(col)}\n	</#if>\n	</#if>\n    </#list>\n\n	\n	<#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @TableField(exist=false)\n	@SubTableDef(tableName = \"${subEnt.vars.class}\",className = ${subEnt.vars.class}.class,type = \"onetomany\")\n	private List<${subEnt.vars.class}> ${subEnt.vars.classVar}List=new ArrayList<>();\n	</#list>	\n	</#if>\n \n}\n\n\n\n<#function colNameFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}名称\n		@TableField(value = \"${col.fieldName}_NAME\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Name;\n	<#else>\n		<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n		//${colJson.comment}名称\n		@TableField(value = \"${colJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(colJson)})\n		private ${getJavaType(colJson)} ${colJson.name};\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function addressFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign setting=extJson.setting>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}--省\n		@TableField(value = \"${col.fieldName}_PROVINCE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Province;\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}_P_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Pcode;\n		\n		<#if setting.isCity==\"true\">\n		//${col.comment}--市\n		@TableField(value = \"${col.fieldName}_CITY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}City;\n		\n		//${col.comment}--市Code\n		@TableField(value = \"${col.fieldName}_CITY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CityCode;\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n		//${col.comment}--县(区)\n		@TableField(value = \"${col.fieldName}_COUNTY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}County;\n		\n		//${col.comment}--县(区)Code\n		@TableField(value = \"${col.fieldName}_COUNTY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CountyCode;\n\n		</#if>\n		<#if setting.isAddress==\"true\">\n		\n		//${col.comment}--详细地址\n		@TableField(value = \"${col.fieldName}_ADDRESS\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Address;\n		</#if>\n	<#else>\n		<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n		//${provinceJson.comment}--省\n		@TableField(value = \"${provinceJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(provinceJson)})\n		private ${getJavaType(provinceJson)} ${provinceJson.name};\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name};\n		\n		<#if setting.isCity==\"true\">\n		\n			<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n			//${cityJson.comment}--市\n			@TableField(value = \"${cityJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityJson)})\n			private ${getJavaType(cityJson)} ${cityJson.name};\n			\n			<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n			//${cityCodeJson.comment}--市Code\n			@TableField(value = \"${cityCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityCodeJson)})\n			private ${getJavaType(cityCodeJson)} ${cityCodeJson.name};\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n			<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n			//${countyJson.comment}--县(区)\n			@TableField(value = \"${countyJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyJson)})\n			private ${getJavaType(countyJson)} ${countyJson.name};\n			\n			<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n			//${countyCodeJson.comment}--县(区)Code\n			@TableField(value = \"${countyCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyCodeJson)})\n			private ${getJavaType(countyCodeJson)} ${countyCodeJson.name};\n		</#if>\n		<#if setting.isAddress==\"true\">\n		<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n			//${addressJson.comment}--详细地址\n			@TableField(value = \"${addressJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(addressJson)})\n			private ${getJavaType(addressJson)} ${addressJson.name};\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJavaType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n<#if  dbtype==\"number\"  >\n    <#if col.decimalLength==0>\n         <#if col.length gt 10 >\n            long\n         <#else>\n            int\n         </#if>\n    <#else>\n         double\n    </#if>\n<#elseif (dbtype==\"date\")>\n	Date\n<#else>\n	String\n</#if>\n</#assign>\n <#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:39', '1', '2022-06-07 09:35:25', NULL, NULL, NULL, '{class}.java', 'src/main/java/com/redxun/{system}/{package}/entity', 'NO', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697966238593025', '代码生成_正向实体转json映射', 'codeGenfileJsonW', '${jsonFile}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:05', NULL, '2022-06-06 14:31:05', NULL, NULL, NULL, '{classVar}.json', 'src/main/resources/entityJson/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697732414533634', '代码生成_正向Data.js_编辑JS', 'codeGenDatajsW', 'export default {\n    data(){\n        return {\n            //表单数据\n            data:${vueJs.data},\n            //从表单数据\n            initData:${vueJs.initData},\n            //公式\n            formulas:${vueJs.formulas},\n            //校验函数\n            rules:${vueJs.rules},\n            //区域计算\n            calcAreas:${vueJs.calcAreas},\n            //校验规则\n            validRules:${vueJs.validRules},\n            //自定义查询\n            customquery:${vueJs.customquery},\n            //元数据\n            metadata:${vueJs.metadata},\n            listSearchType:\"${vueJs.listSearchType}\",\n            treeJson:${vueJs.treeJson},\n            boRelations:${boRelationsStr}\n        }\n    }\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:30:09', '1', '2022-06-13 15:13:21', NULL, NULL, NULL, '{class}Data.js', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `COMPANY_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`) VALUES ('1533697561588920321', '代码生成_正向Apijs代码', 'codeGenApijsW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign developer=vars.developer>\n<#assign system=vars.system>\n<#assign name=model.name>\n<#assign domain=vars.domain>\nimport rxAjax from \'@/assets/js/ajax.js\';\n\n/*\n 概要说明:${name} api接口\n 开发人员:${developer}\n*/\nexport const ${class}Api = {};\n\n${class}Api.baseUrl= \'/api-${system}/${system}/${package}/${classVar}\';\n${class}Api.exportUrl= ${class}Api.baseUrl + \'/export\';\n\n//查询列表\n${class}Api.query=function (parameter) {\n  var url= ${class}Api.baseUrl + \'/query\';\n  return rxAjax.postJson(url,parameter).then (res => {\n    return res.result\n  })\n}\n\n\n/**\n * 获取表单数据\n * @param pkId\n * @returns {*}\n */\n${class}Api.getById =function(pkId) {\n    var url= ${class}Api.baseUrl + \'/getById?pkId=\' + pkId;\n    return rxAjax.get(url);\n}\n\n/**\n * 保存表单数据\n * @param formdata\n * @returns {*}\n */\n${class}Api.saveData =function(formdata) {\n    var url= ${class}Api.baseUrl + \'/saveData\';\n    return rxAjax.postJson(url,formdata);\n}\n\n\n\n//删除数据\n${class}Api.del =function(parameter) {\n  var url= ${class}Api.baseUrl + \'/del\';\n  return rxAjax.postUrl(url,parameter);\n}\n\nexport  default ${class}Api;\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:29:28', NULL, '2022-06-06 14:29:28', NULL, NULL, NULL, '{classVar}.js', 'src/api/{system}/{package}', 'YES', 'mainSub', 'genCode');

-- 2022-06-14 jpaas-form szw  代码生成器模板修改：支持主从分离模式---end

-- 2022-06-16 jpaas-form gjh  异步下载
CREATE TABLE jpaas_form.FORM_EXCEL_GEN_TASK
(
    ID_                  VARCHAR(64) NOT NULL COMMENT '主键',
    LIST_ID_             VARCHAR(64) COMMENT '列表主键',
    LIST_NAME_           VARCHAR(64) COMMENT '列表名称',
    FILE_ID_             VARCHAR(64) COMMENT '文件ID',
    FILE_NAME_           VARCHAR(64) COMMENT '文件名称',
    GEN_STATUS_          VARCHAR(64) COMMENT '生成状态(0为失败、1为成功、2为正在生成)',
    REMARK_              VARCHAR(255) COMMENT '备注',
    TENANT_ID_           VARCHAR(64) COMMENT '租户ID',
    CREATE_DEP_ID_       VARCHAR(64) COMMENT '创建部门ID',
    CREATE_BY_           VARCHAR(64) COMMENT '创建人ID',
    CREATE_BY_NAME_      VARCHAR(64) COMMENT '创建人名称',
    CREATE_TIME_         DATETIME COMMENT '创建时间',
    UPDATE_BY_           VARCHAR(64) COMMENT '更新人ID',
    UPDATE_TIME_         DATETIME COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_form.FORM_EXCEL_GEN_TASK COMMENT 'Excel生成任务';

-- jpaas-bpm hj 2022-06-15 增加跟踪表。
CREATE TABLE jpaas_bpm.BPM_INST_TRACKED
(
    ID_                  VARCHAR(64) NOT NULL COMMENT '主键',
    INST_ID_             VARCHAR(64) COMMENT '流程实例',
    CUR_NODE_            VARCHAR(64) COMMENT '当前节点',
    TENANT_ID_           VARCHAR(64) COMMENT '租用用户Id',
    CREATE_DEP_ID_       VARCHAR(64) COMMENT '创建部门ID',
    CREATE_BY_           VARCHAR(64) COMMENT '创建人ID',
    CREATE_TIME_         DATETIME COMMENT '创建时间',
    UPDATE_BY_           VARCHAR(64) COMMENT '更新人ID',
    UPDATE_TIME_         DATETIME COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_bpm.BPM_INST_TRACKED COMMENT '流程实例跟踪';

CREATE TABLE jpaas_form.FORM_DOWNLOAD_RECORD
(
    ID_                  VARCHAR(64) NOT NULL COMMENT '主键',
    GEN_RECORD_          VARCHAR(64) COMMENT '生成记录ID',
    LIST_ID_             VARCHAR(64) COMMENT '列表ID',
    LIST_NAME_           VARCHAR(64) COMMENT '列表名称',
    TENANT_ID_           VARCHAR(64) COMMENT '租户ID',
    CREATE_DEP_ID_       VARCHAR(64) COMMENT '创建部门ID',
    CREATE_BY_           VARCHAR(64) COMMENT '创建人ID',
    CREATE_BY_NAME_      VARCHAR(64) COMMENT '创建人名称',
    CREATE_TIME_         DATETIME COMMENT '创建时间',
    UPDATE_BY_           VARCHAR(64) COMMENT '更新人ID',
    UPDATE_TIME_         DATETIME COMMENT '更新时间',
    PRIMARY KEY (ID_)
);
ALTER TABLE jpaas_form.FORM_DOWNLOAD_RECORD COMMENT 'Excel下载记录(异步)';

INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `COMPANY_ID_`, `SHARE_`, `INST_CONFIG_`) VALUES ('1537246146611445761', '1257928508099674114', '异步下载', '{\"type\":\"customIcon\",\"icon\":\"icondaoru2\"}', 'icondaoru2', NULL, '0', '0.1537246146611445761.', 12, 'URL', 'FormExcelGenTaskList', 'C', 'modules/form/core/FormExcelGenTaskList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-06-16 09:30:17', '1', '2022-06-16 09:31:22', NULL, 'N', NULL);

-- 可选
-- ALTER TABLE jpaas_form.form_save_export DROP MAX_COUNT_;

-- 可选 删除页面定制首页设置
-- ALTER TABLE jpaas_form.FORM_CUSTOM DROP HOME_PAGE_;

-- jpaas-system hj 2022-06-20 分类授权表结构变化。
ALTER TABLE jpaas_system.sys_auth_setting ADD COLUMN RIGHT_JSON_ text COMMENT '权限设置';
UPDATE jpaas_system.sys_auth_setting a set RIGHT_JSON_=(select RIGHT_JSON_ from jpaas_system.sys_auth_rights b where a.ID_=b.SETTING_ID_);
ALTER TABLE jpaas_system.sys_auth_rights DROP RIGHT_JSON_;

-- jpaas_bpm zyg 2022-06-23 工作交接 增加备注字段。
ALTER TABLE jpaas_bpm.bpm_deliver    ADD COLUMN `COMMENT_`  varchar(200) NULL COMMENT '备注';


-- jpaas-form gjh 2022-06-27 常用应用调整。
ALTER TABLE jpaas_portal.ins_app_collect    ADD COLUMN `APP_`  varchar(64) NULL COMMENT '内部应用';
ALTER TABLE jpaas_portal.ins_app_collect    ADD COLUMN `APP_TYPE_`  varchar(64) NULL COMMENT '应用类型(default、custom)';
UPDATE `jpaas_portal`.`ins_column_def` SET `NAME_` = '常用应用', `KEY_` = 'application', `IS_DEFAULT_` = '0', `TEMPLET_` = '<div class=\"gridLayoutClass\">\n<div class=\"headPClass\">常用应用<a-button type=\"primary\" icon=\"plus\" style=\"right:5px;top:10px; position: fixed;\" @click=\"addCommonApp\">添加应用</a-button></div>\n<div class=\"bodyDivClass\">\n<ul class=\"application_ul\" v-if=\"data.length !=0\">\n        <li v-for=\"obj in data\" @click=\"handAppClick(obj)\">\n            <my-icon v-if=\"obj.appType==\'custom\'\" type=\"icontrash\" class=\"application_delete\" @click.stop=\"handAppDelete(obj)\"></my-icon>\n            <div class=\"application_iconfont\" :style=\"{\'background\':JSON.parse(obj.icon).bgColor}\">\n                <a-icon v-if=\"!obj.icon.includes(\'type\')\" :type=\"obj.icon\" />\n                <my-icon v-else-if=\"[\'customIcon\',\'userCustomIcon\'].includes(JSON.parse(obj.icon).type)\" :type=\"JSON.parse(obj.icon).icon\"></my-icon>\n                <a-icon v-else=\"JSON.parse(obj.icon).type\" :type=\"JSON.parse(obj.icon).icon\"></a-icon>\n            </div>\n            <span>{{obj.name}}</span>\n        </li>\n      </ul>\n      <a-empty v-else/>\n</div>\n</div>', `SET_TING_` = '{\"dataUrl\":\"\",\"function\":\"portalScript.getMyAppList()\",\"newType\":\"\",\"tabgroups\":\"\",\"listCount\":6,\"newDIc\":\"\",\"funcType\":\"\",\"sqlName\":\"\",\"service\":\"\",\"calendarMode\":\"\"}', `IS_PUBLIC_` = '0', `TYPE_` = '1230771994887495681', `ICON_` = NULL, `IS_MOBILE_` = '0', `TENANT_ID_` = '0', `CREATE_DEP_ID_` = '1', `CREATE_BY_` = '1', `CREATE_TIME_` = NULL, `UPDATE_BY_` = '1', `UPDATE_TIME_` = '2022-06-29 17:04:26', `APP_ID_` = NULL, `COMPANY_ID_` = '0' WHERE `COL_ID_` = '1259742027670732801';

-- jpaas_form gjh 2022-06-28 页面定制新增参数配置
ALTER TABLE jpaas_form.form_custom    ADD COLUMN `PARAMS_`  varchar(500) NULL COMMENT '参数配置';

-- 2022-06-29 jpaas-system szw 新增 飞书集成功能菜单
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`) VALUES ('1541347101737357313', '1208980200670081026', '飞书应用', '{\"type\":\"customIcon\",\"icon\":\"icondingding01\"}', 'icondingding01', NULL, '1371092826967781378', '0.1371092826967781378.1541347101737357313.', 1, 'URL', 'OsFsAgentList', 'C', 'modules/user/org/OsFsAgentList.vue', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-06-27 17:06:01', '1', '2022-06-27 18:34:13');

-- 2022-06-29 jpaas_user szw 新增第三方登录功能绑定用户表
CREATE TABLE jpaas_user.os_user_platform  (
  ID_ varchar(64) NOT NULL COMMENT '主键',
  USER_ID_ varchar(64) DEFAULT NULL COMMENT '用户ID',
  PLATFORM_TYPE_ varchar(64) DEFAULT NULL COMMENT '第三方平台类型：1微信，2企业微信，3钉钉，4飞书',
  OPEN_ID_ varchar(64) DEFAULT NULL COMMENT '第三方平台唯一id',
  TENANT_ID_ varchar(64) DEFAULT NULL COMMENT '租户Id',
  CREATE_DEP_ID_ varchar(64) DEFAULT NULL COMMENT '创建部门ID',
  CREATE_BY_ varchar(64) DEFAULT NULL COMMENT '创建人ID',
  CREATE_TIME_ datetime(0) NULL DEFAULT NULL COMMENT '创建时间',
  UPDATE_BY_ varchar(64) DEFAULT NULL COMMENT '更新人ID',
  UPDATE_TIME_ datetime(0) NULL DEFAULT NULL COMMENT '	更新时间',
  COMPANY_ID_ varchar(64) DEFAULT NULL COMMENT '所属公司ID',
  PRIMARY KEY (ID_) USING BTREE
) ENGINE=InnoDB COMMENT='第三方平台登陆信息绑定表';

-- 2022-06-29 jpaas_user szw 新增飞书配置表
CREATE TABLE jpaas_user.os_fs_agent  (
  ID_ varchar(64) NOT NULL COMMENT '主键',
  NAME_ varchar(255) DEFAULT NULL COMMENT '应用名称',
  AGENT_ID_ varchar(64) DEFAULT NULL COMMENT '应用ID',
  SECRET_ varchar(255) DEFAULT NULL COMMENT '密钥',
  PC_HOMEPAGE_ varchar(255) DEFAULT NULL COMMENT 'PC主页',
  ADMIN_PAGE_ varchar(255) DEFAULT NULL COMMENT '后台主页',
  H5_HOMEPAGE_ varchar(255) DEFAULT NULL COMMENT 'H5主页',
  IS_DEFAULT_ int(11) NULL DEFAULT NULL COMMENT '是否默认，1是，0否',
  TENANT_ID_ varchar(64) DEFAULT NULL COMMENT '租户Id',
  CREATE_DEP_ID_ varchar(64) DEFAULT NULL COMMENT '创建部门ID',
  CREATE_BY_ varchar(64) DEFAULT NULL COMMENT '创建人ID',
  CREATE_TIME_ datetime(0) NULL DEFAULT NULL COMMENT '创建时间',
  UPDATE_BY_ varchar(64) DEFAULT NULL COMMENT '更新人ID',
  UPDATE_TIME_ datetime(0) NULL DEFAULT NULL COMMENT '	更新时间',
  APP_ID_ varchar(64) DEFAULT NULL COMMENT '应用ID',
  COMPANY_ID_ varchar(64) DEFAULT NULL COMMENT '所属公司ID',
  IS_PUSH_ varchar(64) DEFAULT NULL,
  PRIMARY KEY (ID_) USING BTREE
) ENGINE=InnoDB COMMENT='飞书集成配置表';


-- 2022-06-30 jpaas-form szw  代码生成器模板修改：调整后端模板---begin
delete from `jpaas_form`.`form_template` where ID_ in('1533698110191300609','1533698265154056194','1533698365993512961','1533698526207537154','1533698647930433538','1533698962918469634');

INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698110191300609', '代码生成_正向Entity_实体层', 'codeGenEntityW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<#assign idField=convertUnderLine(model.idField)>\n\n\n/**\n* [${model.name}]实体类定义\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\npackage ${domain}.${system}.${package}.entity;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.baomidou.mybatisplus.annotation.TableName;\nimport com.fasterxml.jackson.annotation.JsonCreator;\nimport com.redxun.common.base.entity.BaseExtEntity;\nimport com.redxun.gencode.codegenhander.SubTableDef;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.experimental.Accessors;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.apache.ibatis.type.JdbcType;\nimport java.util.Date;\n\n\n@Setter\n@Getter\n@Accessors(chain = true)\n@TableName(value = \"${tableName}\")\npublic class ${class}  extends BaseExtEntity<java.lang.String> {\n\n    @JsonCreator\n    public ${class}() {\n    }\n	\n	//主键\n    @TableId(value = \"${model.idField}\",type = IdType.INPUT)\n	private String ${idField};\n\n	@Override\n    public String getPkId() {\n        return this.${idField};\n    }\n\n    @Override\n    public void setPkId(String pkId) {\n        this.${idField}=pkId;\n    }\n\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n	//外键\n    @TableField(value = \"REF_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String refId;\n\n    //父键\n    @TableField(value = \"PARENT_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String parentId;\n	</#if>\n    <#list colList as col>\n	<#if col.control==\"rx-address\">\n	${addressFun(col)}\n	<#else>\n	//${col.comment}\n    @TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n    private ${getJavaType(col)} ${col.name};\n	\n	<#if col.isSingle==0>\n	${colNameFun(col)}\n	</#if>\n	</#if>\n    </#list>\n\n	\n	<#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @TableField(exist=false)\n	@SubTableDef(tableName = \"${subEnt.vars.class}\",className = ${subEnt.vars.class}.class,type = \"onetomany\")\n	private List<${subEnt.vars.class}> ${subEnt.vars.classVar}List=new ArrayList<>();\n	</#list>	\n	</#if>\n \n}\n\n\n\n<#function colNameFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}名称\n		@TableField(value = \"${col.fieldName}_NAME\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Name;\n	<#else>\n		<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n		//${colJson.comment}名称\n		@TableField(value = \"${colJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(colJson)})\n		private ${getJavaType(colJson)} ${colJson.name};\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function addressFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign setting=extJson.setting>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}--省\n		@TableField(value = \"${col.fieldName}_PROVINCE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Province;\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}_P_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Pcode;\n		\n		<#if setting.isCity==\"true\">\n		//${col.comment}--市\n		@TableField(value = \"${col.fieldName}_CITY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}City;\n		\n		//${col.comment}--市Code\n		@TableField(value = \"${col.fieldName}_CITY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CityCode;\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n		//${col.comment}--县(区)\n		@TableField(value = \"${col.fieldName}_COUNTY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}County;\n		\n		//${col.comment}--县(区)Code\n		@TableField(value = \"${col.fieldName}_COUNTY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CountyCode;\n\n		</#if>\n		<#if setting.isAddress==\"true\">\n		\n		//${col.comment}--详细地址\n		@TableField(value = \"${col.fieldName}_ADDRESS\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Address;\n		</#if>\n	<#else>\n		<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n		//${provinceJson.comment}--省\n		@TableField(value = \"${provinceJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(provinceJson)})\n		private ${getJavaType(provinceJson)} ${provinceJson.name};\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name};\n		\n		<#if setting.isCity==\"true\">\n		\n			<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n			//${cityJson.comment}--市\n			@TableField(value = \"${cityJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityJson)})\n			private ${getJavaType(cityJson)} ${cityJson.name};\n			\n			<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n			//${cityCodeJson.comment}--市Code\n			@TableField(value = \"${cityCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityCodeJson)})\n			private ${getJavaType(cityCodeJson)} ${cityCodeJson.name};\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n			<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n			//${countyJson.comment}--县(区)\n			@TableField(value = \"${countyJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyJson)})\n			private ${getJavaType(countyJson)} ${countyJson.name};\n			\n			<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n			//${countyCodeJson.comment}--县(区)Code\n			@TableField(value = \"${countyCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyCodeJson)})\n			private ${getJavaType(countyCodeJson)} ${countyCodeJson.name};\n		</#if>\n		<#if setting.isAddress==\"true\">\n		<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n			//${addressJson.comment}--详细地址\n			@TableField(value = \"${addressJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(addressJson)})\n			private ${getJavaType(addressJson)} ${addressJson.name};\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJavaType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n<#if  dbtype==\"number\"  >\n    <#if col.decimalLength==0>\n         <#if col.length gt 10 >\n            long\n         <#else>\n            int\n         </#if>\n    <#else>\n         double\n    </#if>\n<#elseif (dbtype==\"date\")>\n	Date\n<#else>\n	String\n</#if>\n</#assign>\n <#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:39', '1', '2022-06-29 18:11:14', NULL, NULL, '{class}.java', 'src/main/java/com/{rootSystem}/{system}/{package}/entity', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698265154056194', '代码生成_正向Mapper数据库访问类', 'codeGenMapperW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n    \npackage ${domain}.${system}.${package}.mapper;\n\nimport ${domain}.${system}.${package}.entity.${class};\nimport org.apache.ibatis.annotations.Mapper;\nimport com.redxun.common.base.db.BaseDao;\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\nimport org.apache.ibatis.annotations.Param;\nimport java.util.List;\n</#if>\n/**\n* [${model.name}]据库访问层\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Mapper\npublic interface ${class}Mapper extends BaseDao<${class}> {\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	List<${class}> getByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	List<${class}> getByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	</#if>\n	\n	\n</#if>\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:16', '1', '2022-06-29 18:08:49', NULL, NULL, '{class}Mapper.java', 'src/main/java/com/{rootSystem}/{system}/{package}/mapper', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698365993512961', '代码生成_正向ServiceImpl服务层', 'codeGenServiceImpl', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign domain=vars.domain>\n\npackage ${domain}.${system}.${package}.service;\n\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.redxun.common.base.db.BaseDao;\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.common.service.impl.SuperServiceImpl;\nimport com.redxun.common.tool.BeanUtil;\nimport com.redxun.common.tool.StringUtils;\nimport com.redxun.common.utils.ExceptionUtil;\nimport com.redxun.common.tool.IdGenerator;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.mapper.${class}Mapper;\n<#if model.boEntityList?size gt 0 >\n<#list model.boEntityList as subEnt>\nimport ${domain}.${system}.${package}.service.${subEnt.vars.class}ServiceImpl;\nimport ${domain}.${system}.${package}.mapper.${subEnt.vars.class}Mapper;\nimport ${domain}.${system}.${package}.entity.${subEnt.vars.class};\n</#list>\n</#if>\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.Resource;\nimport java.io.Serializable;\nimport java.util.Collection;\nimport java.util.List;\n\n/**\n* [${model.name}]业务服务类\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@Service\npublic class ${class}ServiceImpl extends SuperServiceImpl<${class}Mapper, ${class}> implements BaseService<${class}> {\n\n    @Resource\n    private ${class}Mapper ${classVar}Mapper;\n    \n    <#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @Resource\n    private ${subEnt.vars.class}ServiceImpl ${subEnt.vars.classVar}Service;\n	@Resource\n    private ${subEnt.vars.class}Mapper ${subEnt.vars.classVar}Mapper;\n    </#list>\n    </#if>\n   \n    @Override\n    public BaseDao<${class}> getRepository() {\n        return ${classVar}Mapper;\n    }\n	\n	<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	public void saveOrUpdateAll(List<${class}> subList, String pkId){\n		${classVar}Mapper.deleteByRefId(pkId);\n        if(BeanUtil.isEmpty(subList)){\n            return;\n        }\n        for (${class} sub:subList) {\n		<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n			<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n			<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n			<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n			sub.set${subRelation.fkFieldFun}(pkId);\n			<#else>\n			<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n			sub.set${boRelation.fkFieldFun}(pkId);\n			</#if>\n		</#if>\n\n			if(StringUtils.isEmpty(sub.getPkId())){\n                sub.setPkId(IdGenerator.getIdStr());\n            }\n        }\n        try {\n            this.saveOrUpdateBatch(subList);\n        }catch (Exception e){\n            log.error(\"saveOrUpdateAll is error: messgae={}\", ExceptionUtil.getExceptionMessage(e));\n        }\n    }\n	</#if>\n\n		\n	<#if model.boEntityList?size gt 0 >\n	@Override\n    public void delete(Collection<Serializable> entities) {\n\n        for(Serializable id:entities){\n            //根据ID删除${model.name}\n            ${classVar}Mapper.deleteById(id);\n            <#list model.boEntityList as subEnt>\n            //根据ID删除${subEnt.name}    \n    		QueryWrapper ${subEnt.vars.classVar}Wrapper=new QueryWrapper();\n            ${subEnt.vars.classVar}Wrapper.eq(\"${subEnt.boRelation.fkField}\",id);\n            ${subEnt.vars.classVar}Mapper.delete(${subEnt.vars.classVar}Wrapper);\n    		</#list>\n        }\n    }\n	\n	/**\n     * 根据主键获取表单数据\n     * @param pk\n     * @return\n     */\n    @Override\n    public ${class} get(Serializable pk){\n        ${class} ${classVar}=this.getById(pk);\n        if(BeanUtil.isEmpty(${classVar})){\n            return new ${class}();\n        }\n		<#list model.boEntityList as subEnt>\n		List<${subEnt.vars.class}> ${subEnt.vars.classVar}List =${subEnt.vars.classVar}Mapper.getByRefId((String)pk);\n        ${classVar}.set${subEnt.vars.class}List(${subEnt.vars.classVar}List);\n		</#list>\n        return ${classVar};\n    }\n\n    @Override\n    public int insert(${class} entity) {\n        String pkId = entity.getPkId();\n        if(BeanUtil.isEmpty(pkId)) {\n            pkId=IdGenerator.getIdStr();\n            entity.setPkId(pkId);\n        }\n        int insert = getRepository().insert(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),pkId);\n		</#list>\n        return insert;\n    }\n\n    @Override\n    public int update(${class} entity) {\n        int insert =  getRepository().updateById(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),entity.getPkId());\n		</#list>\n        return insert;\n    }\n    </#if>\n	\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:40', '1', '2022-06-29 18:08:41', NULL, NULL, '{class}ServiceImpl.java', 'src/main/java/com/{rootSystem}/{system}/{package}/service', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698526207537154', '代码生成_正向Controller控制层', 'codeGenControllerW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign entAlias=model.vars.entAlias>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n\npackage ${domain}.${system}.${package}.controller;\n\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.gencode.controller.CodeGenBaseController;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\nimport io.swagger.annotations.Api;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.*;\nimport com.redxun.common.annotation.ClassDefine;\n\n\n/**\n* [${model.name}] 控制器代码\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@RestController\n@RequestMapping(\"/${system}/${package}/${classVar}\")\n@Api(tags = \"${comment}\")\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\n\n	@Autowired\n	${class}ServiceImpl ${classVar}Service;\n\n\n\n	@Override\n	public BaseService getBaseService() {\n		return ${classVar}Service;\n	}\n\n	@Override\n	public String getComment() {\n		return \"${comment}\";\n	}\n\n	@Override\n	public String getFormAlias() {\n		return \"${entAlias}\";\n	}\n\n	@Override\n	public String getclassAlias() {\n		return \"${classVar}\";\n	}\n	\n	@Override\n	public String getPackage(){\n		return \"${package}\";\n	}\n\n	@Override\n	public String getCreateType() {\n		return \"${model.genMode}\";\n	}\n\n	@Override\n	public ${class} getBaseEntity(){\n		return new ${class}();\n	}\n\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:18', '1', '2022-06-29 18:08:30', NULL, NULL, '{class}Controller.java', 'src/main/java/com/{rootSystem}/{system}/{package}/controller', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698647930433538', '代码生成_正向Mapping文件', 'codeGenMappingW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\n<mapper namespace=\"${domain}.${system}.${package}.mapper.${class}Mapper\">\n\n    <resultMap id=\"${class}\" type=\"${type}\">\n            <#assign idField=convertUnderLine(model.idField)>\n            <id property=\"${idField}\" column=\"${model.idField}\" jdbcType=\"VARCHAR\"/>\n		        <#list colList as col>\n				${columnFun(col model.genMode)}\n		        </#list>\n		      <#if model.genMode==\"form\" || model.genMode==\"create\" >\n			  <result property=\"refId\" column=\"REF_ID_\" jdbcType=\"VARCHAR\"/>\n			  <result property=\"parentId\" column=\"PARENT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"tenantId\" column=\"TENANT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createBy\" column=\"CREATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createTime\" column=\"CREATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"updateBy\" column=\"UPDATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"updateTime\" column=\"UPDATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"createDepId\" column=\"CREATE_DEP_ID_\" jdbcType=\"VARCHAR\"/>\n		      </#if>\n    </resultMap>\n\n\n    <select id=\"query\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n        select ${model.idField},<#list colList as col>${selectColumnFun(col model.genMode)}<#if col_has_next>,</#if></#list><#if model.genMode==\"form\" || model.genMode==\"create\" >,REF_ID_,PARENT_ID_,TENANT_ID_,CREATE_BY_,CREATE_TIME_,UPDATE_BY_,UPDATE_TIME_,CREATE_DEP_ID_</#if> from ${tableName}\n        <#noparse>\n        <where>\n            <if test=\"@rx.Ognl@isNotEmpty(w.whereSql)\">\n                ${w.whereSql}\n            </if>\n        </where>\n        <if test=\"@rx.Ognl@isNotEmpty(w.orderBySql)\">\n            ORDER BY ${w.orderBySql}\n        </if>\n        <if test=\"@rx.Ognl@isEmpty(w.orderBySql)\"></#noparse>\n            ORDER BY  ${model.idField} DESC\n        </if>\n    </select>\n	\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM ${tableName} WHERE ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</delete>\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM ${tableName} WHERE ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</delete>\n	</#if>\n</#if>\n	\n\n</mapper>\n\n\n<#function selectColumnFun col genMode>\n<#assign name=col.fieldName>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n			${name}_PROVINCE,${name}_P_CODE\n			<#if extJson.isCity==\"true\">\n			,${name}_CITY,${name}_CITY_CODE\n			</#if>\n			<#if extJson.isCounty==\"true\">\n			,${name}_COUNTY,${name}_COUNTY_CODE\n			</#if>\n			<#if extJson.isAddress==\"true\">\n			,${name}_ADDRESS\n			</#if>\n		<#elseif col.isSingle==0>\n			${name}_NAME,${name}\n		<#else>\n			${name}\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n			\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			${provinceJson.fieldName},${name}\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				,${cityJson.fieldName}\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				,${cityCodeJson.fieldName}\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				,${countyJson.fieldName}\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				,${countyCodeJson.fieldName}\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				,${addressJson.fieldName}\n			</#if>\n		<#elseif col.isSingle==0>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			${name},${colJson.fieldName}\n		<#else>\n			${name}\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function columnFun col genMode>\n<#assign colName=convertUnderLine(col.fieldName)>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n			<#assign setting=extJson.setting>\n			<result property=\"${colName}Province\" column=\"${col.fieldName}_PROVINCE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Pcode\" column=\"${col.fieldName}_P_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<result property=\"${colName}City\" column=\"${col.fieldName}_CITY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CityCode\" column=\"${col.fieldName}_CITY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<result property=\"${colName}County\" column=\"${col.fieldName}_COUNTY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CountyCode\" column=\"${col.fieldName}_COUNTY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<result property=\"${colName}Address\" column=\"${col.fieldName}_ADDRESS\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Name\" column=\"${col.fieldName}_NAME\" jdbcType=\"${getJdbcType(col)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			<result property=\"${convertUnderLine(provinceJson.fieldName)}\" column=\"${provinceJson.fieldName}\" jdbcType=\"${getJdbcType(provinceJson)}\"/>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				<result property=\"${convertUnderLine(cityJson.fieldName)}\" column=\"${cityJson.fieldName}\" jdbcType=\"${getJdbcType(cityJson)}\"/>\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				<result property=\"${convertUnderLine(cityCodeJson.fieldName)}\" column=\"${cityCodeJson.fieldName}\" jdbcType=\"${getJdbcType(cityCodeJson)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				<result property=\"${convertUnderLine(countyJson.fieldName)}\" column=\"${countyJson.fieldName}\" jdbcType=\"${getJdbcType(countyJson)}\"/>\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				<result property=\"${convertUnderLine(countyCodeJson.fieldName)}\" column=\"${countyCodeJson.fieldName}\" jdbcType=\"${getJdbcType(countyCodeJson)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				<result property=\"${convertUnderLine(addressJson.fieldName)}\" column=\"${addressJson.fieldName}\" jdbcType=\"${getJdbcType(addressJson)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			<result property=\"${convertUnderLine(colJson.fieldName)}\" column=\"${colJson.fieldName}\" jdbcType=\"${getJdbcType(colJson)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:47', '1', '2022-06-30 10:27:04', NULL, NULL, '{class}Mapper.xml', 'src/main/resources/mapper/{rootSystem}/{system}/{package}', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698962918469634', '代码生成_实体编辑页面', 'bodefEntityVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainClassId=vars.mainClassId>\n<#assign templateType=vars.templateType>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign subComList=model.boEntityList>\n<template>\n    <rx-dialog @handOk=\"handleSubmit\" @cancel=\"cancel\" order=\"top\" btnalign=\"right\" :showok=\"!readonly\">\n        <rx-layout>\n            <div slot=\"center\">\n                <table class=\"table-form four-column\" style=\"width:100%;\" ctltype=\"rx-four-table\" id=\"${mainClassId}\"\n                       borders=\"noborder\" data-sort=\"sortDisabled\">\n                    <colgroup>\n						${colgroupRowFun(templateType)}\n                    </colgroup>\n                    <caption>\n                        ${model.name}\n                    </caption>\n                    <tbody>\n                        ${firstRowFun(commonList templateType)}\n                        ${otherRowFun(commonList templateType)}\n                        <#if (subComList?? && subComList?size>0)>\n                        ${subRowFun(subComList templateType)}\n                        </#if>\n                    </tbody>\n                </table>\n            </div>\n        </rx-layout>\n    </rx-dialog>\n</template>\n\n<script>\n    import ${class}Api from \"@/api/${system}/${package}/${classVar}.js\";\n    import ${class}Data from \"@/views/modules/${system}/${package}/${class}Data.js\";\n    import formJs from \"@/views/modules/form/core/js-comps/form.js\";\n	import {RxDialog} from \'jpaas-common-lib\';\n<#if mainSubType==\'mainAloneSub\'>\n	<#list model.boEntityList as subEnt>\n	import ${subEnt.vars.class}Edit from \'./${subEnt.vars.class}Edit\'\n	</#list>\n</#if>\n    export default{\n        mixins: [formJs,${class}Data],\n        components:{\n        	RxDialog\n		},\n        props:[\"pkId\",\"layerid\",\"destroy\",\"readonly\",\"refKey\",\"refKeyName\"],\n        data(){\n            return {\n				<#if mainSubType==\'mainAloneSub\'>\n				components:{\n					<#list model.boEntityList as subEnt>\n					\"${subEnt.vars.classVar}\":${subEnt.vars.class}Edit,\n					</#list>\n				},\n				</#if>\n			}\n        },\n        created() {\n            //加载表单数据\n            this.loadData(${class}Api);\n        },\n        mounted(){\n            this.onload();\n        },\n        methods:{\n            onload(){\n\n            },\n            async _beforeSubmit(){\n\n            },\n            _afterSubmit(result,formJson){\n\n            },\n            enter(entName, field){\n\n            },\n            handleSubmit(vm){\n                this.handSubmit(${class}Api,vm);\n            }\n        },\n        watch:{\n        }\n    }\n</script>\n\n<#function subRowFun subComList templateType>\n    <#assign rtn>\n	<#assign colindexNum=templateType?number>\n        <#list subComList as sub>\n            <#assign subColList=sub.boAttrList>\n            <#assign subVars=sub.vars>\n            <#assign colIndex=sub?index>\n                <tr class=\"active2\" <#if mainSubType==\'mainAloneSub\'>v-if=\"readonly\"</#if>>\n                    <td colspan=\"<#if colindexNum==4>8<#else>4</#if>\" rowspan=\"1\">\n                        <div class=\"rx-table-body  \" ctltype=\"rx-table\" type=\"onetomany\" id=\"${sub.id}\"\n                             tablename=\"${subVars.classVar}\" style=\"width:100%\" tabname=\"${subVars.classVar}\"\n                             tabletype=\"default\" req=\"no\">\n                            <div class=\"table-header-tool\">\n                                <div class=\"title\">\n                                    <div>\n                                        ${sub.name}\n                                    </div>\n                                </div>\n								<#if mainSubType==\'mainAloneSub\'>\n								<a-button-group v-if=\"readonly\">\n                                    <a-button\n                                            v-on:click=\"addSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n									<a-button\n                                            v-on:click=\"editSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        编辑\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								<#else>\n								<a-button-group v-if=\"!getReadonly()\">\n                                    <a-button\n                                            v-on:click=\"add(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								</#if>\n                            </div>\n                            <div class=\"rx-table-box\">\n                                <table class=\"rx-table\">\n                                    <colgroup>\n                                        <col style=\"width: 60px;\">\n                                        <col style=\"width: 60px;\">\n                                        <#list subColList as col>\n                                        <col style=\"width: 100px;\">\n                                        </#list>\n                                    </colgroup>\n                                    <thead>\n                                        <tr class=\"firstRow\">\n                                            <th>#</th>\n                                            <th>序号</th>\n                                            <#list subColList as col>\n                                            <th v-bind:class=\"{required:required.${subVars.classVar}[\'fields\'].${col.name}}\">${col.comment}</th>\n                                            </#list>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr v-if=\"\'item\'\" v-for=\"(item,index) in data.sub__${subVars.classVar}\"\n                                            v-tableselect=\"{item:item,selmode:\'multi\',data:data.sub__${subVars.classVar}}\"\n                                            :key=\"item.index_\" :class=\"{active:item.selected}\">\n                                            <td><a-checkbox :checked=\"item.selected\"></a-checkbox></td>\n                                            <td><rx-serial :serial=\"index+1\"></rx-serial></td>\n                                            <#list subColList as col>\n                                            <td>\n                                                <${col.control} \n													type=\"onetomany\"\n													id=\"${col.id}\" \n													:readonly=\"readonly\"\n													v-model=\"item.${col.name}\" \n													:data=\"data\" \n													:row=\"item\"\n													:valid=\"validFunc(\'${subVars.classVar}\',\'${col.name}\',item)\"\n													name=\"${col.name}\"\n													permission=\"w\" \n													${subColOtherFun(col)} ></${col.control}>\n                                            </td>\n                                            </#list>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                                <div class=\"tableEmpty\"\n                                     v-if=\"data.sub__${subVars.classVar}&amp;&amp;data.sub__${subVars.classVar}.length <= 0\">\n                                    <a-empty></a-empty>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function colgroupRowFun templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n		<#if colindexNum==1>\n		<col width=\"20%\">\n		<col width=\"80%\">\n		<#elseif colindexNum==2>\n		<col width=\"15%\">\n		<col width=\"35%\">\n		<col width=\"15%\">\n		<col width=\"35%\">\n		<#elseif colindexNum==4>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function subColOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-number\'>\n            :max=\"100000000\" \n			:min=\"0\" \n			:step=\"1\" \n			valmode=\"single\"\n        <#elseif ctlType==\'rx-textbox\'>\n            :ispassword=\"false\"\n        <#elseif ctlType==\'rx-form-select\'>\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-user\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#else >\n            valmode=\"single\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function getRemainderNum templateNum>\n    <#assign rtn>\n        <#if templateNum==0 || templateNum==1 || templateNum==2>\n             1\n		<#elseif templateNum==3>\n			2\n		<#elseif templateNum==4>\n			3\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function otherRowFun commonList templateType>\n    <#assign templateNum=templateType?number>\n	<#assign remainderNum=getRemainderNum(templateNum)>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex &gt;= templateNum>\n                <#if (colIndex % templateNum==0)>\n                    <tr>\n                </#if>\n                <#if (col.control==\'rx-tree-select\' || col.control==\'rx-form-select\')>\n                    <td style=\"word-break: break-all;\" :class=\"{required:required.main.khly}\">${col.comment}</td>\n                <#else >\n                    <td style=\"word-break: break-all;\">${col.comment}</td>\n                </#if>\n                    <td style=\"word-break: break-all;\">\n                        <${col.control} \n							type=\"main\"\n							id=\"${col.id}\"\n							:readonly=\"readonly\"\n							v-model=\"data.${col.name}\"\n							:valid=\"validFunc(\'main\',\'${col.name}\')\"\n							permission=\"w\"\n							${colOtherFun(col)}></${col.control}>\n                    </td>\n                <#if colIndex % templateNum == remainderNum || !col_has_next>\n                </tr>\n                </#if>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function firstRowFun commonList templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex==0>\n                <tr class=\"firstRow\">\n            </#if>\n            <#if colIndex<colindexNum>\n                <td style=\"word-break: break-all;\">${col.comment}</td>\n                <td style=\"word-break: break-all;\">\n                <${col.control} \n					type=\"main\"\n					id=\"${col.id}\"\n					:readonly=\"readonly\"\n					v-model=\"data.${col.name}\"\n					:valid=\"validFunc(\'main\',\'${col.name}\')\"\n					permission=\"w\"\n					${colOtherFun(col)}></${col.control}>\n                </td>\n            </#if>\n            <#if (colindexNum-colIndex)==1>\n                </tr>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function colOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-address\'>\n		<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n           :setting=\"{isCity:${extJson.isCity},isCounty:${extJson.isCounty},isAddress:${extJson.isAddress}}\"\n        <#elseif ctlType==\'rx-radio\'>\n			mode=\"default\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			:onlyvalue=\"false\"\n        <#elseif ctlType==\'rx-number\'>\n			:max=\"1000000\"\n			:min=\"0\"\n			:step=\"1\"\n			length=\"${col.length},${col.decimalLength}\"\n        <#elseif ctlType==\'rx-switch\'>\n			mode=\"custom\"\n			verifyhide=\"${col.name}\"\n			check=\"Y\"\n			uncheck=\"N\"\n        <#elseif ctlType==\'rx-tree-select\'>\n			mode=\"multiple\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:selectable=\"false\"\n			:data=\"data\"\n        <#elseif ctlType==\'rx-form-select\'>\n			:data=\"data\"\n			mode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			valmode=\"single\"\n			:hideselect=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-date\'>\n            format=\"YYYY-MM-DD HH:mm:ss\"\n        <#elseif ctlType==\'rx-user\'>\n			:data=\"data\"\n			gridname=\"main\"\n			:single=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			gridname=\"main\"\n			:single=\"false\"\n			:showdeptpath=\"false\"\n			:deptpathlevel=\"0\"\n			:showdimid=\"true\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:35:02', '1', '2022-06-30 10:16:21', NULL, NULL, '{class}Edit.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode', '0');

-- 2022-06-30 jpaas-form szw  代码生成器模板修改：调整后端模板---end

-- 2022-07-01 jpaas-user gjh 用户加序号
ALTER TABLE jpaas_user.os_user ADD COLUMN SN_ INT(11)  COMMENT '序号';
UPDATE jpaas_user.os_user SET SN_=2000 WHERE SN_ IS NULL;

-- 2022-07-05 jpaas-seata yl seata1.5.1版本需要新增表distributed_lock
ALTER TABLE `jpaas_seata`.`lock_table`    CHANGE xid xid varchar(128) NULL ;

CREATE TABLE IF NOT EXISTS `jpaas_seata`.`distributed_lock`
(
    `lock_key`       CHAR(20) NOT NULL,
    `lock_value`     VARCHAR(20) NOT NULL,
    `expire`         BIGINT,
    primary key (`lock_key`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8mb4;

INSERT INTO `jpaas_seata`.`distributed_lock` (lock_key, lock_value, expire) VALUES ('AsyncCommitting', ' ', 0);
INSERT INTO `jpaas_seata`.`distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryCommitting', ' ', 0);
INSERT INTO `jpaas_seata`.`distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryRollbacking', ' ', 0);
INSERT INTO `jpaas_seata`.`distributed_lock` (lock_key, lock_value, expire) VALUES ('TxTimeoutCheck', ' ', 0);

-- 2022-07-05 jpaas-system hj 新增 我的跟踪功能菜单
INSERT INTO `jpaas_system`.`sys_menu`(`MENU_ID_`, `APP_ID_`, `NAME_`, `ICON_PC_`, `ICON_PIC_`, `ICON_APP_`, `PARENT_ID_`, `PATH_`, `SN_`, `SHOW_TYPE_`, `MENU_KEY_`, `MENU_TYPE_`, `COMPONENT_`, `SETTING_TYPE_`, `BO_LIST_KEY_`, `URL_`, `METHOD_`, `PARAMS_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `SHARE_`, `COMPANY_ID_`, `INST_CONFIG_`) VALUES ('1542350952197640194', '1257928508099674114', '我的跟踪', '{\"type\":\"customIcon\",\"icon\":\"icondiscount-fill\"}', 'icondiscount-fill', NULL, '0', '0.1542350952197640194.', 1, 'URL', 'myTracked', 'C', 'modules/bpm/ws/MyTracked', 'custom', NULL, NULL, NULL, NULL, '1', '1', '1', '2022-06-30 11:34:57', NULL, '2022-06-30 11:34:57', 'N', NULL, NULL);


-- 2022-07-05 jpaas-system zyg 密码策略表名变更。
ALTER TABLE `jpaas_user`.`os_password_policy_configure` RENAME TO os_password_policy;


-- 2022-07-06 jpaas-form szw  代码生成器模板修改：调整后端模板---begin
delete from `jpaas_form`.`form_template` where ID_ in('1533698962918469634','1533698815715176450','1533698647930433538','1533698526207537154','1533698365993512961','1533698265154056194','1533698110191300609','1533697966238593025','1533697732414533634','1533697561588920321');

INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533697561588920321', '代码生成_正向Apijs代码', 'codeGenApijsW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign developer=vars.developer>\n<#assign system=vars.system>\n<#assign name=model.name>\n<#assign domain=vars.domain>\nimport rxAjax from \'@/assets/js/ajax.js\';\n\n/*\n 概要说明:${name} api接口\n 开发人员:${developer}\n*/\nexport const ${class}Api = {};\n\n${class}Api.baseUrl= \'/api-${system}/${system}/${package}/${classVar}\';\n${class}Api.exportUrl= ${class}Api.baseUrl + \'/export\';\n\n//查询列表\n${class}Api.query=function (parameter) {\n  var url= ${class}Api.baseUrl + \'/query\';\n  return rxAjax.postJson(url,parameter).then (res => {\n    return res.result\n  })\n}\n\n\n/**\n * 获取表单数据\n * @param pkId\n * @returns {*}\n */\n${class}Api.getById =function(pkId) {\n    var url= ${class}Api.baseUrl + \'/getById?pkId=\' + pkId;\n    return rxAjax.get(url);\n}\n\n/**\n * 保存表单数据\n * @param formdata\n * @returns {*}\n */\n${class}Api.saveData =function(formdata) {\n    var url= ${class}Api.baseUrl + \'/saveData\';\n    return rxAjax.postJson(url,formdata);\n}\n\n\n\n//删除数据\n${class}Api.del =function(parameter) {\n  var url= ${class}Api.baseUrl + \'/del\';\n  return rxAjax.postUrl(url,parameter);\n}\n\nexport  default ${class}Api;\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:29:28', NULL, '2022-06-06 14:29:28', NULL, NULL, '{classVar}.js', 'src/api/{system}/{package}', 'YES', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533697732414533634', '代码生成_正向Data.js_编辑JS', 'codeGenDatajsW', 'export default {\n    data(){\n        return {\n            //表单数据\n            data:${vueJs.data},\n            //从表单数据\n            initData:${vueJs.initData},\n            //公式\n            formulas:${vueJs.formulas},\n            //校验函数\n            rules:${vueJs.rules},\n            //区域计算\n            calcAreas:${vueJs.calcAreas},\n            //校验规则\n            validRules:${vueJs.validRules},\n            //自定义查询\n            customquery:${vueJs.customquery},\n            //元数据\n            metadata:${vueJs.metadata},\n            listSearchType:\"${vueJs.listSearchType}\",\n            treeJson:${vueJs.treeJson},\n            boRelations:${boRelationsStr}\n        }\n    }\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:30:09', '1', '2022-06-13 15:13:21', NULL, NULL, '{class}Data.js', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533697966238593025', '代码生成_正向实体转json映射', 'codeGenfileJsonW', '${jsonFile}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:05', NULL, '2022-06-06 14:31:05', NULL, NULL, '{classVar}.json', 'src/main/resources/entityJson/{package}', 'YES', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698110191300609', '代码生成_正向Entity_实体层', 'codeGenEntityW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<#assign idField=convertUnderLine(model.idField)>\n\n\n/**\n* [${model.name}]实体类定义\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\npackage ${domain}.${system}.${package}.entity;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.baomidou.mybatisplus.annotation.TableName;\nimport com.fasterxml.jackson.annotation.JsonCreator;\nimport com.redxun.common.base.entity.BaseExtEntity;\nimport com.redxun.gencode.codegenhander.SubTableDef;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.experimental.Accessors;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.apache.ibatis.type.JdbcType;\nimport java.util.Date;\n\n\n@Setter\n@Getter\n@Accessors(chain = true)\n@TableName(value = \"${tableName}\")\npublic class ${class}  extends BaseExtEntity<java.lang.String> {\n\n    @JsonCreator\n    public ${class}() {\n    }\n	\n	//主键\n    @TableId(value = \"${model.idField}\",type = IdType.INPUT)\n	private String ${idField};\n\n	@Override\n    public String getPkId() {\n        return this.${idField};\n    }\n\n    @Override\n    public void setPkId(String pkId) {\n        this.${idField}=pkId;\n    }\n\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n	//外键\n    @TableField(value = \"REF_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String refId;\n\n    //父键\n    @TableField(value = \"PARENT_ID_\",jdbcType=JdbcType.VARCHAR)\n    private String parentId;\n	</#if>\n    <#list colList as col>\n	<#if col.control==\"rx-address\">\n	${addressFun(col)}\n	<#else>\n	//${col.comment}\n    @TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n    private ${getJavaType(col)} ${col.name};\n	\n	<#if col.isSingle==0>\n	${colNameFun(col)}\n	</#if>\n	</#if>\n    </#list>\n\n	\n	<#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @TableField(exist=false)\n	@SubTableDef(tableName = \"${subEnt.vars.class}\",className = ${subEnt.vars.class}.class,type = \"onetomany\")\n	private List<${subEnt.vars.class}> ${subEnt.vars.classVar}List=new ArrayList<>();\n	</#list>	\n	</#if>\n \n}\n\n\n\n<#function colNameFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}名称\n		@TableField(value = \"${col.fieldName}_NAME\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Name;\n	<#else>\n		<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n		//${colJson.comment}名称\n		@TableField(value = \"${colJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(colJson)})\n		private ${getJavaType(colJson)} ${colJson.name};\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function addressFun col>\n<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n<#assign setting=extJson.setting>\n<#assign rtn>\n	<#if model.genMode==\"form\" || model.genMode==\"create\">\n		//${col.comment}--省\n		@TableField(value = \"${col.fieldName}_PROVINCE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Province;\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}_P_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Pcode;\n		\n		<#if setting.isCity==\"true\">\n		//${col.comment}--市\n		@TableField(value = \"${col.fieldName}_CITY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}City;\n		\n		//${col.comment}--市Code\n		@TableField(value = \"${col.fieldName}_CITY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CityCode;\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n		//${col.comment}--县(区)\n		@TableField(value = \"${col.fieldName}_COUNTY\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}County;\n		\n		//${col.comment}--县(区)Code\n		@TableField(value = \"${col.fieldName}_COUNTY_CODE\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}CountyCode;\n\n		</#if>\n		<#if setting.isAddress==\"true\">\n		\n		//${col.comment}--详细地址\n		@TableField(value = \"${col.fieldName}_ADDRESS\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name}Address;\n		</#if>\n	<#else>\n		<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n		//${provinceJson.comment}--省\n		@TableField(value = \"${provinceJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(provinceJson)})\n		private ${getJavaType(provinceJson)} ${provinceJson.name};\n		\n		//${col.comment}--省code\n		@TableField(value = \"${col.fieldName}\",jdbcType=JdbcType.${getJdbcType(col)})\n		private ${getJavaType(col)} ${col.name};\n		\n		<#if setting.isCity==\"true\">\n		\n			<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n			//${cityJson.comment}--市\n			@TableField(value = \"${cityJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityJson)})\n			private ${getJavaType(cityJson)} ${cityJson.name};\n			\n			<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n			//${cityCodeJson.comment}--市Code\n			@TableField(value = \"${cityCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(cityCodeJson)})\n			private ${getJavaType(cityCodeJson)} ${cityCodeJson.name};\n\n		</#if>\n		<#if setting.isCounty==\"true\">\n		\n			<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n			//${countyJson.comment}--县(区)\n			@TableField(value = \"${countyJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyJson)})\n			private ${getJavaType(countyJson)} ${countyJson.name};\n			\n			<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n			//${countyCodeJson.comment}--县(区)Code\n			@TableField(value = \"${countyCodeJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(countyCodeJson)})\n			private ${getJavaType(countyCodeJson)} ${countyCodeJson.name};\n		</#if>\n		<#if setting.isAddress==\"true\">\n		<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n			//${addressJson.comment}--详细地址\n			@TableField(value = \"${addressJson.fieldName}\",jdbcType=JdbcType.${getJdbcType(addressJson)})\n			private ${getJavaType(addressJson)} ${addressJson.name};\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJavaType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n<#if  dbtype==\"number\"  >\n    <#if col.decimalLength==0>\n         <#if col.length gt 10 >\n            long\n         <#else>\n            int\n         </#if>\n    <#else>\n         double\n    </#if>\n<#elseif (dbtype==\"date\")>\n	Date\n<#else>\n	String\n</#if>\n</#assign>\n <#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:31:39', '1', '2022-06-29 18:11:14', NULL, NULL, '{class}.java', 'src/main/java/com/{rootSystem}/{system}/{package}/entity', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698265154056194', '代码生成_正向Mapper数据库访问类', 'codeGenMapperW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n    \npackage ${domain}.${system}.${package}.mapper;\n\nimport ${domain}.${system}.${package}.entity.${class};\nimport org.apache.ibatis.annotations.Mapper;\nimport com.redxun.common.base.db.BaseDao;\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\nimport org.apache.ibatis.annotations.Param;\nimport java.util.List;\n</#if>\n/**\n* [${model.name}]据库访问层\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Mapper\npublic interface ${class}Mapper extends BaseDao<${class}> {\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	List<${class}> getByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${subRelation.fkFieldName}\") String ${subRelation.fkFieldName});\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	List<${class}> getByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	\n	void deleteByRefId(@Param(\"${boRelation.fkFieldName}\") String ${boRelation.fkFieldName});\n	</#if>\n	\n	\n</#if>\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:16', '1', '2022-06-29 18:08:49', NULL, NULL, '{class}Mapper.java', 'src/main/java/com/{rootSystem}/{system}/{package}/mapper', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698365993512961', '代码生成_正向ServiceImpl服务层', 'codeGenServiceImpl', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign domain=vars.domain>\n\npackage ${domain}.${system}.${package}.service;\n\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.redxun.common.base.db.BaseDao;\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.common.service.impl.SuperServiceImpl;\nimport com.redxun.common.tool.BeanUtil;\nimport com.redxun.common.tool.StringUtils;\nimport com.redxun.common.utils.ExceptionUtil;\nimport com.redxun.common.tool.IdGenerator;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.mapper.${class}Mapper;\n<#if model.boEntityList?size gt 0 >\n<#list model.boEntityList as subEnt>\nimport ${domain}.${system}.${package}.service.${subEnt.vars.class}ServiceImpl;\nimport ${domain}.${system}.${package}.mapper.${subEnt.vars.class}Mapper;\nimport ${domain}.${system}.${package}.entity.${subEnt.vars.class};\n</#list>\n</#if>\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.Resource;\nimport java.io.Serializable;\nimport java.util.Collection;\nimport java.util.List;\n\n/**\n* [${model.name}]业务服务类\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@Service\npublic class ${class}ServiceImpl extends SuperServiceImpl<${class}Mapper, ${class}> implements BaseService<${class}> {\n\n    @Resource\n    private ${class}Mapper ${classVar}Mapper;\n    \n    <#if model.boEntityList?size gt 0 >\n    <#list model.boEntityList as subEnt>\n    @Resource\n    private ${subEnt.vars.class}ServiceImpl ${subEnt.vars.classVar}Service;\n	@Resource\n    private ${subEnt.vars.class}Mapper ${subEnt.vars.classVar}Mapper;\n    </#list>\n    </#if>\n   \n    @Override\n    public BaseDao<${class}> getRepository() {\n        return ${classVar}Mapper;\n    }\n	\n	<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	public void saveOrUpdateAll(List<${class}> subList, String pkId){\n		${classVar}Mapper.deleteByRefId(pkId);\n        if(BeanUtil.isEmpty(subList)){\n            return;\n        }\n        for (${class} sub:subList) {\n		<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n			<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n			<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n			<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n			sub.set${subRelation.fkFieldFun}(pkId);\n			<#else>\n			<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n			sub.set${boRelation.fkFieldFun}(pkId);\n			</#if>\n		</#if>\n\n			if(StringUtils.isEmpty(sub.getPkId())){\n                sub.setPkId(IdGenerator.getIdStr());\n            }\n        }\n        try {\n            this.saveOrUpdateBatch(subList);\n        }catch (Exception e){\n            log.error(\"saveOrUpdateAll is error: messgae={}\", ExceptionUtil.getExceptionMessage(e));\n        }\n    }\n	</#if>\n\n		\n	<#if model.boEntityList?size gt 0 >\n	@Override\n    public void delete(Collection<Serializable> entities) {\n\n        for(Serializable id:entities){\n            //根据ID删除${model.name}\n            ${classVar}Mapper.deleteById(id);\n            <#list model.boEntityList as subEnt>\n            //根据ID删除${subEnt.name}    \n    		QueryWrapper ${subEnt.vars.classVar}Wrapper=new QueryWrapper();\n            ${subEnt.vars.classVar}Wrapper.eq(\"${subEnt.boRelation.fkField}\",id);\n            ${subEnt.vars.classVar}Mapper.delete(${subEnt.vars.classVar}Wrapper);\n    		</#list>\n        }\n    }\n	\n	/**\n     * 根据主键获取表单数据\n     * @param pk\n     * @return\n     */\n    @Override\n    public ${class} get(Serializable pk){\n        ${class} ${classVar}=this.getById(pk);\n        if(BeanUtil.isEmpty(${classVar})){\n            return new ${class}();\n        }\n		<#list model.boEntityList as subEnt>\n		List<${subEnt.vars.class}> ${subEnt.vars.classVar}List =${subEnt.vars.classVar}Mapper.getByRefId((String)pk);\n        ${classVar}.set${subEnt.vars.class}List(${subEnt.vars.classVar}List);\n		</#list>\n        return ${classVar};\n    }\n\n    @Override\n    public int insert(${class} entity) {\n        String pkId = entity.getPkId();\n        if(BeanUtil.isEmpty(pkId)) {\n            pkId=IdGenerator.getIdStr();\n            entity.setPkId(pkId);\n        }\n        int insert = getRepository().insert(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),pkId);\n		</#list>\n        return insert;\n    }\n\n    @Override\n    public int update(${class} entity) {\n        int insert =  getRepository().updateById(entity);\n		<#list model.boEntityList as subEnt>\n		${subEnt.vars.classVar}Service.saveOrUpdateAll(entity.get${subEnt.vars.class}List(),entity.getPkId());\n		</#list>\n        return insert;\n    }\n    </#if>\n	\n}\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:32:40', '1', '2022-06-29 18:08:41', NULL, NULL, '{class}ServiceImpl.java', 'src/main/java/com/{rootSystem}/{system}/{package}/service', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698526207537154', '代码生成_正向Controller控制层', 'codeGenControllerW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign entAlias=model.vars.entAlias>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n\npackage ${domain}.${system}.${package}.controller;\n\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.gencode.controller.CodeGenBaseController;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\nimport io.swagger.annotations.Api;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.*;\nimport com.redxun.common.annotation.ClassDefine;\nimport com.redxun.gencode.codegenhander.ClassCodeDef;\n\n\n/**\n* [${model.name}] 控制器代码\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@RestController\n@RequestMapping(\"/${system}/${package}/${classVar}\")\n@Api(tags = \"${comment}\")\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\n@ClassCodeDef(alias = \"${entAlias}\",classPackage=\"${package}\",createType=\"${model.genMode}\")\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\n\n	@Autowired\n	${class}ServiceImpl ${classVar}Service;\n\n	@Override\n	public BaseService getBaseService() {\n		return ${classVar}Service;\n	}\n\n	@Override\n	public String getComment() {\n		return \"${comment}\";\n	}\n\n	@Override\n	public ${class} getBaseEntity(){\n		return new ${class}();\n	}\n\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:18', '1', '2022-07-06 17:41:40', NULL, NULL, '{class}Controller.java', 'src/main/java/com/{rootSystem}/{system}/{package}/controller', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698647930433538', '代码生成_正向Mapping文件', 'codeGenMappingW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainSubClassVar=model.vars.mainSubClassVar>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign type=\"${domain}.\"+system+\".\"+ package +\".entity.\" +class>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\n<mapper namespace=\"${domain}.${system}.${package}.mapper.${class}Mapper\">\n\n    <resultMap id=\"${class}\" type=\"${type}\">\n            <#assign idField=convertUnderLine(model.idField)>\n            <id property=\"${idField}\" column=\"${model.idField}\" jdbcType=\"VARCHAR\"/>\n		        <#list colList as col>\n				${columnFun(col model.genMode)}\n		        </#list>\n		      <#if model.genMode==\"form\" || model.genMode==\"create\" >\n			  <result property=\"refId\" column=\"REF_ID_\" jdbcType=\"VARCHAR\"/>\n			  <result property=\"parentId\" column=\"PARENT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"tenantId\" column=\"TENANT_ID_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createBy\" column=\"CREATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"createTime\" column=\"CREATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"updateBy\" column=\"UPDATE_BY_\" jdbcType=\"VARCHAR\"/>\n		      <result property=\"updateTime\" column=\"UPDATE_TIME_\" jdbcType=\"DATE\"/>\n		      <result property=\"createDepId\" column=\"CREATE_DEP_ID_\" jdbcType=\"VARCHAR\"/>\n		      </#if>\n    </resultMap>\n\n\n    <select id=\"query\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n        select ${model.idField},<#list colList as col>${selectColumnFun(col model.genMode)}<#if col_has_next>,</#if></#list><#if model.genMode==\"form\" || model.genMode==\"create\" >,REF_ID_,PARENT_ID_,TENANT_ID_,CREATE_BY_,CREATE_TIME_,UPDATE_BY_,UPDATE_TIME_,CREATE_DEP_ID_</#if> from ${tableName}\n        <#noparse>\n        <where>\n            <if test=\"@rx.Ognl@isNotEmpty(w.whereSql)\">\n                ${w.whereSql}\n            </if>\n        </where>\n        <if test=\"@rx.Ognl@isNotEmpty(w.orderBySql)\">\n            ORDER BY ${w.orderBySql}\n        </if>\n        <if test=\"@rx.Ognl@isEmpty(w.orderBySql)\"></#noparse>\n            ORDER BY  ${model.idField} DESC\n        </if>\n    </select>\n	\n<#if (model.vars.isSub?? && model.vars.isSub==\'YES\') || (model.vars.isSubMain?? && model.vars.isSubMain==\'YES\')>\n	<#if model.vars.isSubMain?? && model.vars.isSubMain==\'NO\'>\n	<#assign mainSubRelation=fileUtil.getRelation(boRelations,mainSubClassVar)>\n	<#assign subRelation=fileUtil.getRelation(mainSubRelation,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM ${tableName} WHERE ${subRelation.fkField}=${r\"#\"}{${subRelation.fkFieldName}}\n	</delete>\n	<#else>\n	<#assign boRelation=fileUtil.getRelation(boRelations,classVar)>\n	<select id=\"getByRefId\" resultType=\"${type}\" parameterType=\"java.util.Map\">\n		select * from ${tableName} where ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</select>\n	\n	<delete id=\"deleteByRefId\" parameterType=\"java.lang.String\" >\n	DELETE FROM ${tableName} WHERE ${boRelation.fkField}=${r\"#\"}{${boRelation.fkFieldName}}\n	</delete>\n	</#if>\n</#if>\n	\n\n</mapper>\n\n\n<#function selectColumnFun col genMode>\n<#assign name=col.fieldName>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n			${name}_PROVINCE,${name}_P_CODE\n			<#if extJson.isCity==\"true\">\n			,${name}_CITY,${name}_CITY_CODE\n			</#if>\n			<#if extJson.isCounty==\"true\">\n			,${name}_COUNTY,${name}_COUNTY_CODE\n			</#if>\n			<#if extJson.isAddress==\"true\">\n			,${name}_ADDRESS\n			</#if>\n		<#elseif col.isSingle==0>\n			${name}_NAME,${name}\n		<#else>\n			${name}\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n			\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			${provinceJson.fieldName},${name}\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				,${cityJson.fieldName}\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				,${cityCodeJson.fieldName}\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				,${countyJson.fieldName}\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				,${countyCodeJson.fieldName}\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				,${addressJson.fieldName}\n			</#if>\n		<#elseif col.isSingle==0>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			${name},${colJson.fieldName}\n		<#else>\n			${name}\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function columnFun col genMode>\n<#assign colName=convertUnderLine(col.fieldName)>\n<#assign rtn>\n	<#if genMode==\"form\" || model.genMode==\"create\" >\n		<#if col.control==\"rx-address\">\n			<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n			<#assign setting=extJson.setting>\n			<result property=\"${colName}Province\" column=\"${col.fieldName}_PROVINCE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Pcode\" column=\"${col.fieldName}_P_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<result property=\"${colName}City\" column=\"${col.fieldName}_CITY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CityCode\" column=\"${col.fieldName}_CITY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<result property=\"${colName}County\" column=\"${col.fieldName}_COUNTY\" jdbcType=\"${getJdbcType(col)}\"/>\n				<result property=\"${colName}CountyCode\" column=\"${col.fieldName}_COUNTY_CODE\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<result property=\"${colName}Address\" column=\"${col.fieldName}_ADDRESS\" jdbcType=\"${getJdbcType(col)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<result property=\"${colName}Name\" column=\"${col.fieldName}_NAME\" jdbcType=\"${getJdbcType(col)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	<#else>\n		<#assign extJson=fileUtil.parseStrToJson(col.extJson)>\n		<#if col.control==\"rx-address\">\n			<#assign setting=extJson.setting>\n\n			<#assign provinceJson=fileUtil.getColByColList(model,extJson.province,\"name\")>\n			<result property=\"${convertUnderLine(provinceJson.fieldName)}\" column=\"${provinceJson.fieldName}\" jdbcType=\"${getJdbcType(provinceJson)}\"/>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#if setting.isCity==\"true\">\n				<#assign cityJson=fileUtil.getColByColList(model,extJson.city,\"name\")>\n				<result property=\"${convertUnderLine(cityJson.fieldName)}\" column=\"${cityJson.fieldName}\" jdbcType=\"${getJdbcType(cityJson)}\"/>\n				<#assign cityCodeJson=fileUtil.getColByColList(model,extJson.city_code,\"name\")>\n				<result property=\"${convertUnderLine(cityCodeJson.fieldName)}\" column=\"${cityCodeJson.fieldName}\" jdbcType=\"${getJdbcType(cityCodeJson)}\"/>\n			</#if>\n			<#if setting.isCounty==\"true\">\n				<#assign countyJson=fileUtil.getColByColList(model,extJson.county,\"name\")>\n				<result property=\"${convertUnderLine(countyJson.fieldName)}\" column=\"${countyJson.fieldName}\" jdbcType=\"${getJdbcType(countyJson)}\"/>\n				<#assign countyCodeJson=fileUtil.getColByColList(model,extJson.county_code,\"name\")>\n				<result property=\"${convertUnderLine(countyCodeJson.fieldName)}\" column=\"${countyCodeJson.fieldName}\" jdbcType=\"${getJdbcType(countyCodeJson)}\"/>\n			</#if>\n			<#if setting.isAddress==\"true\">\n				<#assign addressJson=fileUtil.getColByColList(model,extJson.address,\"name\")>\n				<result property=\"${convertUnderLine(addressJson.fieldName)}\" column=\"${addressJson.fieldName}\" jdbcType=\"${getJdbcType(addressJson)}\"/>\n			</#if>\n		<#elseif col.isSingle==0>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n			<#assign colJson=fileUtil.getColByColList(model,extJson.ref,\"fieldName\")>\n			<result property=\"${convertUnderLine(colJson.fieldName)}\" column=\"${colJson.fieldName}\" jdbcType=\"${getJdbcType(colJson)}\"/>\n		<#else>\n			<result property=\"${colName}\" column=\"${col.fieldName}\" jdbcType=\"${getJdbcType(col)}\"/>\n		</#if>\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function getJdbcType col>\n<#assign dbtype=col.dataType?lower_case>\n<#assign rtn>\n	<#if  dbtype==\"number\"  >\n		NUMERIC\n	<#elseif (dbtype==\"date\")>\n		DATE\n	<#else>\n		VARCHAR\n	</#if>\n</#assign>\n<#return rtn?trim>\n</#function>\n\n\n<#function convertUnderLine field>\n	<#if field?index_of(\"_\")==-1>\n		<#assign rtn>${field?lower_case?trim}</#assign>\n		<#return rtn>\n	</#if>\n\n	<#if field?index_of(\"F_\")==0>\n		<#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n		<#return rtn>\n	</#if>\n\n	<#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:47', '1', '2022-06-30 10:27:04', NULL, NULL, '{class}Mapper.xml', 'src/main/resources/mapper/{rootSystem}/{system}/{package}', 'NO', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698815715176450', '代码生成_正向列表页面', 'codeGenListVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign comment=model.name>\n<#assign pk=model.idField>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign searchFields=settingJson.mainEntity.searchFields>\n\n<template>\n  <rx-layout>\n	${leftSearchTreeFun()}\n    <div slot=\"center\" style>\n      <rx-fit>\n        <div slot=\"toolheader\" foldheader=\"true\" foldbtn=\"false\" border=\"false\">\n          <div class=\"table-operator\">\n            <rx-button alias=\"${classVar}Add\" :butn-icon=\"\'plus\'\" :butn-type=\"\'primary\'\" :show-no-right=\"true\" @click=\"add\">新建</rx-button>\n            <a-dropdown v-if=\"editEnable && selectedRowKeys.length > 0 || removeEnable && selectedRowKeys.length > 0\">\n              <a-button style=\"margin-left: 8px\"> 更多 <a-icon type=\"down\" /> </a-button>\n              <a-menu slot=\"overlay\">\n                <a-menu-item key=\"1\" v-if=\"editEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Edit\" :butn-icon=\"\'edit\'\"\n                             :butn-type=\"\'primary\'\" :show-no-right=\"false\" @click=\"editOne\"><a-icon type=\"edit\"  />编辑</a-menu-item>\n                <a-menu-item key=\"2\" v-if=\"removeEnable && selectedRowKeys.length > 0\" alias=\"${classVar}Delete\" :butn-icon=\"\'delete\'\" :butn-type=\"\'danger\'\"\n                             :show-no-right=\"false\" @click=\"delByIds(selectedRowKeys)\"><a-icon type=\"delete\" />删除</a-menu-item>\n              </a-menu>\n            </a-dropdown>\n          </div>\n          <span class=\"search-btn-box\">\n                <span class=\"search-btn\" @click=\"searchshow\"><i class=\"iconfont iconguolv\"></i>过滤</span>\n           </span>\n        </div>\n        <div slot=\"searchbar\" btnalign=\"right\"  v-if=\"fitSearch\" @search=\"search\" @cancel=\"cancel\" @close=\"close\">\n          <a-form layout=\"vertical\">\n            <#list searchFields as search>\n            <a-form-item label=\"${search.fieldLabel}\">\n				<#if (!search.fc?? || search.fc==\'textbox\')>\n					<a-input <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n							 v-model.trim=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"/>\n				<#elseif (search.fc==\'datepicker\')>\n					<#if search.format??>\n						<#assign searchDateFormat=search.format>\n					<#else>\n						<#assign searchDateFormat=\'YYYY-MM-DD\'>\n					</#if>\n					<a-date-picker <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>\n								   v-model=\"queryParam[\'queryField_${search.fieldName}\']\"\n								   format=\"${searchDateFormat}\"\n							<#if searchDateFormat==\'YYYY-MM-DD HH:mm:ss\'>\n								show-time\n							</#if>\n								   @change=\"searchDateChange($event,$event,{queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_D_${search.fieldOp}<#else>${search.fieldName}</#if>\',format:\'${searchDateFormat}\'})\"/>\n				<#elseif (search.fc==\'month\')>\n					<a-month-picker  v-model=\"queryParam[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if>  @change=\"searchMonthChange($event,$event,{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\'<#if search.format??>,format:\'${search.format}\'</#if>,autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'rangepicker\')>\n					<#if search.format??>\n						<#assign searchRangeFormat=search.format>\n					<#else>\n						<#assign searchRangeFormat=\'YYYY-MM-DD HH:mm:ss\'>\n					</#if>\n					<a-range-picker  ref=\"queryField_${search.fieldName}\"  v-model=\"params[\'queryField_${search.fieldName}\']\" <#if search.emptytext??>placeholder=\"${search.emptytext}\"</#if> show-time format=\"${searchRangeFormat}\"  @change=\"searchRangeDateChange($event,\'${searchRangeFormat}\',{queryField:\'<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}\',autoFilter:\'${search.autoFilter}\'})\" />\n				<#elseif (search.fc==\'select\')>\n					<rx-select ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'treeselect\')>\n					<rx-tree-select-ctl ref=\"Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\" v-model=\"queryParam[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\"\n							   :multiValue=\"true\" :labelInValue=\"false\" :multiSelect=\"<#if search.multiSelect??>${search.multiSelect?c}<#else>false</#if>\" :showSearch=\"<#if search.showSearch??>${search.showSearch?c}<#else>false</#if>\"\n							   <#if (!search.from?? || search.from==\'self\')>:dataSource=\"selectOptions${search_index}\" value-field=\"key\" text-field=\"name\"\n							   <#elseif (search.from==\'url\')>url=\"${search.url}\" value-field=\"${search.url_valuefield}\" text-field=\"${search.url_textfield}\" parent-field=\"${search.url_parentfield}\"\n							   <#elseif (search.from==\'dic\')>url=\"/api-system/system/core/sysDic/treeByKey?key=${search.dicKey}\" value-field=\"value\" text-field=\"name\" :toTree=\"false\"\n							   <#elseif (search.from==\'sql\')>url=\"/api-form/form/core/formCustomQuery/queryForJson_${search.sql}\" data-field=\"data\" value-field=\"${search.sql_valuefield}\" text-field=\"${search.sql_textfield}\" parent-field=\"${search.sql_parentfield}\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\',selectParams${search_index})\" :loadDataOnstart=\"true\"\n							   @onChange=\"searchChange(\'${search.fieldName}\',\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" ajaxType=\"post\"\n							   <#elseif (search.from==\'grant\')>url=\"/api-form/form/core/formEntityDataSetting/queryData_${search.grant}\" data-field=\"data\"\n							   @focus=\"selectFocus(\'Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}_</#if>${search.fieldName}_S_${search.fieldOp}\')\" :loadDataOnstart=\"true\"\n							</#if>/>\n				<#elseif (search.fc==\'dialog\')>\n					<rx-input-button v-model=\"params[\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\']\" :multiValue=\"true\"\n									 :single=\"false\" :config=\"{fieldName:\'${search.fieldName}\',queryField:\'<#if search.autoFilter==\'YES\'>Q_<#if search.tablePre?? && search.tablePre!=\"\">${search.tablePre}.</#if>${search.fieldName}_S_${search.fieldOp}<#else>${search.fieldName}</#if>\',dialog:\'<#if search.dialog??>${search.dialog}</#if>\',dialog_name:\'<#if search.dialog_name??>${search.dialog_name}</#if>\',valueField:\'<#if search.valueField??>${search.valueField}</#if>\',textField:\'<#if search.textField??>${search.textField}</#if>\',single:!<#if search.multiSelect??>${search.multiSelect?c}<#else>true</#if>}\"\n									 @click=\"_OnDialogShow\"/>\n				</#if>\n			 </a-form-item>\n            </#list>\n          </a-form>\n        </div>\n        <#assign idField=convertUnderLine(pk)>\n        <rx-grid\n                ref=\"table\"\n			<#if settingJson.multiSelect==\'notSelect\'>\n                :allowRowSelect=\"false\"\n			<#else>\n				:allowRowSelect=\"true\"\n			</#if>\n			<#if settingJson.multiSelect==\'move\'>\n				:multiSelect=\"true\"\n			<#else>\n				:multiSelect=\"false\"\n			</#if>\n                :columns=\"columns\"\n			<#if settingJson.isPage==\'YES\'>\n				:showPage=\"true\"\n				:defaultPageSize=\"${settingJson.pageSize}\"\n				:pageSizeOptions=\"[\'10\',\'20\',\'30\',\'40\',\'50\']\"\n			<#else>\n				:showPage=\"false\"\n			</#if>\n                url=\"/api-${system}/${system}/${package}/${classVar}/query\"\n                :queryParam=\"queryParam\"\n                data-field=\"result.data\"\n                id-field=\"${idField}\"\n                @selectChange=\"onSelectChange\"\n        >\n		  <#list commonList as col>\n		  ${slotScopeColFun(col)}\n          </#list>\n            <span slot=\"action\" slot-scope=\"{ text, record }\" class=\"actionIcons\">\n                <span  @click.stop=\"edit(record)\">编辑</span>\n				<span  @click.stop=\"detail(record)\">明细</span>\n                <span  @click.stop=\"delByIds([record.${idField}])\">删除</span>\n            </span>\n        </rx-grid>\n      </rx-fit>\n    </div>\n  </rx-layout>\n</template>\n\n<script>\n  import ${class}Api from \'@/api/${system}/${package}/${classVar}\'\n  import ${class}Edit from \'./${class}Edit\'\n  import {BaseList,RxFit,RxGrid,RxButton,RxSpan } from \'jpaas-common-lib\';\n  import CodeGenlistJs from \"@/views/modules/form/core/js-comps/CodeGenlist.js\";\n  import ListRender from \'@/views/modules/form/core/js-comps/ListRender.js\';\n  import RxCategoryTreeeditor from \'@/components/redxun/rx-category-treeeditor\'\n  import RxParamsTreeeditor from \'@/components/redxun/rx-params-treeeditor\'\n  //import  from \"@/views/modules/share/rx-button\";\n  //import  from \"@/views/modules/share/rx-span\";\n  export default {\n    name: \'${class}List\',\n    mixins: [BaseList,CodeGenlistJs,ListRender],\n    components: {\n      RxButton,\n      RxSpan,\n      RxFit,\n	  RxCategoryTreeeditor,\n	  RxParamsTreeeditor\n    },\n    data() {\n      return {\n        columns: [\n          {\n            title: \'序号\',\n            type: \'indexColumn\',\n            width: 100,\n            dataIndex: \'serial\',\n            scopedSlots: {customRender: \'serial\'}\n          },\n          <#list commonList as col>\n		  <#if col.headShow==\'YES\'>\n		  {title: \'${col.comment}\', dataIndex: \'${col.name}\', width: ${col.fieldLength}, scopedSlots: {customRender: \'${col.name}\'}},\n		  </#if>\n          </#list>\n          {title: \'操作\', width: 100, dataIndex: \'action\', scopedSlots: {customRender: \'action\'}}\n        ],\n        component:${class}Edit,\n        comment:\"${comment}\",\n        fitSearch:false,\n		curTree:{},\n		${searchTreeScriptFun()}\n      }\n    },\n    methods:{\n	  ${leftQeuryParamFun()}\n      delById(ids){\n        return ${class}Api.del({ ids: ids.join(\',\') });\n      },\n      getListByParams(parameter){\n        return ${class}Api.query(parameter)\n      }\n\n    }\n  }\n</script>\n<style scoped>\n  .table-operator {\n    padding:4px;\n  }\n  .table-operator button {\n    margin:2px;\n  }\n</style>\n\n\n<#function searchTreeScriptFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n	<#assign treeKeyJson=treeJson.treeKeyJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			treeJson:${vueJs.treeJson},\n		</#if>\n		<#if treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			treeCat:{\n						name:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.name}<#else>${treeJson.formSolution.name}</#if>\",\n						treeId:\"<#if treeJson.treeType==\'sysDic\'>${treeKeyJson.treeId}<#else>${treeJson.formSolution.alias}</#if>\"\n					},\n			searchTopNodesUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByTreeIdParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				treeId:\"<#if treeJson.treeKey??>${treeKeyJson.treeId}</#if>\",\n				parentId:\"0\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                pk: \"\"\n			</#if>\n			},\n			searchChildrenUrl:\"<#if treeJson.treeType==\'sysDic\'>/api-system/system/core/sysDic/getByParentId<#else>/api-form/form/core/formSolution/getNodesTreeByAlias</#if>\",\n			searchChildrenParams:{\n			<#if treeJson.treeType==\'sysDic\'>\n				parentId: \"parentId\"\n			<#else>\n				alias: \"${treeJson.formSolution.alias}\",\n                parentId: \"pk\"\n			</#if>\n			},\n			treeRelation:{\n				name:\"<#if treeJson.treeType==\'sysDic\'>name<#else>${treeJson.formSolution.searchLable}</#if>\",\n				treeId:\"<#if treeJson.treeType==\'sysDic\'>dicId<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				parentId:\"<#if treeJson.treeType==\'sysDic\'>parentId<#else>${treeJson.formSolution.searchParentId}</#if>\",\n				key:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\",\n				value:\"<#if treeJson.treeType==\'sysDic\'>value<#else>${treeJson.formSolution.searchPkId}</#if>\"\n			},\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function leftQeuryParamFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			getCurTree(){\n                return this.curTree;\n            },\n			handSelect(curRow) {\n                this.curTree=curRow;\n                var treeId = curRow.treeId;\n                if(treeId!=\"0\"){\n                    this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ=treeId;\n                }else {\n                    delete this.queryParam.Q_${searchTreeColFun(treeJson)}_S_EQ;\n                }\n                this.loadData(this.queryParam);\n            },\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function searchTreeColFun treeJson>\n<#assign searchTreeCol=treeJson.searchTreeCol>\n    <#assign rtn>\n        <#if searchTreeCol.isSingle==0>\n			<#if treeJson.searchTreeColKey==\'name\'>\n			${searchTreeCol.fieldName}_NAME\n			<#else>\n			${searchTreeCol.fieldName}\n			</#if>\n		<#else>\n		${searchTreeCol.fieldName}\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function leftSearchTreeFun >\n	<#assign listType=settingJson.listType>\n	<#assign treeJson=settingJson.treeJson>\n    <#assign rtn>\n        <#if listType==\'tree\'>\n			<#if treeJson.treeType==\'treeId\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-category-treeeditor\n						cat-key=\"${treeJson.treeKey}\"\n						:edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n						@handSelect=\"handSelect\"\n						:async=\"true\"\n						:readTreeId=\"<#if treeJson.catSysTreeKey??>\'${treeJson.catSysTreeKey}\'<#else>\'\'</#if>\"\n					></rx-category-treeeditor>\n				</rx-fit>\n			</div>\n			<#elseif treeJson.treeType==\'sysDic\' || treeJson.treeType==\'formData\'>\n			<div slot=\"left\" width=\"220\" showButton=\"true\">\n				<rx-fit>\n					<rx-params-treeeditor\n					ref=\"rxParamsTreeeditor\"\n                    :edit=\"<#if treeJson.canEdit==\'YES\'>true<#else>false</#if>\"\n                    @handSelect=\"handSelect\"\n                    @addNode=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @addSibling=\"add<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Sibling\"\n                    @editNode=\"edit<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    @deleteNode=\"delete<#if treeJson.treeType==\'sysDic\'>Dic<#else>Form</#if>Node\"\n                    :treeCat=\"treeCat\"\n                    :searchTopNodesUrl=\"searchTopNodesUrl\"\n                    :searchParams=\"searchParams\"\n                    :treeRelation=\"treeRelation\"\n                    :searchChildrenUrl=\"searchChildrenUrl\"\n					:searchChildrenParams=\"searchChildrenParams\"\n                ></rx-params-treeeditor>\n				</rx-fit>\n			</div>\n			</#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function slotScopeColFun col>\n	<#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-upload\'>\n			<span :title=\"text\" slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				<span class=\"upFiles\" v-html=\"onFileRender(text)\"></span>\n            </span>\n		<#else>\n			<#if ctlType==\'rx-address\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">\n				{{onAddressRender(\'${model.genMode}\',record,\'${col.name}\',${fileUtil.countAddressFromExtJson(col.extJson)})}}\n			</span>\n			<#elseif col.isSingle==\'0\'>\n			<span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{record.${col.name}Name}}</span>\n			<#else><span slot=\"${col.name}\" slot-scope=\"{text,record,index,blur}\">{{text}}</span></#if>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function convertUnderLine field>\n  <#if field?index_of(\"_\")==-1>\n    <#assign rtn>${field?lower_case?trim}</#assign>\n    <#return rtn>\n  </#if>\n\n  <#if field?index_of(\"F_\")==0>\n    <#assign rtn><#list (field?substring(2))?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n    <#return rtn>\n  </#if>\n\n  <#assign rtn><#list field?split(\"_\") as x><#if (x_index==0)><#if x?length==1>${x?upper_case?trim}<#else>${x?lower_case?trim}</#if><#else>${x?lower_case?cap_first?trim}</#if></#list></#assign>\n  <#return rtn>\n</#function>\n\n', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:34:27', NULL, '2022-06-06 14:34:27', NULL, NULL, '{class}List.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode', '0');
INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698962918469634', '代码生成_实体编辑页面', 'bodefEntityVueW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign mainClassId=vars.mainClassId>\n<#assign templateType=vars.templateType>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign commonList=model.boAttrList>\n<#assign subComList=model.boEntityList>\n<template>\n    <rx-dialog @handOk=\"handleSubmit\" @cancel=\"cancel\" order=\"top\" btnalign=\"right\" :showok=\"!readonly\">\n        <rx-layout>\n            <div slot=\"center\">\n                <table class=\"table-form four-column\" style=\"width:100%;\" ctltype=\"rx-four-table\" id=\"${mainClassId}\"\n                       borders=\"noborder\" data-sort=\"sortDisabled\">\n                    <colgroup>\n						${colgroupRowFun(templateType)}\n                    </colgroup>\n                    <caption>\n                        ${model.name}\n                    </caption>\n                    <tbody>\n                        ${firstRowFun(commonList templateType)}\n                        ${otherRowFun(commonList templateType)}\n                        <#if (subComList?? && subComList?size>0)>\n                        ${subRowFun(subComList templateType)}\n                        </#if>\n                    </tbody>\n                </table>\n            </div>\n        </rx-layout>\n    </rx-dialog>\n</template>\n\n<script>\n    import ${class}Api from \"@/api/${system}/${package}/${classVar}.js\";\n    import ${class}Data from \"@/views/modules/${system}/${package}/${class}Data.js\";\n    import formJs from \"@/views/modules/form/core/js-comps/form.js\";\n	import {RxDialog} from \'jpaas-common-lib\';\n<#if mainSubType==\'mainAloneSub\'>\n	<#list model.boEntityList as subEnt>\n	import ${subEnt.vars.class}Edit from \'./${subEnt.vars.class}Edit\'\n	</#list>\n</#if>\n    export default{\n        mixins: [formJs,${class}Data],\n        components:{\n        	RxDialog\n		},\n        props:[\"pkId\",\"layerid\",\"destroy\",\"readonly\",\"refKey\",\"refKeyName\"],\n        data(){\n            return {\n				<#if mainSubType==\'mainAloneSub\'>\n				components:{\n					<#list model.boEntityList as subEnt>\n					\"${subEnt.vars.classVar}\":${subEnt.vars.class}Edit,\n					</#list>\n				},\n				</#if>\n			}\n        },\n        created() {\n            //加载表单数据\n            this.loadData(${class}Api);\n        },\n        mounted(){\n            this.onload();\n        },\n        methods:{\n            onload(){\n\n            },\n            async _beforeSubmit(){\n\n            },\n            _afterSubmit(result,formJson){\n\n            },\n            enter(entName, field){\n\n            },\n            handleSubmit(vm){\n                this.handSubmit(${class}Api,vm);\n            }\n        },\n        watch:{\n        }\n    }\n</script>\n\n<#function subRowFun subComList templateType>\n    <#assign rtn>\n	<#assign colindexNum=templateType?number>\n        <#list subComList as sub>\n            <#assign subColList=sub.boAttrList>\n            <#assign subVars=sub.vars>\n            <#assign colIndex=sub?index>\n                <tr class=\"active2\" <#if mainSubType==\'mainAloneSub\'>v-if=\"readonly\"</#if>>\n                    <td colspan=\"<#if colindexNum==4>8<#else>4</#if>\" rowspan=\"1\">\n                        <div class=\"rx-table-body  \" ctltype=\"rx-table\" type=\"onetomany\" id=\"${sub.id}\"\n                             tablename=\"${subVars.classVar}\" style=\"width:100%\" tabname=\"${subVars.classVar}\"\n                             tabletype=\"default\" req=\"no\">\n                            <div class=\"table-header-tool\">\n                                <div class=\"title\">\n                                    <div>\n                                        ${sub.name}\n                                    </div>\n                                </div>\n								<#if mainSubType==\'mainAloneSub\'>\n								<a-button-group v-if=\"readonly\">\n                                    <a-button\n                                            v-on:click=\"addSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n									<a-button\n                                            v-on:click=\"editSubOne(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        编辑\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								<#else>\n								<a-button-group v-if=\"!getReadonly()\">\n                                    <a-button\n                                            v-on:click=\"add(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        添加\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"remove(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        删除\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"up(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        上移\n                                    </a-button>\n                                    <a-button\n                                            v-on:click=\"down(\'${subVars.classVar}\',\'inner\',\'${subVars.classVar}\',\'\',\'${sub.id}\')\">\n                                        下移\n                                    </a-button>\n                                </a-button-group>\n								</#if>\n                            </div>\n                            <div class=\"rx-table-box\">\n                                <table class=\"rx-table\">\n                                    <colgroup>\n                                        <col style=\"width: 60px;\">\n                                        <col style=\"width: 60px;\">\n                                        <#list subColList as col>\n                                        <col style=\"width: 100px;\">\n                                        </#list>\n                                    </colgroup>\n                                    <thead>\n                                        <tr class=\"firstRow\">\n                                            <th>#</th>\n                                            <th>序号</th>\n                                            <#list subColList as col>\n                                            <th v-bind:class=\"{required:required.${subVars.classVar}[\'fields\'].${col.name}}\">${col.comment}</th>\n                                            </#list>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr v-if=\"\'item\'\" v-for=\"(item,index) in data.sub__${subVars.classVar}\"\n                                            v-tableselect=\"{item:item,selmode:\'multi\',data:data.sub__${subVars.classVar}}\"\n                                            :key=\"item.index_\" :class=\"{active:item.selected}\">\n                                            <td><a-checkbox :checked=\"item.selected\"></a-checkbox></td>\n                                            <td><rx-serial :serial=\"index+1\"></rx-serial></td>\n                                            <#list subColList as col>\n                                            <td>\n                                                <${col.control} \n													type=\"onetomany\"\n													id=\"${col.id}\" \n													:readonly=\"readonly\"\n													v-model=\"item.${col.name}\" \n													:data=\"data\" \n													:row=\"item\"\n													:valid=\"validFunc(\'${subVars.classVar}\',\'${col.name}\',item)\"\n													name=\"${col.name}\"\n													permission=\"w\" \n													${subColOtherFun(col)} ></${col.control}>\n                                            </td>\n                                            </#list>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                                <div class=\"tableEmpty\"\n                                     v-if=\"data.sub__${subVars.classVar}&amp;&amp;data.sub__${subVars.classVar}.length <= 0\">\n                                    <a-empty></a-empty>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function colgroupRowFun templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n		<#if colindexNum==1>\n		<col width=\"20%\">\n		<col width=\"80%\">\n		<#elseif colindexNum==2>\n		<col width=\"15%\">\n		<col width=\"35%\">\n		<col width=\"15%\">\n		<col width=\"35%\">\n		<#elseif colindexNum==4>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		<col width=\"8%\"/>\n		<col width=\"17%\"/>\n		</#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function subColOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-number\'>\n            :max=\"100000000\" \n			:min=\"0\" \n			:step=\"1\" \n			valmode=\"single\"\n        <#elseif ctlType==\'rx-textbox\'>\n            :ispassword=\"false\"\n        <#elseif ctlType==\'rx-form-select\'>\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-user\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n            valmode=\"double\"\n			gridname=\"main\"\n            verifyhide=\"${col.name}\"\n        <#else >\n            valmode=\"single\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function getRemainderNum templateNum>\n    <#assign rtn>\n        <#if templateNum==0 || templateNum==1 || templateNum==2>\n             1\n		<#elseif templateNum==3>\n			2\n		<#elseif templateNum==4>\n			3\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function otherRowFun commonList templateType>\n    <#assign templateNum=templateType?number>\n	<#assign remainderNum=getRemainderNum(templateNum)>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex &gt;= templateNum>\n                <#if (colIndex % templateNum==0)>\n                    <tr>\n                </#if>\n                <#if (col.control==\'rx-tree-select\' || col.control==\'rx-form-select\')>\n                    <td style=\"word-break: break-all;\" :class=\"{required:required.main.khly}\">${col.comment}</td>\n                <#else >\n                    <td style=\"word-break: break-all;\">${col.comment}</td>\n                </#if>\n                    <td style=\"word-break: break-all;\">\n                        <${col.control} \n							type=\"main\"\n							id=\"${col.id}\"\n							:readonly=\"readonly\"\n							v-model=\"data.${col.name}\"\n							:valid=\"validFunc(\'main\',\'${col.name}\')\"\n							permission=\"w\"\n							${colOtherFun(col)}></${col.control}>\n                    </td>\n                <#if colIndex % templateNum == remainderNum || !col_has_next>\n                </tr>\n                </#if>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n<#function firstRowFun commonList templateType>\n    <#assign colindexNum=templateType?number>\n    <#assign rtn>\n        <#list commonList as col>\n            <#assign colIndex=col?index>\n            <#if colIndex==0>\n                <tr class=\"firstRow\">\n            </#if>\n            <#if colIndex<colindexNum>\n                <td style=\"word-break: break-all;\">${col.comment}</td>\n                <td style=\"word-break: break-all;\">\n                <${col.control} \n					type=\"main\"\n					id=\"${col.id}\"\n					:readonly=\"readonly\"\n					v-model=\"data.${col.name}\"\n					:valid=\"validFunc(\'main\',\'${col.name}\')\"\n					permission=\"w\"\n					${colOtherFun(col)}></${col.control}>\n                </td>\n            </#if>\n            <#if (colindexNum-colIndex)==1>\n                </tr>\n            </#if>\n        </#list>\n    </#assign>\n    <#return rtn?trim>\n</#function>\n\n\n<#function colOtherFun col>\n    <#assign ctlType=col.control>\n    <#assign rtn>\n        <#if ctlType==\'rx-address\'>\n		<#assign extJson=fileUtil.parseAddressFromExtJson(col.extJson)>\n           :setting=\"{isCity:${extJson.isCity},isCounty:${extJson.isCounty},isAddress:${extJson.isAddress}}\"\n        <#elseif ctlType==\'rx-radio\'>\n			mode=\"default\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			:onlyvalue=\"false\"\n        <#elseif ctlType==\'rx-number\'>\n			:max=\"1000000\"\n			:min=\"0\"\n			:step=\"1\"\n			length=\"${col.length},${col.decimalLength}\"\n        <#elseif ctlType==\'rx-switch\'>\n			mode=\"custom\"\n			verifyhide=\"${col.name}\"\n			check=\"Y\"\n			uncheck=\"N\"\n        <#elseif ctlType==\'rx-tree-select\'>\n			mode=\"multiple\"\n			valmode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			:selectable=\"false\"\n			:data=\"data\"\n        <#elseif ctlType==\'rx-form-select\'>\n			:data=\"data\"\n			mode=\"<#if col.isSingle==0>double<#else>single</#if>\"\n			valmode=\"single\"\n			:hideselect=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-date\'>\n            format=\"YYYY-MM-DD HH:mm:ss\"\n        <#elseif ctlType==\'rx-user\'>\n			:data=\"data\"\n			gridname=\"main\"\n			:single=\"false\"\n			verifyhide=\"${col.name}\"\n        <#elseif ctlType==\'rx-group\'>\n			:data=\"data\"\n			verifyhide=\"${col.name}\"\n			gridname=\"main\"\n			:single=\"false\"\n			:showdeptpath=\"false\"\n			:deptpathlevel=\"0\"\n			:showdimid=\"true\"\n        </#if>\n    </#assign>\n    <#return rtn?trim>\n</#function>', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:35:02', '1', '2022-06-30 10:16:21', NULL, NULL, '{class}Edit.vue', 'src/views/modules/{system}/{package}', 'YES', 'mainSub', 'genCode', '0');

-- 2022-07-06 jpaas-form szw  代码生成器模板修改：调整后端模板---end



-- 2022-07-07 jpaas-form szw  代码生成器模板修改：调整后端模板---begin
delete from `jpaas_form`.`form_template` where ID_ in('1533698526207537154');

INSERT INTO `jpaas_form`.`form_template`(`ID_`, `NAME_`, `ALIAS_`, `TEMPLATE_`, `TYPE_`, `CATEGORY_`, `TENANT_ID_`, `CREATE_DEP_ID_`, `CREATE_BY_`, `CREATE_TIME_`, `UPDATE_BY_`, `UPDATE_TIME_`, `APP_ID_`, `SHARE_`, `FILE_NAME_`, `PATH_`, `SINGLE_`, `MAIN_SUB_TYPE_`, `GEN_MODE_`, `COMPANY_ID_`) VALUES ('1533698526207537154', '代码生成_正向Controller控制层', 'codeGenControllerW', '<#assign package=model.vars.package>\n<#assign class=model.vars.class>\n<#assign classVar=model.vars.classVar>\n<#assign entAlias=model.vars.entAlias>\n<#assign comment=model.name>\n<#assign system=vars.system>\n<#assign domain=vars.domain>\n<#assign tableName=model.tableName>\n<#assign colList=model.boAttrList>\n\npackage ${domain}.${system}.${package}.controller;\n\nimport com.redxun.common.base.db.BaseService;\nimport com.redxun.gencode.controller.CodeGenBaseController;\nimport ${domain}.${system}.${package}.entity.${class};\nimport ${domain}.${system}.${package}.service.${class}ServiceImpl;\nimport io.swagger.annotations.Api;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.*;\nimport com.redxun.common.annotation.ClassDefine;\nimport com.redxun.gencode.codegenhander.ClassCodeDef;\n\n\n/**\n* [${model.name}] 控制器代码\n* @author: ${vars.developer}\n* @company: ${vars.company}\n* @date: ${vars.date}\n*/\n@Slf4j\n@RestController\n@RequestMapping(\"/${system}/${package}/${classVar}\")\n@Api(tags = \"${comment}\")\n@ClassDefine(title = \"${comment}\",alias = \"${class}Controller\",path = \"/${system}/${package}/${classVar}\",packages = \"${package}\",packageName = \"子系统名称\")\n@ClassCodeDef(alias = \"${classVar}\",classPackage=\"${package}\",createType=\"${model.genMode}\")\npublic class ${class}Controller extends CodeGenBaseController<${class}> {\n\n	@Autowired\n	${class}ServiceImpl ${classVar}Service;\n\n	@Override\n	public BaseService getBaseService() {\n		return ${classVar}Service;\n	}\n\n	@Override\n	public String getComment() {\n		return \"${comment}\";\n	}\n\n	@Override\n	public ${class} getBaseEntity(){\n		return new ${class}();\n	}\n\n}', 'codeGen', 'main', '1', '1', '1', '2022-06-06 14:33:18', '1', '2022-07-07 18:26:27', NULL, NULL, '{class}Controller.java', 'src/main/java/com/{rootSystem}/{system}/{package}/controller', 'NO', 'mainSub', 'genCode', '0');

-- 2022-07-07 jpaas-form szw  代码生成器模板修改：调整后端模板---end

-- 2022-07-09 jpaas-form hj  手机端列表功能所需增加字段
ALTER TABLE jpaas_form.form_bo_list_history ADD MOBILE_CONTENT_ TEXT COMMENT '移动端内容';
ALTER TABLE jpaas_form.form_bo_list ADD MOBILE_HTML_ TEXT COMMENT '手机端HTML';

